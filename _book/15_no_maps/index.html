<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Learn crime mapping with R - 15&nbsp; Presenting spatial data without maps</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../16_mapping_time/index.html" rel="next">
<link href="../14_writing_reports/index.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><!-- START OF INCLUDED HEADER --><!--
This file contains code that will be included in the header of each page of the
quarto book
--><script src="https://code.jquery.com/jquery-3.6.3.min.js" integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU=" crossorigin="anonymous"></script><!-- END OF INCLUDED HEADER --><link rel="stylesheet" href="../css/styles.css">
<meta name="twitter:title" content="Learn crime mapping with R - 15&nbsp; Presenting spatial data without maps">
<meta name="twitter:description" content="">
<meta name="twitter:card" content="summary">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../15_no_maps/index.html"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Presenting spatial data without maps</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Learn crime mapping with R</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/mpjashby/crimemappingbook/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="../learn_crime_mapping_with_r.epub" title="Download ePub" class="quarto-navigation-tool px-1" aria-label="Download ePub"><i class="bi bi-journal"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=%7Curl%7C">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=%7Curl%7C">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=%7Curl%7C">
              <i class="bi bi-bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
</div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome!</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../00_setup/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Install the software needed for this book</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01_getting_started/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting started</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02_your_first_crime_map/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Your first crime map</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_data_wrangling/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Wrangling data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04_code_with_style/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Code with style</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05_your_second_crime_map/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Your second crime map</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../06_map_context/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Giving a map context</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../07_handling_bugs/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Handling bugs in your code</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../08_projects/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Don’t get lost in data analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../09_mapping_areas/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Mapping area data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../10_place_data/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Crime Mapping: Using data about places</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../11_mapping_hotspots/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Crime Mapping: Mapping hotspots</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../12_messy_data/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Handling messy data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../13_crime_series/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Mapping crime series</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../14_writing_reports/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Writing reports in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../15_no_maps/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Presenting spatial data without maps</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../16_mapping_time/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Mapping crime over time</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/read_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Functions for reading data into R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/common_errors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Common R errors and how to fix them</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
    <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">In this chapter</h2>
   
  <ul class="collapse">
<li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">15.1</span> Introduction</a></li>
  <li><a href="#tables" id="toc-tables" class="nav-link" data-scroll-target="#tables"><span class="header-section-number">15.2</span> Tables</a></li>
  <li><a href="#bar-charts" id="toc-bar-charts" class="nav-link" data-scroll-target="#bar-charts"><span class="header-section-number">15.3</span> Bar charts</a></li>
  <li><a href="#showing-a-distribution" id="toc-showing-a-distribution" class="nav-link" data-scroll-target="#showing-a-distribution"><span class="header-section-number">15.4</span> Showing a distribution</a></li>
  <li><a href="#comparing-continuous-variables" id="toc-comparing-continuous-variables" class="nav-link" data-scroll-target="#comparing-continuous-variables"><span class="header-section-number">15.5</span> Comparing continuous variables</a></li>
  <li><a href="#in-summary" id="toc-in-summary" class="nav-link" data-scroll-target="#in-summary"><span class="header-section-number">15.6</span> In summary</a></li>
  </ul><div class="toc-actions"><ul class="collapse"><li><a href="https://github.com/mpjashby/crimemappingbook/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Presenting spatial data without maps</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p><strong>Learn how to use tables and charts to effectively communicate information about spatial data, and when these techniques might be more effective than using maps.</strong></p>
<div class="box load-tutorial">
<p>To load the <a href="../#how-to-use-this-book">interactive tutorial</a> for this chapter, copy and paste the following code into the RStudio console:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>crimemapping<span class="sc">::</span><span class="fu">tutorial</span>(<span class="st">"15_no_maps"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and press <code>Enter</code>.</p>
</div>
<section id="introduction" class="level2" data-number="15.1"><h2 data-number="15.1" class="anchored" data-anchor-id="introduction">
<span class="header-section-number">15.1</span> Introduction</h2>
<p>Making maps is the core of analysing spatial data. But just because a particular dataset has a spatial element to it does not mean that a map is the best way to present that data. In this tutorial we will learn some other techniques for presenting data that can be more effective than maps for answering certain questions about spatial data.</p>
<p>As with so much in spatial analysis, whether it is best to make a map or use some other technique to convey information will depend on the circumstances. When you decide how to communicate information about the data you are analysing, you will need to consider the questions you are trying to answer, the audience that you are communicating to, what they will be using the information for and in what circumstances they will be using it.</p>
<p>While the best choice of how to communicate spatial information will depend on the circumstances, there are a few instances in which maps are typically <em>not</em> the best way to communicate your data. These are:</p>
<section id="when-you-only-need-to-convey-a-handful-of-pieces-of-information" class="level4" data-number="15.1.0.1"><h4 data-number="15.1.0.1" class="anchored" data-anchor-id="when-you-only-need-to-convey-a-handful-of-pieces-of-information">
<span class="header-section-number">15.1.0.1</span> When you only need to convey a handful of pieces of information</h4>
<p>Maps are very effective for communicating detailed information, such as the density of crime across thousands of cells in a KDE grid. But to do this, maps typically encode information into aesthetics such as colour, size and so on. This is necessary for communicating large amounts of information, but it makes the connection between the data and the visual representation of the data less direct. If you only need to communicate a small amount of information, there is less justification for forcing your audience to mentally translate the aesthetic into whatever it represents.</p>
<p>For example, if you wanted to show the number of violent and sexual offences in each of the seven districts in Northamptonshire in England, a choropleth map is less clear than a bar chart (for example, in being able to decipher if there were more offences in Kettering or in Wellingborough).</p>
<p class="full-width-image">
<img src="images/map_vs_bar_chart.png" alt="Choropleth map and bar chart both showing the frequency of violence in each district in Northamptonshire in 2020"></p>
<p>A map might be a useful addition to the bar chart in this case <em>if</em> you are trying to communicate information to people who are not familiar with the locations of the districts. In that case, we might want to add a small reference map to help people understand which area is which:</p>
<p class="full-width-image">
<img src="images/bar_chart_ref_map.png" alt="Bar chart showing the frequency of violence in each district in Northamptonshire in 2020, with a reference map showing the area covered by each district"></p>
<p>But in most circumstances in which you create crime maps, you will be creating them for an audience (such as local police officers) that already has sufficient knowledge of the area and so an inset map such as this would not be needed. In that case, a bar chart will probably be more effective at showing this information than a map would be.</p>
</section><section id="when-you-need-to-convey-several-different-things-about-one-place" class="level4" data-number="15.1.0.2"><h4 data-number="15.1.0.2" class="anchored" data-anchor-id="when-you-need-to-convey-several-different-things-about-one-place">
<span class="header-section-number">15.1.0.2</span> When you need to convey several different things about one place</h4>
<p>Maps are generally most effective when they show a single piece of data about each place. For example, a choropleth map shows a single shade of colour for each area on the map to represent a single value, such as the frequency of crime in that area. If you wanted to show the frequency of burglary <em>and</em> the frequency of robbery in the same area on a map, this would be quite hard. So if you need to convey multiple different things about each place, it is generally best to do this in a table or chart, rather than a map.</p>
<p>One exception to this is when you present multiple maps side by side, each showing a single thing about an area. These are called <em>small multiple</em> maps and we will learn about them in a future tutorial.</p>
</section><section id="when-the-geographic-relationship-between-places-on-the-map-is-not-the-most-important-thing-about-them" class="level4" data-number="15.1.0.3"><h4 data-number="15.1.0.3" class="anchored" data-anchor-id="when-the-geographic-relationship-between-places-on-the-map-is-not-the-most-important-thing-about-them">
<span class="header-section-number">15.1.0.3</span> When the geographic relationship between places on the map is not the most important thing about them</h4>
<p>Maps emphasise the spatial relationship between different places, but they do this at the expense of making non-spatial relationships between those places less obvious. If the spatial relationships are the most important thing that you want to convey, a map makes sense. For example, a hotspot map is often a very good way to communicate where crime is most concentrated. But in other cases the geographic relationships between variables will be much less important. For example, if you wanted to show the relationship between the amount of crime in an area and the level of poverty there, a scatter plot would probably be a more-effective way to do this than a map would be.</p>
</section></section><section id="tables" class="level2" data-number="15.2"><h2 data-number="15.2" class="anchored" data-anchor-id="tables">
<span class="header-section-number">15.2</span> Tables</h2>
<p>Well-designed tables can be a very effective way of communicating information, whereas badly-design tables can be confusing and even lead your audience to give up trying to engage with the information you’re trying to communicate.</p>
<p>Tables used to present information almost always show only a summary of the available data, so the first step in preparing a table is to wrangle the data into the right format. In a previous tutorial we learned about the <code>summarise()</code> function from the <code>dplyr</code> package that we can use to produce summaries of rows of data.</p>
<p>To learn about creating a good table for displaying summary data in a report, we will use the example of the frequency of different types of violence in the different states of Malaysia in 2017. This data is already loaded in an object called <code>violence</code>. We can get a feel for the data by looking at a random sample of rows using the <code>slice_sample()</code> function function from the <code>dplyr</code> package (remember <code>dplyr</code> is loaded automatically by <code>tidyverse</code>).</p>
<div class="cell" data-exercise="true">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="fu">slice_sample</span>(violence, <span class="at">n =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 5
   region        state       year crime_type         count
   &lt;chr&gt;         &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;              &lt;dbl&gt;
 1 East Malaysia Sabah       2017 rape                 211
 2 West Malaysia Terengganu  2017 aggravated assault   130
 3 West Malaysia Terengganu  2017 rape                  64
 4 West Malaysia Melaka      2017 rape                  69
 5 West Malaysia Pahang      2017 armed robbery          1
 6 West Malaysia Perak       2017 rape                  95
 7 West Malaysia Perak       2017 aggravated assault   380
 8 West Malaysia Johor       2017 rape                 196
 9 West Malaysia Kedah       2017 unarmed robbery      490
10 West Malaysia Melaka      2017 unarmed robbery      589</code></pre>
</div>
</div>
<p>The output of <code>slice_sample()</code> looks acceptable as a table, especially if it is included in a Quarto document, but readers of our reports probably don’t want to know the type of each variable (underneath the variable names) and won’t want to page through the table if there are more rows or columns than can fit in the available space.</p>
<section id="making-data-wider-for-presentation" class="level3" data-number="15.2.1"><h3 data-number="15.2.1" class="anchored" data-anchor-id="making-data-wider-for-presentation">
<span class="header-section-number">15.2.1</span> Making data wider for presentation</h3>
<p>One issue with printing the <code>violence</code> object as a table is that it has 70 rows, so it will take up a lot of space on a page or screen. We can make the data more compact by converting it from long format to wide format. In the previous tutorial on tidying messy data we learned that data are often easier to analyse in long format. But it is often better to <em>present</em> data in a table in wide format.</p>
<p>To convert the table to a wider format we can use the <code>pivot_wider()</code> function from the <code>tidyr</code> package, just was we used the corresponding <code>pivot_longer()</code> function to tidy data in the messy-data tutorial. To make data wider, we specify a single column in the data to use as the names of multiple new columns using the <code>names_from</code> argument and a column to use as the values for the new columns using the <code>values_from</code> argument.</p>
<div class="cell" data-exercise="true">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="fu">pivot_wider</span>(violence, <span class="at">names_from =</span> crime_type, <span class="at">values_from =</span> count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 8
   region        state    year `aggravated assault` `armed robbery` murder  rape
   &lt;chr&gt;         &lt;chr&gt;   &lt;dbl&gt;                &lt;dbl&gt;           &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
 1 East Malaysia Sabah    2017                  230               0     36   211
 2 East Malaysia Sarawak  2017                  368               3     27   150
 3 West Malaysia Johor    2017                  614               1     66   196
 4 West Malaysia Kedah    2017                  364               2     21   119
 5 West Malaysia Kelant…  2017                  252               2     13   114
 6 West Malaysia Kuala …  2017                  651               4     37   132
 7 West Malaysia Melaka   2017                  176               1      7    69
 8 West Malaysia Negeri…  2017                  241               2     14    91
 9 West Malaysia Pahang   2017                  188               1     16   163
10 West Malaysia Perak    2017                  380               4     35    95
11 West Malaysia Perlis   2017                   47               0      2    30
12 West Malaysia Pulau …  2017                  275               0     17    80
13 West Malaysia Selang…  2017                 1108              14     83   321
14 West Malaysia Tereng…  2017                  130               0      5    64
# ℹ 1 more variable: `unarmed robbery` &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Now the table has only 14 rows, which makes it much easier to present both on screen and in print. We can also see that the <code>year</code> column is <em>constant</em> (all the values are the same), so we can remove this using the <code>select()</code> function from <code>dplyr</code>. We can also use <code>select()</code> to change the order of the columns from left to right so that the two types of robbery appear next to each other.</p>
<div class="cell" data-exercise="true">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>violence <span class="sc">|&gt;</span> </span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> crime_type, <span class="at">values_from =</span> count) <span class="sc">|&gt;</span> </span>
<span id="cb6-3"><a href="#cb6-3"></a>  <span class="fu">select</span>(</span>
<span id="cb6-4"><a href="#cb6-4"></a>    region, state, murder, rape, <span class="st">`</span><span class="at">aggravated assault</span><span class="st">`</span>, <span class="st">`</span><span class="at">armed robbery</span><span class="st">`</span>, </span>
<span id="cb6-5"><a href="#cb6-5"></a>    <span class="st">`</span><span class="at">unarmed robbery</span><span class="st">`</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 7
   region        state         murder  rape `aggravated assault` `armed robbery`
   &lt;chr&gt;         &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt;                &lt;dbl&gt;           &lt;dbl&gt;
 1 East Malaysia Sabah             36   211                  230               0
 2 East Malaysia Sarawak           27   150                  368               3
 3 West Malaysia Johor             66   196                  614               1
 4 West Malaysia Kedah             21   119                  364               2
 5 West Malaysia Kelantan          13   114                  252               2
 6 West Malaysia Kuala Lumpur      37   132                  651               4
 7 West Malaysia Melaka             7    69                  176               1
 8 West Malaysia Negeri Sembi…     14    91                  241               2
 9 West Malaysia Pahang            16   163                  188               1
10 West Malaysia Perak             35    95                  380               4
11 West Malaysia Perlis             2    30                   47               0
12 West Malaysia Pulau Pinang      17    80                  275               0
13 West Malaysia Selangor          83   321                 1108              14
14 West Malaysia Terengganu         5    64                  130               0
# ℹ 1 more variable: `unarmed robbery` &lt;dbl&gt;</code></pre>
</div>
</div>
</section><section id="using-the-gt-package-to-make-better-tables" class="level3" data-number="15.2.2"><h3 data-number="15.2.2" class="anchored" data-anchor-id="using-the-gt-package-to-make-better-tables">
<span class="header-section-number">15.2.2</span> Using the <code>gt</code> package to make better tables</h3>
<p><a href="https://gt.rstudio.com/"><img src="images/gt.png" alt="gt package hex sticker" class="right-side-image"></a></p>
<p>We can create much better display tables with the <a href="https://gt.rstudio.com/"><code>gt</code> package</a>, which is designed to format data for display. The <code>gt</code> package works in a similar way to the <code>ggplot2</code> package, in that tables are made up of stacks of functions that contribute to the appearance of the final table. One difference is that the layers in a <code>gt</code> stack are joined using the pipe operator (<code>|&gt;</code>) rather than the plus operator (<code>+</code>).</p>
<p>We can create a very basic <code>gt</code> table by just passing a data frame or tibble to the <code>gt()</code> function. So we can add <code>gt()</code> to the end of the pipeline of functions we have already started to build to create a good display table.</p>
<div class="cell" data-exercise="true">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>violence <span class="sc">|&gt;</span> </span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> crime_type, <span class="at">values_from =</span> count) <span class="sc">|&gt;</span> </span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="fu">select</span>(</span>
<span id="cb8-4"><a href="#cb8-4"></a>    region, state, murder, rape, <span class="st">`</span><span class="at">aggravated assault</span><span class="st">`</span>, <span class="st">`</span><span class="at">armed robbery</span><span class="st">`</span>, </span>
<span id="cb8-5"><a href="#cb8-5"></a>    <span class="st">`</span><span class="at">unarmed robbery</span><span class="st">`</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb8-7"><a href="#cb8-7"></a>  <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<div id="ryhlpcjvnd" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ryhlpcjvnd table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ryhlpcjvnd thead, #ryhlpcjvnd tbody, #ryhlpcjvnd tfoot, #ryhlpcjvnd tr, #ryhlpcjvnd td, #ryhlpcjvnd th {
  border-style: none;
}

#ryhlpcjvnd p {
  margin: 0;
  padding: 0;
}

#ryhlpcjvnd .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ryhlpcjvnd .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ryhlpcjvnd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ryhlpcjvnd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ryhlpcjvnd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ryhlpcjvnd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ryhlpcjvnd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ryhlpcjvnd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ryhlpcjvnd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ryhlpcjvnd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ryhlpcjvnd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ryhlpcjvnd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ryhlpcjvnd .gt_spanner_row {
  border-bottom-style: hidden;
}

#ryhlpcjvnd .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ryhlpcjvnd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ryhlpcjvnd .gt_from_md > :first-child {
  margin-top: 0;
}

#ryhlpcjvnd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ryhlpcjvnd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ryhlpcjvnd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ryhlpcjvnd .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ryhlpcjvnd .gt_row_group_first td {
  border-top-width: 2px;
}

#ryhlpcjvnd .gt_row_group_first th {
  border-top-width: 2px;
}

#ryhlpcjvnd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ryhlpcjvnd .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ryhlpcjvnd .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ryhlpcjvnd .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ryhlpcjvnd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ryhlpcjvnd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ryhlpcjvnd .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ryhlpcjvnd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ryhlpcjvnd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ryhlpcjvnd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ryhlpcjvnd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ryhlpcjvnd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ryhlpcjvnd .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ryhlpcjvnd .gt_left {
  text-align: left;
}

#ryhlpcjvnd .gt_center {
  text-align: center;
}

#ryhlpcjvnd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ryhlpcjvnd .gt_font_normal {
  font-weight: normal;
}

#ryhlpcjvnd .gt_font_bold {
  font-weight: bold;
}

#ryhlpcjvnd .gt_font_italic {
  font-style: italic;
}

#ryhlpcjvnd .gt_super {
  font-size: 65%;
}

#ryhlpcjvnd .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ryhlpcjvnd .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ryhlpcjvnd .gt_indent_1 {
  text-indent: 5px;
}

#ryhlpcjvnd .gt_indent_2 {
  text-indent: 10px;
}

#ryhlpcjvnd .gt_indent_3 {
  text-indent: 15px;
}

#ryhlpcjvnd .gt_indent_4 {
  text-indent: 20px;
}

#ryhlpcjvnd .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="header gt_col_headings">
<th id="region" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">region</th>
<th id="state" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">state</th>
<th id="murder" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">murder</th>
<th id="rape" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">rape</th>
<th id="aggravated assault" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">aggravated assault</th>
<th id="armed robbery" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">armed robbery</th>
<th id="unarmed robbery" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">unarmed robbery</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="region">East Malaysia</td>
<td class="gt_row gt_left" headers="state">Sabah</td>
<td class="gt_row gt_right" headers="murder">36</td>
<td class="gt_row gt_right" headers="rape">211</td>
<td class="gt_row gt_right" headers="aggravated assault">230</td>
<td class="gt_row gt_right" headers="armed robbery">0</td>
<td class="gt_row gt_right" headers="unarmed robbery">284</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="region">East Malaysia</td>
<td class="gt_row gt_left" headers="state">Sarawak</td>
<td class="gt_row gt_right" headers="murder">27</td>
<td class="gt_row gt_right" headers="rape">150</td>
<td class="gt_row gt_right" headers="aggravated assault">368</td>
<td class="gt_row gt_right" headers="armed robbery">3</td>
<td class="gt_row gt_right" headers="unarmed robbery">328</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="region">West Malaysia</td>
<td class="gt_row gt_left" headers="state">Johor</td>
<td class="gt_row gt_right" headers="murder">66</td>
<td class="gt_row gt_right" headers="rape">196</td>
<td class="gt_row gt_right" headers="aggravated assault">614</td>
<td class="gt_row gt_right" headers="armed robbery">1</td>
<td class="gt_row gt_right" headers="unarmed robbery">1701</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="region">West Malaysia</td>
<td class="gt_row gt_left" headers="state">Kedah</td>
<td class="gt_row gt_right" headers="murder">21</td>
<td class="gt_row gt_right" headers="rape">119</td>
<td class="gt_row gt_right" headers="aggravated assault">364</td>
<td class="gt_row gt_right" headers="armed robbery">2</td>
<td class="gt_row gt_right" headers="unarmed robbery">490</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="region">West Malaysia</td>
<td class="gt_row gt_left" headers="state">Kelantan</td>
<td class="gt_row gt_right" headers="murder">13</td>
<td class="gt_row gt_right" headers="rape">114</td>
<td class="gt_row gt_right" headers="aggravated assault">252</td>
<td class="gt_row gt_right" headers="armed robbery">2</td>
<td class="gt_row gt_right" headers="unarmed robbery">219</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="region">West Malaysia</td>
<td class="gt_row gt_left" headers="state">Kuala Lumpur</td>
<td class="gt_row gt_right" headers="murder">37</td>
<td class="gt_row gt_right" headers="rape">132</td>
<td class="gt_row gt_right" headers="aggravated assault">651</td>
<td class="gt_row gt_right" headers="armed robbery">4</td>
<td class="gt_row gt_right" headers="unarmed robbery">3175</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="region">West Malaysia</td>
<td class="gt_row gt_left" headers="state">Melaka</td>
<td class="gt_row gt_right" headers="murder">7</td>
<td class="gt_row gt_right" headers="rape">69</td>
<td class="gt_row gt_right" headers="aggravated assault">176</td>
<td class="gt_row gt_right" headers="armed robbery">1</td>
<td class="gt_row gt_right" headers="unarmed robbery">589</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="region">West Malaysia</td>
<td class="gt_row gt_left" headers="state">Negeri Sembilan</td>
<td class="gt_row gt_right" headers="murder">14</td>
<td class="gt_row gt_right" headers="rape">91</td>
<td class="gt_row gt_right" headers="aggravated assault">241</td>
<td class="gt_row gt_right" headers="armed robbery">2</td>
<td class="gt_row gt_right" headers="unarmed robbery">536</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="region">West Malaysia</td>
<td class="gt_row gt_left" headers="state">Pahang</td>
<td class="gt_row gt_right" headers="murder">16</td>
<td class="gt_row gt_right" headers="rape">163</td>
<td class="gt_row gt_right" headers="aggravated assault">188</td>
<td class="gt_row gt_right" headers="armed robbery">1</td>
<td class="gt_row gt_right" headers="unarmed robbery">288</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="region">West Malaysia</td>
<td class="gt_row gt_left" headers="state">Perak</td>
<td class="gt_row gt_right" headers="murder">35</td>
<td class="gt_row gt_right" headers="rape">95</td>
<td class="gt_row gt_right" headers="aggravated assault">380</td>
<td class="gt_row gt_right" headers="armed robbery">4</td>
<td class="gt_row gt_right" headers="unarmed robbery">626</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="region">West Malaysia</td>
<td class="gt_row gt_left" headers="state">Perlis</td>
<td class="gt_row gt_right" headers="murder">2</td>
<td class="gt_row gt_right" headers="rape">30</td>
<td class="gt_row gt_right" headers="aggravated assault">47</td>
<td class="gt_row gt_right" headers="armed robbery">0</td>
<td class="gt_row gt_right" headers="unarmed robbery">53</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="region">West Malaysia</td>
<td class="gt_row gt_left" headers="state">Pulau Pinang</td>
<td class="gt_row gt_right" headers="murder">17</td>
<td class="gt_row gt_right" headers="rape">80</td>
<td class="gt_row gt_right" headers="aggravated assault">275</td>
<td class="gt_row gt_right" headers="armed robbery">0</td>
<td class="gt_row gt_right" headers="unarmed robbery">706</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="region">West Malaysia</td>
<td class="gt_row gt_left" headers="state">Selangor</td>
<td class="gt_row gt_right" headers="murder">83</td>
<td class="gt_row gt_right" headers="rape">321</td>
<td class="gt_row gt_right" headers="aggravated assault">1108</td>
<td class="gt_row gt_right" headers="armed robbery">14</td>
<td class="gt_row gt_right" headers="unarmed robbery">4944</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="region">West Malaysia</td>
<td class="gt_row gt_left" headers="state">Terengganu</td>
<td class="gt_row gt_right" headers="murder">5</td>
<td class="gt_row gt_right" headers="rape">64</td>
<td class="gt_row gt_right" headers="aggravated assault">130</td>
<td class="gt_row gt_right" headers="armed robbery">0</td>
<td class="gt_row gt_right" headers="unarmed robbery">155</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<p>This table is already better than the default table produced by Quarto if we just print a data frame or tibble. The <code>gt</code> table does not take up the whole width of the page unnecessarily (which can make it harder to read across rows) and has hidden the type of each column.</p>
<p>Note that in the code above, some of the variable names are surrounded by back ticks (<code>`</code>). There are spaces in these variable names, so we use back ticks to stop R from interpreting the first space as the end of the variable name.</p>
<p>We can add more functions to the <code>gt()</code> stack to adjust the appearance of the table. For example, we can format the numeric columns as numbers using the <code>fmt_number()</code> function. This adds thousand separators (in British English, commas) to make it easier to read the large numeric values and can make various other changes such as adding a prefix or suffix to numbers (useful for showing units), scaling numbers (useful for very large numbers) or automatically formatting numbers according to the conventions of the language your computer is set to use (referred to in R help pages as the <em>locale</em> of your computer).</p>
<p>We choose which columns <code>fmt_number()</code> should format using the <code>columns</code> argument. In this case, we want to format all the numeric columns in the data, so we will set <code>columns = where(is.numeric)</code>.</p>
<p>We don’t want the numbers in the table to have any decimal places (since the crime counts are all whole numbers), so we also set <code>decimals = 0</code>. We can use the default values of all the other arguments to <code>fmt_number()</code> – type <code><a href="https://gt.rstudio.com/reference/fmt_number.html">?gt::fmt_number</a></code> in the R console to find out more about the different options available on the help page for the <code>fmt_number()</code> function.</p>
<div class="cell" data-exercise="true">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>violence <span class="sc">|&gt;</span> </span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> crime_type, <span class="at">values_from =</span> count) <span class="sc">|&gt;</span> </span>
<span id="cb9-3"><a href="#cb9-3"></a>  <span class="fu">select</span>(</span>
<span id="cb9-4"><a href="#cb9-4"></a>    region, state, murder, rape, <span class="st">`</span><span class="at">aggravated assault</span><span class="st">`</span>, <span class="st">`</span><span class="at">armed robbery</span><span class="st">`</span>, </span>
<span id="cb9-5"><a href="#cb9-5"></a>    <span class="st">`</span><span class="at">unarmed robbery</span><span class="st">`</span></span>
<span id="cb9-6"><a href="#cb9-6"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb9-7"><a href="#cb9-7"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> </span>
<span id="cb9-8"><a href="#cb9-8"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">where</span>(is.numeric), <span class="at">decimals =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<div id="pqehuolncs" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#pqehuolncs table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#pqehuolncs thead, #pqehuolncs tbody, #pqehuolncs tfoot, #pqehuolncs tr, #pqehuolncs td, #pqehuolncs th {
  border-style: none;
}

#pqehuolncs p {
  margin: 0;
  padding: 0;
}

#pqehuolncs .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pqehuolncs .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#pqehuolncs .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pqehuolncs .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pqehuolncs .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pqehuolncs .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pqehuolncs .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pqehuolncs .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pqehuolncs .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pqehuolncs .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pqehuolncs .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pqehuolncs .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pqehuolncs .gt_spanner_row {
  border-bottom-style: hidden;
}

#pqehuolncs .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#pqehuolncs .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pqehuolncs .gt_from_md > :first-child {
  margin-top: 0;
}

#pqehuolncs .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pqehuolncs .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pqehuolncs .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#pqehuolncs .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#pqehuolncs .gt_row_group_first td {
  border-top-width: 2px;
}

#pqehuolncs .gt_row_group_first th {
  border-top-width: 2px;
}

#pqehuolncs .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pqehuolncs .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pqehuolncs .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pqehuolncs .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pqehuolncs .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pqehuolncs .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pqehuolncs .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#pqehuolncs .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pqehuolncs .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pqehuolncs .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pqehuolncs .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pqehuolncs .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pqehuolncs .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pqehuolncs .gt_left {
  text-align: left;
}

#pqehuolncs .gt_center {
  text-align: center;
}

#pqehuolncs .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pqehuolncs .gt_font_normal {
  font-weight: normal;
}

#pqehuolncs .gt_font_bold {
  font-weight: bold;
}

#pqehuolncs .gt_font_italic {
  font-style: italic;
}

#pqehuolncs .gt_super {
  font-size: 65%;
}

#pqehuolncs .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#pqehuolncs .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pqehuolncs .gt_indent_1 {
  text-indent: 5px;
}

#pqehuolncs .gt_indent_2 {
  text-indent: 10px;
}

#pqehuolncs .gt_indent_3 {
  text-indent: 15px;
}

#pqehuolncs .gt_indent_4 {
  text-indent: 20px;
}

#pqehuolncs .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="header gt_col_headings">
<th id="region" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">region</th>
<th id="state" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">state</th>
<th id="murder" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">murder</th>
<th id="rape" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">rape</th>
<th id="aggravated assault" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">aggravated assault</th>
<th id="armed robbery" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">armed robbery</th>
<th id="unarmed robbery" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">unarmed robbery</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="region">East Malaysia</td>
<td class="gt_row gt_left" headers="state">Sabah</td>
<td class="gt_row gt_right" headers="murder">36</td>
<td class="gt_row gt_right" headers="rape">211</td>
<td class="gt_row gt_right" headers="aggravated assault">230</td>
<td class="gt_row gt_right" headers="armed robbery">0</td>
<td class="gt_row gt_right" headers="unarmed robbery">284</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="region">East Malaysia</td>
<td class="gt_row gt_left" headers="state">Sarawak</td>
<td class="gt_row gt_right" headers="murder">27</td>
<td class="gt_row gt_right" headers="rape">150</td>
<td class="gt_row gt_right" headers="aggravated assault">368</td>
<td class="gt_row gt_right" headers="armed robbery">3</td>
<td class="gt_row gt_right" headers="unarmed robbery">328</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="region">West Malaysia</td>
<td class="gt_row gt_left" headers="state">Johor</td>
<td class="gt_row gt_right" headers="murder">66</td>
<td class="gt_row gt_right" headers="rape">196</td>
<td class="gt_row gt_right" headers="aggravated assault">614</td>
<td class="gt_row gt_right" headers="armed robbery">1</td>
<td class="gt_row gt_right" headers="unarmed robbery">1,701</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="region">West Malaysia</td>
<td class="gt_row gt_left" headers="state">Kedah</td>
<td class="gt_row gt_right" headers="murder">21</td>
<td class="gt_row gt_right" headers="rape">119</td>
<td class="gt_row gt_right" headers="aggravated assault">364</td>
<td class="gt_row gt_right" headers="armed robbery">2</td>
<td class="gt_row gt_right" headers="unarmed robbery">490</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="region">West Malaysia</td>
<td class="gt_row gt_left" headers="state">Kelantan</td>
<td class="gt_row gt_right" headers="murder">13</td>
<td class="gt_row gt_right" headers="rape">114</td>
<td class="gt_row gt_right" headers="aggravated assault">252</td>
<td class="gt_row gt_right" headers="armed robbery">2</td>
<td class="gt_row gt_right" headers="unarmed robbery">219</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="region">West Malaysia</td>
<td class="gt_row gt_left" headers="state">Kuala Lumpur</td>
<td class="gt_row gt_right" headers="murder">37</td>
<td class="gt_row gt_right" headers="rape">132</td>
<td class="gt_row gt_right" headers="aggravated assault">651</td>
<td class="gt_row gt_right" headers="armed robbery">4</td>
<td class="gt_row gt_right" headers="unarmed robbery">3,175</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="region">West Malaysia</td>
<td class="gt_row gt_left" headers="state">Melaka</td>
<td class="gt_row gt_right" headers="murder">7</td>
<td class="gt_row gt_right" headers="rape">69</td>
<td class="gt_row gt_right" headers="aggravated assault">176</td>
<td class="gt_row gt_right" headers="armed robbery">1</td>
<td class="gt_row gt_right" headers="unarmed robbery">589</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="region">West Malaysia</td>
<td class="gt_row gt_left" headers="state">Negeri Sembilan</td>
<td class="gt_row gt_right" headers="murder">14</td>
<td class="gt_row gt_right" headers="rape">91</td>
<td class="gt_row gt_right" headers="aggravated assault">241</td>
<td class="gt_row gt_right" headers="armed robbery">2</td>
<td class="gt_row gt_right" headers="unarmed robbery">536</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="region">West Malaysia</td>
<td class="gt_row gt_left" headers="state">Pahang</td>
<td class="gt_row gt_right" headers="murder">16</td>
<td class="gt_row gt_right" headers="rape">163</td>
<td class="gt_row gt_right" headers="aggravated assault">188</td>
<td class="gt_row gt_right" headers="armed robbery">1</td>
<td class="gt_row gt_right" headers="unarmed robbery">288</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="region">West Malaysia</td>
<td class="gt_row gt_left" headers="state">Perak</td>
<td class="gt_row gt_right" headers="murder">35</td>
<td class="gt_row gt_right" headers="rape">95</td>
<td class="gt_row gt_right" headers="aggravated assault">380</td>
<td class="gt_row gt_right" headers="armed robbery">4</td>
<td class="gt_row gt_right" headers="unarmed robbery">626</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="region">West Malaysia</td>
<td class="gt_row gt_left" headers="state">Perlis</td>
<td class="gt_row gt_right" headers="murder">2</td>
<td class="gt_row gt_right" headers="rape">30</td>
<td class="gt_row gt_right" headers="aggravated assault">47</td>
<td class="gt_row gt_right" headers="armed robbery">0</td>
<td class="gt_row gt_right" headers="unarmed robbery">53</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="region">West Malaysia</td>
<td class="gt_row gt_left" headers="state">Pulau Pinang</td>
<td class="gt_row gt_right" headers="murder">17</td>
<td class="gt_row gt_right" headers="rape">80</td>
<td class="gt_row gt_right" headers="aggravated assault">275</td>
<td class="gt_row gt_right" headers="armed robbery">0</td>
<td class="gt_row gt_right" headers="unarmed robbery">706</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="region">West Malaysia</td>
<td class="gt_row gt_left" headers="state">Selangor</td>
<td class="gt_row gt_right" headers="murder">83</td>
<td class="gt_row gt_right" headers="rape">321</td>
<td class="gt_row gt_right" headers="aggravated assault">1,108</td>
<td class="gt_row gt_right" headers="armed robbery">14</td>
<td class="gt_row gt_right" headers="unarmed robbery">4,944</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="region">West Malaysia</td>
<td class="gt_row gt_left" headers="state">Terengganu</td>
<td class="gt_row gt_right" headers="murder">5</td>
<td class="gt_row gt_right" headers="rape">64</td>
<td class="gt_row gt_right" headers="aggravated assault">130</td>
<td class="gt_row gt_right" headers="armed robbery">0</td>
<td class="gt_row gt_right" headers="unarmed robbery">155</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<p><code>fmt_number()</code> is one of several formatting functions available in <code>gt</code>. For example, we could use <code>fmt_currency()</code> to format columns according to the conventions for currency values, <code>fmt_date()</code> for dates or <code>fmt_percent()</code> for percentages.</p>
<p>The <code>region</code> column only has two values: <code>West Malaysia</code> for states and territories in Peninsular Malaysia and <code>East Malaysia</code> for states on the island of Borneo. Rather than repeat these two values on every row of the table – which is a waste of space and makes the table more cluttered than necessary – we can instead group the rows according to these two regions and then only show the region names once at the top of each group.</p>
<p><code>gt()</code> will automatically create group headings in a table if the data frame or tibble passed to <code>gt()</code> contains groups created by the <code>group_by()</code> function from the <code>dplyr</code> package. All we have to do is use <code>group_by()</code> to specify which column (in this case, <code>region</code>) contains the values that we should use to determine which group each row is in.</p>
<div class="cell" data-exercise="true">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>violence <span class="sc">|&gt;</span> </span>
<span id="cb10-2"><a href="#cb10-2"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> crime_type, <span class="at">values_from =</span> count) <span class="sc">|&gt;</span> </span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="fu">select</span>(</span>
<span id="cb10-4"><a href="#cb10-4"></a>    region, state, murder, rape, <span class="st">`</span><span class="at">aggravated assault</span><span class="st">`</span>, <span class="st">`</span><span class="at">armed robbery</span><span class="st">`</span>, </span>
<span id="cb10-5"><a href="#cb10-5"></a>    <span class="st">`</span><span class="at">unarmed robbery</span><span class="st">`</span></span>
<span id="cb10-6"><a href="#cb10-6"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb10-7"><a href="#cb10-7"></a>  <span class="fu">group_by</span>(region) <span class="sc">|&gt;</span> </span>
<span id="cb10-8"><a href="#cb10-8"></a>  <span class="co"># Functions from `dplyr`, `tidyr` etc above and functions from `gt` below</span></span>
<span id="cb10-9"><a href="#cb10-9"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> </span>
<span id="cb10-10"><a href="#cb10-10"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">where</span>(is.numeric), <span class="at">decimals =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<div id="jppdfigspr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#jppdfigspr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jppdfigspr thead, #jppdfigspr tbody, #jppdfigspr tfoot, #jppdfigspr tr, #jppdfigspr td, #jppdfigspr th {
  border-style: none;
}

#jppdfigspr p {
  margin: 0;
  padding: 0;
}

#jppdfigspr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jppdfigspr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jppdfigspr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jppdfigspr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jppdfigspr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jppdfigspr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jppdfigspr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jppdfigspr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jppdfigspr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jppdfigspr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jppdfigspr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jppdfigspr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jppdfigspr .gt_spanner_row {
  border-bottom-style: hidden;
}

#jppdfigspr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jppdfigspr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jppdfigspr .gt_from_md > :first-child {
  margin-top: 0;
}

#jppdfigspr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jppdfigspr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jppdfigspr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jppdfigspr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jppdfigspr .gt_row_group_first td {
  border-top-width: 2px;
}

#jppdfigspr .gt_row_group_first th {
  border-top-width: 2px;
}

#jppdfigspr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jppdfigspr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jppdfigspr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jppdfigspr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jppdfigspr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jppdfigspr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jppdfigspr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jppdfigspr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jppdfigspr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jppdfigspr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jppdfigspr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jppdfigspr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jppdfigspr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jppdfigspr .gt_left {
  text-align: left;
}

#jppdfigspr .gt_center {
  text-align: center;
}

#jppdfigspr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jppdfigspr .gt_font_normal {
  font-weight: normal;
}

#jppdfigspr .gt_font_bold {
  font-weight: bold;
}

#jppdfigspr .gt_font_italic {
  font-style: italic;
}

#jppdfigspr .gt_super {
  font-size: 65%;
}

#jppdfigspr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jppdfigspr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jppdfigspr .gt_indent_1 {
  text-indent: 5px;
}

#jppdfigspr .gt_indent_2 {
  text-indent: 10px;
}

#jppdfigspr .gt_indent_3 {
  text-indent: 15px;
}

#jppdfigspr .gt_indent_4 {
  text-indent: 20px;
}

#jppdfigspr .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="header gt_col_headings">
<th id="state" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">state</th>
<th id="murder" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">murder</th>
<th id="rape" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">rape</th>
<th id="aggravated assault" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">aggravated assault</th>
<th id="armed robbery" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">armed robbery</th>
<th id="unarmed robbery" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">unarmed robbery</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd gt_group_heading_row">
<td colspan="6" id="East Malaysia" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">East Malaysia</td>
</tr>
<tr class="even gt_row_group_first">
<td class="gt_row gt_left" headers="East Malaysia  state">Sabah</td>
<td class="gt_row gt_right" headers="East Malaysia  murder">36</td>
<td class="gt_row gt_right" headers="East Malaysia  rape">211</td>
<td class="gt_row gt_right" headers="East Malaysia  aggravated assault">230</td>
<td class="gt_row gt_right" headers="East Malaysia  armed robbery">0</td>
<td class="gt_row gt_right" headers="East Malaysia  unarmed robbery">284</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="East Malaysia  state">Sarawak</td>
<td class="gt_row gt_right" headers="East Malaysia  murder">27</td>
<td class="gt_row gt_right" headers="East Malaysia  rape">150</td>
<td class="gt_row gt_right" headers="East Malaysia  aggravated assault">368</td>
<td class="gt_row gt_right" headers="East Malaysia  armed robbery">3</td>
<td class="gt_row gt_right" headers="East Malaysia  unarmed robbery">328</td>
</tr>
<tr class="even gt_group_heading_row">
<td colspan="6" id="West Malaysia" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">West Malaysia</td>
</tr>
<tr class="odd gt_row_group_first">
<td class="gt_row gt_left" headers="West Malaysia  state">Johor</td>
<td class="gt_row gt_right" headers="West Malaysia  murder">66</td>
<td class="gt_row gt_right" headers="West Malaysia  rape">196</td>
<td class="gt_row gt_right" headers="West Malaysia  aggravated assault">614</td>
<td class="gt_row gt_right" headers="West Malaysia  armed robbery">1</td>
<td class="gt_row gt_right" headers="West Malaysia  unarmed robbery">1,701</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="West Malaysia  state">Kedah</td>
<td class="gt_row gt_right" headers="West Malaysia  murder">21</td>
<td class="gt_row gt_right" headers="West Malaysia  rape">119</td>
<td class="gt_row gt_right" headers="West Malaysia  aggravated assault">364</td>
<td class="gt_row gt_right" headers="West Malaysia  armed robbery">2</td>
<td class="gt_row gt_right" headers="West Malaysia  unarmed robbery">490</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="West Malaysia  state">Kelantan</td>
<td class="gt_row gt_right" headers="West Malaysia  murder">13</td>
<td class="gt_row gt_right" headers="West Malaysia  rape">114</td>
<td class="gt_row gt_right" headers="West Malaysia  aggravated assault">252</td>
<td class="gt_row gt_right" headers="West Malaysia  armed robbery">2</td>
<td class="gt_row gt_right" headers="West Malaysia  unarmed robbery">219</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="West Malaysia  state">Kuala Lumpur</td>
<td class="gt_row gt_right" headers="West Malaysia  murder">37</td>
<td class="gt_row gt_right" headers="West Malaysia  rape">132</td>
<td class="gt_row gt_right" headers="West Malaysia  aggravated assault">651</td>
<td class="gt_row gt_right" headers="West Malaysia  armed robbery">4</td>
<td class="gt_row gt_right" headers="West Malaysia  unarmed robbery">3,175</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="West Malaysia  state">Melaka</td>
<td class="gt_row gt_right" headers="West Malaysia  murder">7</td>
<td class="gt_row gt_right" headers="West Malaysia  rape">69</td>
<td class="gt_row gt_right" headers="West Malaysia  aggravated assault">176</td>
<td class="gt_row gt_right" headers="West Malaysia  armed robbery">1</td>
<td class="gt_row gt_right" headers="West Malaysia  unarmed robbery">589</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="West Malaysia  state">Negeri Sembilan</td>
<td class="gt_row gt_right" headers="West Malaysia  murder">14</td>
<td class="gt_row gt_right" headers="West Malaysia  rape">91</td>
<td class="gt_row gt_right" headers="West Malaysia  aggravated assault">241</td>
<td class="gt_row gt_right" headers="West Malaysia  armed robbery">2</td>
<td class="gt_row gt_right" headers="West Malaysia  unarmed robbery">536</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="West Malaysia  state">Pahang</td>
<td class="gt_row gt_right" headers="West Malaysia  murder">16</td>
<td class="gt_row gt_right" headers="West Malaysia  rape">163</td>
<td class="gt_row gt_right" headers="West Malaysia  aggravated assault">188</td>
<td class="gt_row gt_right" headers="West Malaysia  armed robbery">1</td>
<td class="gt_row gt_right" headers="West Malaysia  unarmed robbery">288</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="West Malaysia  state">Perak</td>
<td class="gt_row gt_right" headers="West Malaysia  murder">35</td>
<td class="gt_row gt_right" headers="West Malaysia  rape">95</td>
<td class="gt_row gt_right" headers="West Malaysia  aggravated assault">380</td>
<td class="gt_row gt_right" headers="West Malaysia  armed robbery">4</td>
<td class="gt_row gt_right" headers="West Malaysia  unarmed robbery">626</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="West Malaysia  state">Perlis</td>
<td class="gt_row gt_right" headers="West Malaysia  murder">2</td>
<td class="gt_row gt_right" headers="West Malaysia  rape">30</td>
<td class="gt_row gt_right" headers="West Malaysia  aggravated assault">47</td>
<td class="gt_row gt_right" headers="West Malaysia  armed robbery">0</td>
<td class="gt_row gt_right" headers="West Malaysia  unarmed robbery">53</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="West Malaysia  state">Pulau Pinang</td>
<td class="gt_row gt_right" headers="West Malaysia  murder">17</td>
<td class="gt_row gt_right" headers="West Malaysia  rape">80</td>
<td class="gt_row gt_right" headers="West Malaysia  aggravated assault">275</td>
<td class="gt_row gt_right" headers="West Malaysia  armed robbery">0</td>
<td class="gt_row gt_right" headers="West Malaysia  unarmed robbery">706</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="West Malaysia  state">Selangor</td>
<td class="gt_row gt_right" headers="West Malaysia  murder">83</td>
<td class="gt_row gt_right" headers="West Malaysia  rape">321</td>
<td class="gt_row gt_right" headers="West Malaysia  aggravated assault">1,108</td>
<td class="gt_row gt_right" headers="West Malaysia  armed robbery">14</td>
<td class="gt_row gt_right" headers="West Malaysia  unarmed robbery">4,944</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="West Malaysia  state">Terengganu</td>
<td class="gt_row gt_right" headers="West Malaysia  murder">5</td>
<td class="gt_row gt_right" headers="West Malaysia  rape">64</td>
<td class="gt_row gt_right" headers="West Malaysia  aggravated assault">130</td>
<td class="gt_row gt_right" headers="West Malaysia  armed robbery">0</td>
<td class="gt_row gt_right" headers="West Malaysia  unarmed robbery">155</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<p>In tables containing lots of numbers it can be difficult to see patterns. One way to help readers to understand patterns is to map the numbers to an aesthetic property such as colour that people can easily see patterns in. To do this, we can colour the cells in a column according to the value of each cell using the <code>data_color()</code> function (note the spelling of ‘color’ in this function). To use <code>data_color()</code>, we specify the columns we want to shade using the <code>columns</code> argument and the colour palette we want to use using the <code>palette</code> argument.</p>
<p>In this example, we will only colour the values in two columns, so we will pass the column names (enclosed in <code>`</code>back ticks<code>`</code> if they contain a space) to the <code>columns</code> argument.</p>
<p>The easiest way to specify a colour palette is to use one of the built-in colour palettes that the <code>gt</code> package understands automatically. These use the same colour palette names we have used in previous tutorials when making use of functions such as <code>scale_fill_distiller()</code>.</p>
<div class="cell" data-exercise="true" data-exercise.lines="17">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb11-2"><a href="#cb11-2"></a></span>
<span id="cb11-3"><a href="#cb11-3"></a>violence <span class="sc">|&gt;</span> </span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> crime_type, <span class="at">values_from =</span> count) <span class="sc">|&gt;</span> </span>
<span id="cb11-5"><a href="#cb11-5"></a>  <span class="fu">select</span>(</span>
<span id="cb11-6"><a href="#cb11-6"></a>    region, state, murder, rape, <span class="st">`</span><span class="at">aggravated assault</span><span class="st">`</span>, <span class="st">`</span><span class="at">armed robbery</span><span class="st">`</span>, </span>
<span id="cb11-7"><a href="#cb11-7"></a>    <span class="st">`</span><span class="at">unarmed robbery</span><span class="st">`</span></span>
<span id="cb11-8"><a href="#cb11-8"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb11-9"><a href="#cb11-9"></a>  <span class="fu">group_by</span>(region) <span class="sc">|&gt;</span> </span>
<span id="cb11-10"><a href="#cb11-10"></a>  <span class="co"># Functions from `dplyr`, `tidyr` etc above and functions from `gt` below</span></span>
<span id="cb11-11"><a href="#cb11-11"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> </span>
<span id="cb11-12"><a href="#cb11-12"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">where</span>(is.numeric), <span class="at">decimals =</span> <span class="dv">0</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-13"><a href="#cb11-13"></a>  <span class="fu">data_color</span>(<span class="at">columns =</span> <span class="st">`</span><span class="at">unarmed robbery</span><span class="st">`</span>, <span class="at">palette =</span> <span class="st">"Oranges"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-14"><a href="#cb11-14"></a>  <span class="fu">data_color</span>(<span class="at">columns =</span> rape, <span class="at">palette =</span> <span class="st">"Blues"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<div id="sycxervxyu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#sycxervxyu table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#sycxervxyu thead, #sycxervxyu tbody, #sycxervxyu tfoot, #sycxervxyu tr, #sycxervxyu td, #sycxervxyu th {
  border-style: none;
}

#sycxervxyu p {
  margin: 0;
  padding: 0;
}

#sycxervxyu .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#sycxervxyu .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#sycxervxyu .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#sycxervxyu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#sycxervxyu .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sycxervxyu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sycxervxyu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sycxervxyu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#sycxervxyu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#sycxervxyu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#sycxervxyu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#sycxervxyu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#sycxervxyu .gt_spanner_row {
  border-bottom-style: hidden;
}

#sycxervxyu .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#sycxervxyu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#sycxervxyu .gt_from_md > :first-child {
  margin-top: 0;
}

#sycxervxyu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#sycxervxyu .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#sycxervxyu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#sycxervxyu .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#sycxervxyu .gt_row_group_first td {
  border-top-width: 2px;
}

#sycxervxyu .gt_row_group_first th {
  border-top-width: 2px;
}

#sycxervxyu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sycxervxyu .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#sycxervxyu .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#sycxervxyu .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sycxervxyu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sycxervxyu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#sycxervxyu .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#sycxervxyu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#sycxervxyu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sycxervxyu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sycxervxyu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sycxervxyu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sycxervxyu .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sycxervxyu .gt_left {
  text-align: left;
}

#sycxervxyu .gt_center {
  text-align: center;
}

#sycxervxyu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#sycxervxyu .gt_font_normal {
  font-weight: normal;
}

#sycxervxyu .gt_font_bold {
  font-weight: bold;
}

#sycxervxyu .gt_font_italic {
  font-style: italic;
}

#sycxervxyu .gt_super {
  font-size: 65%;
}

#sycxervxyu .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#sycxervxyu .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#sycxervxyu .gt_indent_1 {
  text-indent: 5px;
}

#sycxervxyu .gt_indent_2 {
  text-indent: 10px;
}

#sycxervxyu .gt_indent_3 {
  text-indent: 15px;
}

#sycxervxyu .gt_indent_4 {
  text-indent: 20px;
}

#sycxervxyu .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="header gt_col_headings">
<th id="state" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">state</th>
<th id="murder" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">murder</th>
<th id="rape" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">rape</th>
<th id="aggravated assault" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">aggravated assault</th>
<th id="armed robbery" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">armed robbery</th>
<th id="unarmed robbery" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">unarmed robbery</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd gt_group_heading_row">
<td colspan="6" id="East Malaysia" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">East Malaysia</td>
</tr>
<tr class="even gt_row_group_first">
<td class="gt_row gt_left" headers="East Malaysia  state">Sabah</td>
<td class="gt_row gt_right" headers="East Malaysia  murder">36</td>
<td class="gt_row gt_right" headers="East Malaysia  rape" style="background-color: #4393C6; color: #FFFFFF">211</td>
<td class="gt_row gt_right" headers="East Malaysia  aggravated assault">230</td>
<td class="gt_row gt_right" headers="East Malaysia  armed robbery">0</td>
<td class="gt_row gt_right" headers="East Malaysia  unarmed robbery" style="background-color: #FFEFE0; color: #000000">284</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="East Malaysia  state">Sarawak</td>
<td class="gt_row gt_right" headers="East Malaysia  murder">27</td>
<td class="gt_row gt_right" headers="East Malaysia  rape" style="background-color: #90C2DE; color: #000000">150</td>
<td class="gt_row gt_right" headers="East Malaysia  aggravated assault">368</td>
<td class="gt_row gt_right" headers="East Malaysia  armed robbery">3</td>
<td class="gt_row gt_right" headers="East Malaysia  unarmed robbery" style="background-color: #FFEEDE; color: #000000">328</td>
</tr>
<tr class="even gt_group_heading_row">
<td colspan="6" id="West Malaysia" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">West Malaysia</td>
</tr>
<tr class="odd gt_row_group_first">
<td class="gt_row gt_left" headers="West Malaysia  state">Johor</td>
<td class="gt_row gt_right" headers="West Malaysia  murder">66</td>
<td class="gt_row gt_right" headers="West Malaysia  rape" style="background-color: #559ECD; color: #FFFFFF">196</td>
<td class="gt_row gt_right" headers="West Malaysia  aggravated assault">614</td>
<td class="gt_row gt_right" headers="West Malaysia  armed robbery">1</td>
<td class="gt_row gt_right" headers="West Malaysia  unarmed robbery" style="background-color: #FEB87C; color: #000000">1,701</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="West Malaysia  state">Kedah</td>
<td class="gt_row gt_right" headers="West Malaysia  murder">21</td>
<td class="gt_row gt_right" headers="West Malaysia  rape" style="background-color: #B4D3E9; color: #000000">119</td>
<td class="gt_row gt_right" headers="West Malaysia  aggravated assault">364</td>
<td class="gt_row gt_right" headers="West Malaysia  armed robbery">2</td>
<td class="gt_row gt_right" headers="West Malaysia  unarmed robbery" style="background-color: #FEEAD6; color: #000000">490</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="West Malaysia  state">Kelantan</td>
<td class="gt_row gt_right" headers="West Malaysia  murder">13</td>
<td class="gt_row gt_right" headers="West Malaysia  rape" style="background-color: #BAD6EB; color: #000000">114</td>
<td class="gt_row gt_right" headers="West Malaysia  aggravated assault">252</td>
<td class="gt_row gt_right" headers="West Malaysia  armed robbery">2</td>
<td class="gt_row gt_right" headers="West Malaysia  unarmed robbery" style="background-color: #FFF1E3; color: #000000">219</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="West Malaysia  state">Kuala Lumpur</td>
<td class="gt_row gt_right" headers="West Malaysia  murder">37</td>
<td class="gt_row gt_right" headers="West Malaysia  rape" style="background-color: #A6CDE4; color: #000000">132</td>
<td class="gt_row gt_right" headers="West Malaysia  aggravated assault">651</td>
<td class="gt_row gt_right" headers="West Malaysia  armed robbery">4</td>
<td class="gt_row gt_right" headers="West Malaysia  unarmed robbery" style="background-color: #EE6611; color: #FFFFFF">3,175</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="West Malaysia  state">Melaka</td>
<td class="gt_row gt_right" headers="West Malaysia  murder">7</td>
<td class="gt_row gt_right" headers="West Malaysia  rape" style="background-color: #DCEAF6; color: #000000">69</td>
<td class="gt_row gt_right" headers="West Malaysia  aggravated assault">176</td>
<td class="gt_row gt_right" headers="West Malaysia  armed robbery">1</td>
<td class="gt_row gt_right" headers="West Malaysia  unarmed robbery" style="background-color: #FEE8D2; color: #000000">589</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="West Malaysia  state">Negeri Sembilan</td>
<td class="gt_row gt_right" headers="West Malaysia  murder">14</td>
<td class="gt_row gt_right" headers="West Malaysia  rape" style="background-color: #CEE0F2; color: #000000">91</td>
<td class="gt_row gt_right" headers="West Malaysia  aggravated assault">241</td>
<td class="gt_row gt_right" headers="West Malaysia  armed robbery">2</td>
<td class="gt_row gt_right" headers="West Malaysia  unarmed robbery" style="background-color: #FEE9D4; color: #000000">536</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="West Malaysia  state">Pahang</td>
<td class="gt_row gt_right" headers="West Malaysia  murder">16</td>
<td class="gt_row gt_right" headers="West Malaysia  rape" style="background-color: #7EB8DA; color: #000000">163</td>
<td class="gt_row gt_right" headers="West Malaysia  aggravated assault">188</td>
<td class="gt_row gt_right" headers="West Malaysia  armed robbery">1</td>
<td class="gt_row gt_right" headers="West Malaysia  unarmed robbery" style="background-color: #FFEFE0; color: #000000">288</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="West Malaysia  state">Perak</td>
<td class="gt_row gt_right" headers="West Malaysia  murder">35</td>
<td class="gt_row gt_right" headers="West Malaysia  rape" style="background-color: #CBDEF1; color: #000000">95</td>
<td class="gt_row gt_right" headers="West Malaysia  aggravated assault">380</td>
<td class="gt_row gt_right" headers="West Malaysia  armed robbery">4</td>
<td class="gt_row gt_right" headers="West Malaysia  unarmed robbery" style="background-color: #FEE7D0; color: #000000">626</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="West Malaysia  state">Perlis</td>
<td class="gt_row gt_right" headers="West Malaysia  murder">2</td>
<td class="gt_row gt_right" headers="West Malaysia  rape" style="background-color: #F7FBFF; color: #000000">30</td>
<td class="gt_row gt_right" headers="West Malaysia  aggravated assault">47</td>
<td class="gt_row gt_right" headers="West Malaysia  armed robbery">0</td>
<td class="gt_row gt_right" headers="West Malaysia  unarmed robbery" style="background-color: #FFF5EB; color: #000000">53</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="West Malaysia  state">Pulau Pinang</td>
<td class="gt_row gt_right" headers="West Malaysia  murder">17</td>
<td class="gt_row gt_right" headers="West Malaysia  rape" style="background-color: #D5E5F4; color: #000000">80</td>
<td class="gt_row gt_right" headers="West Malaysia  aggravated assault">275</td>
<td class="gt_row gt_right" headers="West Malaysia  armed robbery">0</td>
<td class="gt_row gt_right" headers="West Malaysia  unarmed robbery" style="background-color: #FEE4CB; color: #000000">706</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="West Malaysia  state">Selangor</td>
<td class="gt_row gt_right" headers="West Malaysia  murder">83</td>
<td class="gt_row gt_right" headers="West Malaysia  rape" style="background-color: #08306B; color: #FFFFFF">321</td>
<td class="gt_row gt_right" headers="West Malaysia  aggravated assault">1,108</td>
<td class="gt_row gt_right" headers="West Malaysia  armed robbery">14</td>
<td class="gt_row gt_right" headers="West Malaysia  unarmed robbery" style="background-color: #7F2704; color: #FFFFFF">4,944</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="West Malaysia  state">Terengganu</td>
<td class="gt_row gt_right" headers="West Malaysia  murder">5</td>
<td class="gt_row gt_right" headers="West Malaysia  rape" style="background-color: #E0ECF8; color: #000000">64</td>
<td class="gt_row gt_right" headers="West Malaysia  aggravated assault">130</td>
<td class="gt_row gt_right" headers="West Malaysia  armed robbery">0</td>
<td class="gt_row gt_right" headers="West Malaysia  unarmed robbery" style="background-color: #FFF2E6; color: #000000">155</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="box notewell">
<p>In this table we use two different colours to show the patterns in the frequency of murder and unarmed robbery. This is because we want readers to remember that different types of crime are <em>different</em> and so comparisons that treat crimes as being equivalent to one another are likely to be flawed. If we used the same colour across columns, readers might end up seeing that the shade used for unarmed robberies in Kuala Lumpur was darker than the shade showing the number of murders and conclude that unarmed robberies were a bigger problem than murders. This would be a potentially false conclusion because a single murder and a single unarmed robbery are not the same in terms of their seriousness.</p>
<p>For the same reason the table does not include a column showing the total number of crimes in each state – when we total all types of crime together, we are implicitly assuming that all types of crime are the same when that is obviously untrue.</p>
</div>
</section><section id="adding-summary-rows" class="level3" data-number="15.2.3"><h3 data-number="15.2.3" class="anchored" data-anchor-id="adding-summary-rows">
<span class="header-section-number">15.2.3</span> Adding summary rows</h3>
<p>The final thing we will add to this table is a summary row containing the total number of each type of crime across all the states and territories. We do this using the <code>summary_rows()</code> function from <code>gt</code>. We specify the columns we want to summarise using the <code>columns</code> argument as we did for <code>fmt_number()</code>.</p>
<p>Summary rows can be produced using lots of different R functions. For example, we could use the <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> function to produce a summary row showing the mean (average) number of crimes of each time across the states. In this case, we want to know the total number of each type of crime across all states, so we will use the <code><a href="https://rdrr.io/r/base/sum.html">sum()</a></code> function. To specify this, we pass the <code>fns</code> argument to <code>summary_rows()</code>. For reasons we don’t need to go into, the <code>funs</code> argument must be a <em>list</em> of function names, even if only one function name is needed. So to tell <code>summary_rows()</code> to produce summaries based on totals, we need to specify <code>fns = list("sum")</code>.</p>
<p>By default, this will produce a row at the bottom of the table containing the totals, but that row will have a label on the left that is based on the name of the function – <code><a href="https://rdrr.io/r/base/sum.html">sum()</a></code> used to produce the summary values. Since more people will know the word ‘total’ than the word ‘sum’, we will instead specify that this summary row should be labelled as ‘total’. To do this, we have to <em>name</em> the entry in the list passed to <code>fns</code> that specifies the function to use, i.e. we need to specify <code>fns = list("total = "sum")</code> rather than just <code>fns = list("sum")</code>.</p>
<p>By default, <code>summary_rows()</code> formats the calculated summary values as numbers using <code>fmt_numeric()</code>, we also need to specify <code>decimals = 0</code> as before.</p>
<div class="cell" data-exercise="true" data-exercise.lines="20">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>violence <span class="sc">|&gt;</span> </span>
<span id="cb12-2"><a href="#cb12-2"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> crime_type, <span class="at">values_from =</span> count) <span class="sc">|&gt;</span> </span>
<span id="cb12-3"><a href="#cb12-3"></a>  <span class="fu">select</span>(</span>
<span id="cb12-4"><a href="#cb12-4"></a>    region, state, murder, rape, <span class="st">`</span><span class="at">aggravated assault</span><span class="st">`</span>, <span class="st">`</span><span class="at">armed robbery</span><span class="st">`</span>, </span>
<span id="cb12-5"><a href="#cb12-5"></a>    <span class="st">`</span><span class="at">unarmed robbery</span><span class="st">`</span></span>
<span id="cb12-6"><a href="#cb12-6"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb12-7"><a href="#cb12-7"></a>  <span class="fu">group_by</span>(region) <span class="sc">|&gt;</span> </span>
<span id="cb12-8"><a href="#cb12-8"></a>  <span class="co"># Functions from `dplyr`, `tidyr` etc above and functions from `gt` below</span></span>
<span id="cb12-9"><a href="#cb12-9"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> </span>
<span id="cb12-10"><a href="#cb12-10"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="fu">where</span>(is.numeric), <span class="at">decimals =</span> <span class="dv">0</span>) <span class="sc">|&gt;</span> </span>
<span id="cb12-11"><a href="#cb12-11"></a>  <span class="fu">data_color</span>(<span class="at">columns =</span> <span class="st">`</span><span class="at">unarmed robbery</span><span class="st">`</span>, <span class="at">palette =</span> <span class="st">"Oranges"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb12-12"><a href="#cb12-12"></a>  <span class="fu">data_color</span>(<span class="at">columns =</span> rape, <span class="at">palette =</span> <span class="st">"Blues"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb12-13"><a href="#cb12-13"></a>  <span class="fu">summary_rows</span>(</span>
<span id="cb12-14"><a href="#cb12-14"></a>    <span class="at">columns =</span> <span class="fu">where</span>(is.numeric),</span>
<span id="cb12-15"><a href="#cb12-15"></a>    <span class="at">fns =</span> <span class="fu">list</span>(<span class="st">"total"</span> <span class="ot">=</span> <span class="st">"sum"</span>),</span>
<span id="cb12-16"><a href="#cb12-16"></a>    <span class="at">decimals =</span> <span class="dv">0</span></span>
<span id="cb12-17"><a href="#cb12-17"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<div id="diyidxswst" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#diyidxswst table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#diyidxswst thead, #diyidxswst tbody, #diyidxswst tfoot, #diyidxswst tr, #diyidxswst td, #diyidxswst th {
  border-style: none;
}

#diyidxswst p {
  margin: 0;
  padding: 0;
}

#diyidxswst .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#diyidxswst .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#diyidxswst .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#diyidxswst .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#diyidxswst .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#diyidxswst .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#diyidxswst .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#diyidxswst .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#diyidxswst .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#diyidxswst .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#diyidxswst .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#diyidxswst .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#diyidxswst .gt_spanner_row {
  border-bottom-style: hidden;
}

#diyidxswst .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#diyidxswst .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#diyidxswst .gt_from_md > :first-child {
  margin-top: 0;
}

#diyidxswst .gt_from_md > :last-child {
  margin-bottom: 0;
}

#diyidxswst .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#diyidxswst .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#diyidxswst .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#diyidxswst .gt_row_group_first td {
  border-top-width: 2px;
}

#diyidxswst .gt_row_group_first th {
  border-top-width: 2px;
}

#diyidxswst .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#diyidxswst .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#diyidxswst .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#diyidxswst .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#diyidxswst .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#diyidxswst .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#diyidxswst .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#diyidxswst .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#diyidxswst .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#diyidxswst .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#diyidxswst .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#diyidxswst .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#diyidxswst .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#diyidxswst .gt_left {
  text-align: left;
}

#diyidxswst .gt_center {
  text-align: center;
}

#diyidxswst .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#diyidxswst .gt_font_normal {
  font-weight: normal;
}

#diyidxswst .gt_font_bold {
  font-weight: bold;
}

#diyidxswst .gt_font_italic {
  font-style: italic;
}

#diyidxswst .gt_super {
  font-size: 65%;
}

#diyidxswst .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#diyidxswst .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#diyidxswst .gt_indent_1 {
  text-indent: 5px;
}

#diyidxswst .gt_indent_2 {
  text-indent: 10px;
}

#diyidxswst .gt_indent_3 {
  text-indent: 15px;
}

#diyidxswst .gt_indent_4 {
  text-indent: 20px;
}

#diyidxswst .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="header gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th id="state" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">state</th>
<th id="murder" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">murder</th>
<th id="rape" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">rape</th>
<th id="aggravated assault" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">aggravated assault</th>
<th id="armed robbery" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">armed robbery</th>
<th id="unarmed robbery" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">unarmed robbery</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd gt_group_heading_row">
<td colspan="7" id="East Malaysia" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">East Malaysia</td>
</tr>
<tr class="even gt_row_group_first">
<td id="stub_1_1" class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th" scope="row"></td>
<td class="gt_row gt_left" headers="East Malaysia stub_1_1 state">Sabah</td>
<td class="gt_row gt_right" headers="East Malaysia stub_1_1 murder">36</td>
<td class="gt_row gt_right" headers="East Malaysia stub_1_1 rape" style="background-color: #4393C6; color: #FFFFFF">211</td>
<td class="gt_row gt_right" headers="East Malaysia stub_1_1 aggravated assault">230</td>
<td class="gt_row gt_right" headers="East Malaysia stub_1_1 armed robbery">0</td>
<td class="gt_row gt_right" headers="East Malaysia stub_1_1 unarmed robbery" style="background-color: #FFEFE0; color: #000000">284</td>
</tr>
<tr class="odd">
<td id="stub_1_2" class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th" scope="row"></td>
<td class="gt_row gt_left" headers="East Malaysia stub_1_2 state">Sarawak</td>
<td class="gt_row gt_right" headers="East Malaysia stub_1_2 murder">27</td>
<td class="gt_row gt_right" headers="East Malaysia stub_1_2 rape" style="background-color: #90C2DE; color: #000000">150</td>
<td class="gt_row gt_right" headers="East Malaysia stub_1_2 aggravated assault">368</td>
<td class="gt_row gt_right" headers="East Malaysia stub_1_2 armed robbery">3</td>
<td class="gt_row gt_right" headers="East Malaysia stub_1_2 unarmed robbery" style="background-color: #FFEEDE; color: #000000">328</td>
</tr>
<tr class="even">
<td id="summary_stub_East Malaysia_1" class="gt_row gt_left gt_stub gt_summary_row gt_first_summary_row thick gt_last_summary_row" data-quarto-table-cell-role="th" scope="row">sum</td>
<td class="gt_row gt_left gt_summary_row gt_first_summary_row thick gt_last_summary_row" headers="East Malaysia summary_stub_East Malaysia_1 state">—</td>
<td class="gt_row gt_right gt_summary_row gt_first_summary_row thick gt_last_summary_row" headers="East Malaysia summary_stub_East Malaysia_1 murder">63</td>
<td class="gt_row gt_right gt_summary_row gt_first_summary_row thick gt_last_summary_row" headers="East Malaysia summary_stub_East Malaysia_1 rape">361</td>
<td class="gt_row gt_right gt_summary_row gt_first_summary_row thick gt_last_summary_row" headers="East Malaysia summary_stub_East Malaysia_1 aggravated assault">598</td>
<td class="gt_row gt_right gt_summary_row gt_first_summary_row thick gt_last_summary_row" headers="East Malaysia summary_stub_East Malaysia_1 armed robbery">3</td>
<td class="gt_row gt_right gt_summary_row gt_first_summary_row thick gt_last_summary_row" headers="East Malaysia summary_stub_East Malaysia_1 unarmed robbery">612</td>
</tr>
<tr class="odd gt_group_heading_row">
<td colspan="7" id="West Malaysia" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">West Malaysia</td>
</tr>
<tr class="even gt_row_group_first">
<td id="stub_1_3" class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th" scope="row"></td>
<td class="gt_row gt_left" headers="West Malaysia stub_1_3 state">Johor</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_3 murder">66</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_3 rape" style="background-color: #559ECD; color: #FFFFFF">196</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_3 aggravated assault">614</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_3 armed robbery">1</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_3 unarmed robbery" style="background-color: #FEB87C; color: #000000">1,701</td>
</tr>
<tr class="odd">
<td id="stub_1_4" class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th" scope="row"></td>
<td class="gt_row gt_left" headers="West Malaysia stub_1_4 state">Kedah</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_4 murder">21</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_4 rape" style="background-color: #B4D3E9; color: #000000">119</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_4 aggravated assault">364</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_4 armed robbery">2</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_4 unarmed robbery" style="background-color: #FEEAD6; color: #000000">490</td>
</tr>
<tr class="even">
<td id="stub_1_5" class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th" scope="row"></td>
<td class="gt_row gt_left" headers="West Malaysia stub_1_5 state">Kelantan</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_5 murder">13</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_5 rape" style="background-color: #BAD6EB; color: #000000">114</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_5 aggravated assault">252</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_5 armed robbery">2</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_5 unarmed robbery" style="background-color: #FFF1E3; color: #000000">219</td>
</tr>
<tr class="odd">
<td id="stub_1_6" class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th" scope="row"></td>
<td class="gt_row gt_left" headers="West Malaysia stub_1_6 state">Kuala Lumpur</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_6 murder">37</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_6 rape" style="background-color: #A6CDE4; color: #000000">132</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_6 aggravated assault">651</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_6 armed robbery">4</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_6 unarmed robbery" style="background-color: #EE6611; color: #FFFFFF">3,175</td>
</tr>
<tr class="even">
<td id="stub_1_7" class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th" scope="row"></td>
<td class="gt_row gt_left" headers="West Malaysia stub_1_7 state">Melaka</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_7 murder">7</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_7 rape" style="background-color: #DCEAF6; color: #000000">69</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_7 aggravated assault">176</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_7 armed robbery">1</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_7 unarmed robbery" style="background-color: #FEE8D2; color: #000000">589</td>
</tr>
<tr class="odd">
<td id="stub_1_8" class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th" scope="row"></td>
<td class="gt_row gt_left" headers="West Malaysia stub_1_8 state">Negeri Sembilan</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_8 murder">14</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_8 rape" style="background-color: #CEE0F2; color: #000000">91</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_8 aggravated assault">241</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_8 armed robbery">2</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_8 unarmed robbery" style="background-color: #FEE9D4; color: #000000">536</td>
</tr>
<tr class="even">
<td id="stub_1_9" class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th" scope="row"></td>
<td class="gt_row gt_left" headers="West Malaysia stub_1_9 state">Pahang</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_9 murder">16</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_9 rape" style="background-color: #7EB8DA; color: #000000">163</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_9 aggravated assault">188</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_9 armed robbery">1</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_9 unarmed robbery" style="background-color: #FFEFE0; color: #000000">288</td>
</tr>
<tr class="odd">
<td id="stub_1_10" class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th" scope="row"></td>
<td class="gt_row gt_left" headers="West Malaysia stub_1_10 state">Perak</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_10 murder">35</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_10 rape" style="background-color: #CBDEF1; color: #000000">95</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_10 aggravated assault">380</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_10 armed robbery">4</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_10 unarmed robbery" style="background-color: #FEE7D0; color: #000000">626</td>
</tr>
<tr class="even">
<td id="stub_1_11" class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th" scope="row"></td>
<td class="gt_row gt_left" headers="West Malaysia stub_1_11 state">Perlis</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_11 murder">2</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_11 rape" style="background-color: #F7FBFF; color: #000000">30</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_11 aggravated assault">47</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_11 armed robbery">0</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_11 unarmed robbery" style="background-color: #FFF5EB; color: #000000">53</td>
</tr>
<tr class="odd">
<td id="stub_1_12" class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th" scope="row"></td>
<td class="gt_row gt_left" headers="West Malaysia stub_1_12 state">Pulau Pinang</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_12 murder">17</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_12 rape" style="background-color: #D5E5F4; color: #000000">80</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_12 aggravated assault">275</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_12 armed robbery">0</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_12 unarmed robbery" style="background-color: #FEE4CB; color: #000000">706</td>
</tr>
<tr class="even">
<td id="stub_1_13" class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th" scope="row"></td>
<td class="gt_row gt_left" headers="West Malaysia stub_1_13 state">Selangor</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_13 murder">83</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_13 rape" style="background-color: #08306B; color: #FFFFFF">321</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_13 aggravated assault">1,108</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_13 armed robbery">14</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_13 unarmed robbery" style="background-color: #7F2704; color: #FFFFFF">4,944</td>
</tr>
<tr class="odd">
<td id="stub_1_14" class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th" scope="row"></td>
<td class="gt_row gt_left" headers="West Malaysia stub_1_14 state">Terengganu</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_14 murder">5</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_14 rape" style="background-color: #E0ECF8; color: #000000">64</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_14 aggravated assault">130</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_14 armed robbery">0</td>
<td class="gt_row gt_right" headers="West Malaysia stub_1_14 unarmed robbery" style="background-color: #FFF2E6; color: #000000">155</td>
</tr>
<tr class="even">
<td id="summary_stub_West Malaysia_1" class="gt_row gt_left gt_stub gt_summary_row gt_first_summary_row thick gt_last_summary_row" data-quarto-table-cell-role="th" scope="row">sum</td>
<td class="gt_row gt_left gt_summary_row gt_first_summary_row thick gt_last_summary_row" headers="West Malaysia summary_stub_West Malaysia_1 state">—</td>
<td class="gt_row gt_right gt_summary_row gt_first_summary_row thick gt_last_summary_row" headers="West Malaysia summary_stub_West Malaysia_1 murder">316</td>
<td class="gt_row gt_right gt_summary_row gt_first_summary_row thick gt_last_summary_row" headers="West Malaysia summary_stub_West Malaysia_1 rape">1474</td>
<td class="gt_row gt_right gt_summary_row gt_first_summary_row thick gt_last_summary_row" headers="West Malaysia summary_stub_West Malaysia_1 aggravated assault">4426</td>
<td class="gt_row gt_right gt_summary_row gt_first_summary_row thick gt_last_summary_row" headers="West Malaysia summary_stub_West Malaysia_1 armed robbery">31</td>
<td class="gt_row gt_right gt_summary_row gt_first_summary_row thick gt_last_summary_row" headers="West Malaysia summary_stub_West Malaysia_1 unarmed robbery">13482</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="box notewell">
<p>Tables are good for showing detailed information, particularly when we want to present multiple pieces of information about a single place. But it can be hard to spot patterns in tables even with coloured cells. For this reason, <strong>do not use tables when you are primarily trying to show the relationship between two or more variables</strong>. In the next section, we will learn to create bar chart in R to show patterns more effectively.</p>
</div>
<!--
<div class="box extra-detail">

<h5 id="gtword-box1-title" class="box-title">Using the `gt` package with Word documents</h5>

<div id="gtword-box1" class="box-content">

The `gt` package is primarily designed to produce tables in HTML or PDF 
documents. If you want to use `gt` to create tables in Word documents, you will
need to adjust the YAML header section of your Rmarkdown document. Specifically,
you must add a line to your YAML header specifying:

```
output: rtf_document
```

`rtf` here means rich-text format, which is a file format created by Microsoft
for documents that can be shared between Word and other word-processing 
software.

If there is already a line in the YAML header that starts `output: `, you should
replace this with `output: rtf_document`. Note that `gt` will _not_ work if you
use `output: word_document`, which is the usual output format for producing Word
documents.

A few features of the `gt` package – including colouring table cells based on
their value – are not available for RTF documents. This is one reason why you
may want to prefer producing output as HTML where possible.

</div>

</div>

<script>
$("#gtword-box1-title").click(function () { $("#section-gtword-box1").toggle("slow") })
</script>
-->
</section></section><section id="bar-charts" class="level2" data-number="15.3"><h2 data-number="15.3" class="anchored" data-anchor-id="bar-charts">
<span class="header-section-number">15.3</span> Bar charts</h2>
<p>Bar charts are useful for showing values of one <em>continuous</em> variable (e.g.&nbsp;a count of crimes) for each value of one <em>categorical</em> variable (e.g.&nbsp;states of a country). Bar charts are very common, but there are several things we can do to make them more useful. In this section we will learn how to construct a good bar chart.</p>
<p>You’re already an expert at making maps using functions from the <code>ggplot2</code> package. We can use these same functions to create many other types of graphics. For example, we can use <code>geom_bar()</code> to create bar charts just as we use <code>geom_sf()</code> to create a map using data stored in an SF object.</p>
<p><code>geom_bar()</code> calculates the length of each bar on a chart by counting the number of rows of data in each category. This isn’t what we want to do to visualise the <code>violence</code> object, since the data provided by the Royal Malaysian Police are already in the form of counts of crimes. Instead, we will use the <code>geom_col()</code> function, which creates bar charts from this type of summary data.</p>
<p>To create a simple bar chart, we will work with the original (long-format) data and filter it to show only the number of murders in each state.</p>
<div class="cell" data-exercise="true">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>violence <span class="sc">|&gt;</span> </span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="fu">filter</span>(crime_type <span class="sc">==</span> <span class="st">"murder"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> state, <span class="at">y =</span> count))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/bars-exercise1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can improve this chart in several ways:</p>
<ul>
<li>We can switch the order of the variables used for the <code>x</code> and <code>y</code> aesthetics so that the bars are horizontal rather than vertical, which will stop the state names from overlapping.</li>
<li>We can change the axis labels, add a title and so on using <code>labs()</code>.</li>
<li>We can reduce the visual clutter in the chart using <code>theme_minimal()</code>.</li>
</ul>
<div class="cell" data-exercise="true">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>violence <span class="sc">|&gt;</span> </span>
<span id="cb14-2"><a href="#cb14-2"></a>  <span class="fu">filter</span>(crime_type <span class="sc">==</span> <span class="st">"murder"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-3"><a href="#cb14-3"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> count, <span class="at">y =</span> state)) <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5"></a>  <span class="fu">labs</span>(</span>
<span id="cb14-6"><a href="#cb14-6"></a>    <span class="at">title =</span> <span class="st">"Murders in Malaysian states, 2017"</span>,</span>
<span id="cb14-7"><a href="#cb14-7"></a>    <span class="at">caption =</span> <span class="st">"Data from the Royal Malaysian Police"</span>,</span>
<span id="cb14-8"><a href="#cb14-8"></a>    <span class="at">x =</span> <span class="st">"number of murders"</span>,</span>
<span id="cb14-9"><a href="#cb14-9"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb14-10"><a href="#cb14-10"></a>  ) <span class="sc">+</span></span>
<span id="cb14-11"><a href="#cb14-11"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/bars-exercise2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This chart is better, but we can improve it further. For example, we can reduce the space between the state names and the bars by setting the <code>expand</code> argument to the <code>scale_x_continuous()</code> function. <code>scale_x_continuous()</code> works in a similar way to the other scale functions we have used already, such as <code>scale_fill_brewer()</code> to control the colour of areas in a choropleth map.</p>
<p>Although we are trying to reduce the gap between the bars and labels on the <em>y</em> axis, we use a function that change the <em>x</em> axis. This is because the space we are reducing is created by R by-default adding some space to each end of any continuous axis, such as the count of murders.</p>
<p>We can specify the space at the end of each axis using the helper function <code>expansion()</code>, but in this case we just want to remove the space completely so we can just set <code>expand = c(0, 0)</code>.</p>
<p>At the same time, we can also remove the grid lines on the <em>y</em> axis (i.e.&nbsp;those running along the length of the bars) since they don’t really make it any easier to understand the chart. As a general principle, we want to remove anything on a chart that does not contribute to communicating information, since unnecessary chart elements can distract readers from understanding the data.</p>
<p>We can remove the grid lines by setting the <code>panel.grid.major.y</code> and <code>panel.grid.minor.y</code> arguments to the <code>theme()</code> function. The value we want to use is the helper function <code>element_blank()</code>, which sets the grid lines to be blank.</p>
<div class="cell" data-exercise="true" data-exercise.lines="17">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>violence <span class="sc">|&gt;</span> </span>
<span id="cb15-2"><a href="#cb15-2"></a>  <span class="fu">filter</span>(crime_type <span class="sc">==</span> <span class="st">"murder"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb15-3"><a href="#cb15-3"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> count, <span class="at">y =</span> state)) <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb15-6"><a href="#cb15-6"></a>  <span class="fu">labs</span>(</span>
<span id="cb15-7"><a href="#cb15-7"></a>    <span class="at">title =</span> <span class="st">"Murders in Malaysian states, 2017"</span>,</span>
<span id="cb15-8"><a href="#cb15-8"></a>    <span class="at">caption =</span> <span class="st">"Data from the Royal Malaysian Police"</span>,</span>
<span id="cb15-9"><a href="#cb15-9"></a>    <span class="at">x =</span> <span class="st">"number of murders"</span>,</span>
<span id="cb15-10"><a href="#cb15-10"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb15-11"><a href="#cb15-11"></a>  ) <span class="sc">+</span></span>
<span id="cb15-12"><a href="#cb15-12"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb15-13"><a href="#cb15-13"></a>  <span class="fu">theme</span>(</span>
<span id="cb15-14"><a href="#cb15-14"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb15-15"><a href="#cb15-15"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb15-16"><a href="#cb15-16"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/bars-exercise3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="ordering-bar-charts-by-value" class="level3" data-number="15.3.1"><h3 data-number="15.3.1" class="anchored" data-anchor-id="ordering-bar-charts-by-value">
<span class="header-section-number">15.3.1</span> Ordering bar charts by value</h3>
<p>If you were trying to find the three Malaysian states or territories with the most murders from this chart, it would be pretty easy to see that Selangor had the most murders, followed by Johor. But at a glance, it’s not so easy to see which state or territory comes third. We can make this easier to see by changing the order of the bars from the default alphabetical order to an order based on how many murders there were.</p>
<p>To do this, we need to convert the <code>state</code> column in the data to a new type of variable: a <em>factor</em>. Factors are what R calls categorical variables that have a defined set of possible values. For example, a factor recording if a person was under or over 18 might have two possible values: <code>adult</code> and <code>child</code>.</p>
<p>One of the benefits of storing a variable as a factor is that we can specify an order for the categories. This is useful for categories that have a meaningful order, such as <code>bad</code>, <code>acceptable</code>, <code>good</code>, <code>excellent</code>. But we can also use this feature of factors to specify that values should appear in a particular order in any charts produced from the data, whatever the order of the values in the data itself.</p>
<p><a href="https://forcats.tidyverse.org/"><img src="images/forcats.png" alt="forcats package hex sticker" class="right-side-image"></a></p>
<p>To work with factors in R we can use the <a href="https://forcats.tidyverse.org/"><code>forcats</code> package</a>, so-called because it’s <em>for</em> working with <em>categories</em>. <code>forcats</code> is loaded as part of <code>tidyverse</code>, so we don’t need to load it separately.</p>
<p>All the functions in the <code>forcats</code> package start with the letters <code>fct_</code>, just as all the functions in the SF package start <code>st_</code>. For our bar chart, we will use the <code>fct_reorder()</code> function. This takes a factor or character variable (such as the names of the Malaysian states and territories) and sets the order of the categories according to the values of a numeric variable (such as the number of murders in a state). So to re-order the <code>state</code> variable according to the count of murders, we can use <code>fct_reorder(state, count)</code>. Since we’re changing an existing variable, we will do this inside a call to the <code>mutate()</code> function.</p>
<div class="cell" data-exercise="true" data-exercise.lines="18">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>violence <span class="sc">|&gt;</span> </span>
<span id="cb16-2"><a href="#cb16-2"></a>  <span class="fu">filter</span>(crime_type <span class="sc">==</span> <span class="st">"murder"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb16-3"><a href="#cb16-3"></a>  <span class="fu">mutate</span>(<span class="at">state =</span> <span class="fu">fct_reorder</span>(state, count)) <span class="sc">|&gt;</span> </span>
<span id="cb16-4"><a href="#cb16-4"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> count, <span class="at">y =</span> state)) <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7"></a>  <span class="fu">labs</span>(</span>
<span id="cb16-8"><a href="#cb16-8"></a>    <span class="at">title =</span> <span class="st">"Murders in Malaysian states, 2017"</span>,</span>
<span id="cb16-9"><a href="#cb16-9"></a>    <span class="at">caption =</span> <span class="st">"Data from the Royal Malaysian Police"</span>,</span>
<span id="cb16-10"><a href="#cb16-10"></a>    <span class="at">x =</span> <span class="st">"number of murders"</span>,</span>
<span id="cb16-11"><a href="#cb16-11"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb16-12"><a href="#cb16-12"></a>  ) <span class="sc">+</span></span>
<span id="cb16-13"><a href="#cb16-13"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb16-14"><a href="#cb16-14"></a>  <span class="fu">theme</span>(</span>
<span id="cb16-15"><a href="#cb16-15"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb16-16"><a href="#cb16-16"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb16-17"><a href="#cb16-17"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/bars-exercise4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Finally, we can use colour to indicate which states are in which of the two regions of Malaysia. To do this, we will:</p>
<ul>
<li>specify in the call to <code>aes()</code> that the fill colour of the bars should be controlled by the <code>region</code> column in the data,</li>
<li>specify in the call to <code>labs()</code> that we don’t want the legend to have a title, since the meaning is obvious from the values ‘East Malaysia’ and ‘West Malaysia’, and</li>
<li>specify in the call to <code>theme()</code> that we would like the legend use up some of the empty space in the bottom-right corner of the chart, rather than making the chart smaller to give space for the legend on the right-hand side.</li>
</ul>
<p>To move the legend, we need to specify three different arguments in the <code>theme()</code> function. <code>legend.position</code> determines where in the plot the legend should be placed, based on how far along each axis (as a proportion of the axis length, on a scale from zero to one) the legend should be placed.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="fu">tibble</span>(</span>
<span id="cb17-2"><a href="#cb17-2"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), </span>
<span id="cb17-3"><a href="#cb17-3"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>)</span>
<span id="cb17-4"><a href="#cb17-4"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb17-5"><a href="#cb17-5"></a>  <span class="fu">mutate</span>(</span>
<span id="cb17-6"><a href="#cb17-6"></a>    <span class="at">label =</span> <span class="fu">str_glue</span>(<span class="st">"{number(x, accuracy = 0.1)}, {number(y, accuracy = 0.1)}"</span>)</span>
<span id="cb17-7"><a href="#cb17-7"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb17-8"><a href="#cb17-8"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb17-9"><a href="#cb17-9"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10"></a>  <span class="fu">geom_label</span>() <span class="sc">+</span></span>
<span id="cb17-11"><a href="#cb17-11"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb17-12"><a href="#cb17-12"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="fl">0.1</span>), </span>
<span id="cb17-13"><a href="#cb17-13"></a>    <span class="at">position =</span> <span class="st">"top"</span>, </span>
<span id="cb17-14"><a href="#cb17-14"></a>    <span class="at">sec.axis =</span> <span class="fu">dup_axis</span>(<span class="at">name =</span> <span class="cn">NULL</span>)</span>
<span id="cb17-15"><a href="#cb17-15"></a>  ) <span class="sc">+</span></span>
<span id="cb17-16"><a href="#cb17-16"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb17-17"><a href="#cb17-17"></a>    <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="fl">0.1</span>), </span>
<span id="cb17-18"><a href="#cb17-18"></a>    <span class="at">sec.axis =</span> <span class="fu">dup_axis</span>(<span class="at">name =</span> <span class="cn">NULL</span>)</span>
<span id="cb17-19"><a href="#cb17-19"></a>  ) <span class="sc">+</span></span>
<span id="cb17-20"><a href="#cb17-20"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb17-21"><a href="#cb17-21"></a>  <span class="fu">labs</span>(</span>
<span id="cb17-22"><a href="#cb17-22"></a>    <span class="at">x =</span> <span class="st">"the first number gives the value on horizontal (x) axis"</span>,</span>
<span id="cb17-23"><a href="#cb17-23"></a>    <span class="at">y =</span> <span class="st">"the second number gives the value on vertical (y) axis"</span></span>
<span id="cb17-24"><a href="#cb17-24"></a>  ) <span class="sc">+</span></span>
<span id="cb17-25"><a href="#cb17-25"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/legend-position-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Using this specification, we can place the legend in the right-most point on the horizontal axis and the bottom-most point on the vertical axis by specifying <code>legend.position = c(1, 0)</code>.</p>
<p><code>legend.position</code> sets the <em>anchor</em> point from which the legend is created, with the actual size of the legend depending on how much space is required by its contents. By default, a legend will spread out in all directions from the anchor point, i.e.&nbsp;the legend will be horizontally and vertically centred on the anchor point. As we have positioned the legend in a corner of the plot, this is probably not what we want since some of the legend will be hidden outside the plot area. Instead, we can set the <code>legend.justifcation</code> argument of <code>theme()</code> using a similar specification to that for <code>legend.position</code> based on which way we want the legend to grow.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">tibble</span>(</span>
<span id="cb18-2"><a href="#cb18-2"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="fl">1.1</span>, <span class="fl">1.1</span>, <span class="fl">0.9</span>, <span class="fl">0.9</span>, <span class="fl">1.1</span>, <span class="fl">0.9</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb18-3"><a href="#cb18-3"></a>  <span class="at">xend =</span> <span class="fu">c</span>(<span class="fl">1.25</span>, <span class="fl">1.25</span>, <span class="fl">0.75</span>, <span class="fl">0.75</span>, <span class="fl">1.25</span>, <span class="fl">0.75</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb18-4"><a href="#cb18-4"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="fl">1.1</span>, <span class="fl">0.9</span>, <span class="fl">1.1</span>, <span class="fl">0.9</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.9</span>, <span class="fl">1.1</span>),</span>
<span id="cb18-5"><a href="#cb18-5"></a>  <span class="at">yend =</span> <span class="fu">c</span>(<span class="fl">1.25</span>, <span class="fl">0.75</span>, <span class="fl">1.25</span>, <span class="fl">0.75</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.75</span>, <span class="fl">1.25</span>),</span>
<span id="cb18-6"><a href="#cb18-6"></a>  <span class="at">h =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>),</span>
<span id="cb18-7"><a href="#cb18-7"></a>  <span class="at">v =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb18-8"><a href="#cb18-8"></a>)  <span class="sc">|&gt;</span>  </span>
<span id="cb18-9"><a href="#cb18-9"></a>  <span class="fu">mutate</span>(</span>
<span id="cb18-10"><a href="#cb18-10"></a>    <span class="at">label =</span> <span class="fu">str_glue</span>(<span class="st">"{number(h, accuracy = 0.1)}, {number(v, accuracy = 0.1)}"</span>)</span>
<span id="cb18-11"><a href="#cb18-11"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb18-12"><a href="#cb18-12"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb18-13"><a href="#cb18-13"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb18-14"><a href="#cb18-14"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend), </span>
<span id="cb18-15"><a href="#cb18-15"></a>    <span class="at">linewidth =</span> <span class="dv">1</span>, </span>
<span id="cb18-16"><a href="#cb18-16"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">3</span>, <span class="st">"mm"</span>), <span class="at">type =</span> <span class="st">"closed"</span>)</span>
<span id="cb18-17"><a href="#cb18-17"></a>  ) <span class="sc">+</span></span>
<span id="cb18-18"><a href="#cb18-18"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> xend, <span class="at">y =</span> yend, <span class="at">hjust =</span> h, <span class="at">vjust =</span> v, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb18-19"><a href="#cb18-19"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb18-20"><a href="#cb18-20"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb18-21"><a href="#cb18-21"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb18-22"><a href="#cb18-22"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb18-23"><a href="#cb18-23"></a>  <span class="fu">theme_void</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/legend-justification-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>If you want the legend to grow ‘inwards’ from a corner, just set <code>legend.justification</code> to the same value as you used for <code>legend.position</code>. In this case, we want the legend to be anchored in the bottom-right corner and to grow inwards from it, so we will set both arguments to <code>c(1, 0)</code>.</p>
<div class="cell" data-exercise="true" data-exercise.lines="21">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>violence <span class="sc">|&gt;</span> </span>
<span id="cb19-2"><a href="#cb19-2"></a>  <span class="fu">filter</span>(crime_type <span class="sc">==</span> <span class="st">"murder"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb19-3"><a href="#cb19-3"></a>  <span class="fu">mutate</span>(<span class="at">state =</span> <span class="fu">fct_reorder</span>(state, count)) <span class="sc">|&gt;</span> </span>
<span id="cb19-4"><a href="#cb19-4"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x =</span> count, <span class="at">y =</span> state, <span class="at">fill =</span> region)) <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb19-7"><a href="#cb19-7"></a>  <span class="fu">labs</span>(</span>
<span id="cb19-8"><a href="#cb19-8"></a>    <span class="at">title =</span> <span class="st">"Murders in Malaysian states, 2017"</span>,</span>
<span id="cb19-9"><a href="#cb19-9"></a>    <span class="at">caption =</span> <span class="st">"Data from the Royal Malaysian Police"</span>,</span>
<span id="cb19-10"><a href="#cb19-10"></a>    <span class="at">x =</span> <span class="st">"number of murders"</span>,</span>
<span id="cb19-11"><a href="#cb19-11"></a>    <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb19-12"><a href="#cb19-12"></a>    <span class="at">fill =</span> <span class="cn">NULL</span></span>
<span id="cb19-13"><a href="#cb19-13"></a>  ) <span class="sc">+</span></span>
<span id="cb19-14"><a href="#cb19-14"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb19-15"><a href="#cb19-15"></a>  <span class="fu">theme</span>(</span>
<span id="cb19-16"><a href="#cb19-16"></a>    <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="cn">NA</span>, <span class="at">fill =</span> <span class="st">"white"</span>),</span>
<span id="cb19-17"><a href="#cb19-17"></a>    <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb19-18"><a href="#cb19-18"></a>    <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb19-19"><a href="#cb19-19"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb19-20"><a href="#cb19-20"></a>    <span class="at">panel.grid.minor.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb19-21"><a href="#cb19-21"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: A numeric `legend.position` argument in `theme()` was deprecated in ggplot2
3.5.0.
ℹ Please use the `legend.position.inside` argument of `theme()` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/bars-exercise5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Bar charts are a very common way of presenting a numeric variable for each value of a categorical variable. Bar charts are easy to interpret, even for people who are not used to interpreting charts or who only have time to look at the chart for a few seconds.</p>
<div class="box notewell">
<p>One of the reasons why bar charts are easy to interpret is that the <em>length</em> of each bar directly corresponds to the relative size of that particular value. But this direct relationship between bar length and value only applies if the bars start at zero. If you create a bar chart in which the bars don’t start at zero, readers are likely to be mislead, so remember <em>bar charts should always start at zero</em>. But don’t worry – <code>ggplot()</code> will handle this for you automatically.</p>
</div>
</section></section><section id="showing-a-distribution" class="level2" data-number="15.4"><h2 data-number="15.4" class="anchored" data-anchor-id="showing-a-distribution">
<span class="header-section-number">15.4</span> Showing a distribution</h2>
<p>Bar charts show a single piece of information about each category present in a dataset. So we might use a bar chart to show, for example, the average number of burglaries in neighbourhoods in different districts. But what if the average values masked substantial differences in the number of burglaries within each district? Averages often mask variation, and can sometimes be misleading as a result. In those circumstances it would be better to show more detail rather than a misleading average.</p>
<p>Let’s start with the simple example of showing the distribution of burglary counts within a single district. The <code>burglary</code> object contains counts of burglaries in each lower-layer super output area (LSOA) in Northamptonshire in England in 2020. To show the distribution of burglary counts within one district (Kettering), we can create a <em>histogram</em> using <code>geom_histogram()</code>.</p>
<p>A histogram divides the range of values present in the data into a number of equally sized <em>bins</em>, then shows bars representing the number of observations (rows) in the data that have values fitting into each bin. We can either allow <code>geom_histogram()</code> to set the number of bins automatically, or set it ourself with the <code>binwidth</code> argument.</p>
<p>We will set the <code>binwidth</code> argument of the <code>geom_histogram()</code> function to <code>binwidth = 1</code> so that each bar on the chart will show now many LSOAs have each individual value. We will also add some labels to help readers interpret the chart.</p>
<div class="cell" data-exercise="true">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>burglary <span class="sc">|&gt;</span> </span>
<span id="cb21-2"><a href="#cb21-2"></a>  <span class="fu">filter</span>(district <span class="sc">==</span> <span class="st">"Kettering"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb21-3"><a href="#cb21-3"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> count), <span class="at">binwidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7"></a>  <span class="fu">labs</span>(</span>
<span id="cb21-8"><a href="#cb21-8"></a>    <span class="at">title =</span> <span class="st">"Number of burglaries in Kettering neighbourhoods"</span>,</span>
<span id="cb21-9"><a href="#cb21-9"></a>    <span class="at">x =</span> <span class="st">"count of burglaries, 2020"</span>,</span>
<span id="cb21-10"><a href="#cb21-10"></a>    <span class="at">y =</span> <span class="st">"number of LSOAs"</span></span>
<span id="cb21-11"><a href="#cb21-11"></a>  ) <span class="sc">+</span></span>
<span id="cb21-12"><a href="#cb21-12"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb21-13"><a href="#cb21-13"></a>  <span class="fu">theme</span>(</span>
<span id="cb21-14"><a href="#cb21-14"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb21-15"><a href="#cb21-15"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb21-16"><a href="#cb21-16"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/dist-exercise1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can see on this chart that most LSOAs had only a few burglaries in 2020 (i.e. the largest bars are to the left of the chart), while a few LSOAs had a larger number (the bars to the right of the chart). This is what we would expect, since we know the crimes are generally concentrated in a few places.</p>
<section id="plotting-density-curves" class="level3" data-number="15.4.1"><h3 data-number="15.4.1" class="anchored" data-anchor-id="plotting-density-curves">
<span class="header-section-number">15.4.1</span> Plotting density curves</h3>
<p>Dot plots can be effective at showing the distribution of a variable, but are only really useful for a <em>single</em> group since they become cluttered if you try to show several types of dot (e.g.&nbsp;of different colours). One way to show the general distribution of a variable is to summarise the locations of the points on the horizontal axis by adding a <em>density curve</em> with <code>geom_density()</code>. A density curve is a <em>smoothed</em> version of a histogram, which is useful to show the general distribution of a variable (in this case, the number of LSOAs with different numbers of burglaries) at the cost of not showing the exact data. The mathematical procedure used by <code>geom_density()</code> to calculate a density curve is the same as the kernel-density estimation process we have already learned to use to show concentrations of crime on a map.</p>
<div class="cell" data-exercise="true">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>burglary <span class="sc">|&gt;</span> </span>
<span id="cb22-2"><a href="#cb22-2"></a>  <span class="fu">filter</span>(district <span class="sc">==</span> <span class="st">"Kettering"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb22-3"><a href="#cb22-3"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x =</span> count), <span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_percent</span>()) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7"></a>  <span class="fu">labs</span>(</span>
<span id="cb22-8"><a href="#cb22-8"></a>    <span class="at">title =</span> <span class="st">"Number of burglaries in Kettering neighbourhoods"</span>,</span>
<span id="cb22-9"><a href="#cb22-9"></a>    <span class="at">x =</span> <span class="st">"count of burglaries, 2020"</span>,</span>
<span id="cb22-10"><a href="#cb22-10"></a>    <span class="at">y =</span> <span class="st">"percentage of LSOAs"</span></span>
<span id="cb22-11"><a href="#cb22-11"></a>  ) <span class="sc">+</span></span>
<span id="cb22-12"><a href="#cb22-12"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb22-13"><a href="#cb22-13"></a>  <span class="fu">theme</span>(</span>
<span id="cb22-14"><a href="#cb22-14"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb22-15"><a href="#cb22-15"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>()</span>
<span id="cb22-16"><a href="#cb22-16"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/dist-exercise2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can use density curves to show the distribution of a variable across multiple categories at once. For example, we could show the distribution of burglary counts at the neighbourhood level for all the districts in Northamptonshire. To do this we use the <code>geom_density_ridges()</code> function from the <code>ggridges</code> package to create a <em>ridge plot</em>. Although this function does not come from the <code>ggplot2</code> package, it is designed to be used inside a <code>ggplot()</code> stack.</p>
<div class="cell" data-exercise="true">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb23-2"><a href="#cb23-2"></a></span>
<span id="cb23-3"><a href="#cb23-3"></a>burglary <span class="sc">|&gt;</span> </span>
<span id="cb23-4"><a href="#cb23-4"></a>  <span class="co"># Wrap the district names by replacing any space in a name with a new-line</span></span>
<span id="cb23-5"><a href="#cb23-5"></a>  <span class="fu">mutate</span>(<span class="at">district =</span> <span class="fu">str_replace_all</span>(district, <span class="st">"</span><span class="sc">\\</span><span class="st">s"</span>, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb23-6"><a href="#cb23-6"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> count, <span class="at">y =</span> district)) <span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7"></a>  <span class="fu">geom_density_ridges</span>() <span class="sc">+</span></span>
<span id="cb23-8"><a href="#cb23-8"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb23-9"><a href="#cb23-9"></a>  <span class="fu">labs</span>(</span>
<span id="cb23-10"><a href="#cb23-10"></a>    <span class="at">title =</span> <span class="st">"Number of burglaries in Kettering neighbourhoods"</span>,</span>
<span id="cb23-11"><a href="#cb23-11"></a>    <span class="at">x =</span> <span class="st">"count of burglaries, 2020"</span>,</span>
<span id="cb23-12"><a href="#cb23-12"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb23-13"><a href="#cb23-13"></a>  ) <span class="sc">+</span></span>
<span id="cb23-14"><a href="#cb23-14"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 1.98</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/dist-exercise3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The ridge plot shows the distribution of burglary counts in LSOAs within each district, with the distributions overlapping slightly to save space. From this we can see that across all districts most LSOAs have few burglaries, with a small number of LSOAs having more. We can also see there are a small number of LSOAs (probably, in fact, just one LSOA) in Wellingborough district with a much higher number of burglaries than anywhere else in Northamptonshire.</p>
</section><section id="small-multiple-charts" class="level3" data-number="15.4.2"><h3 data-number="15.4.2" class="anchored" data-anchor-id="small-multiple-charts">
<span class="header-section-number">15.4.2</span> Small-multiple charts</h3>
<p>Density plots can be helpful to summarise a lot of information, but they have some disadvantages. In particular, they don’t show that the number of LSOAs in each district is quite different: there are 131 LSOAs in Northampton but only 41 LSOAs in Corby. To make this clearer we can instead produce several dot plots, one for each district – what are called <em>small-multiple</em> charts.</p>
<p>We could create small-multiple charts by producing a separate histogram for each district and then combine them with the <code>patchwork</code> package, but that would involve a lot of repeated code. Fortunately, we can use a feature of the <code>ggplot2</code> package called <em>faceting</em> to split our single dot plot into multiple plots based on a column in the data (in this case, the district name).</p>
<p>Adding <code>facet_wrap()</code> to our <code>ggplot()</code> stack will cause R to create multiple plots and wrap them across multiple rows and columns so that they approximately fit into the available space. If we only want the small multiples to appear on top of each other (i.e.&nbsp;in multiple rows) or next to each other (i.e.&nbsp;in multiple columns), we can use the <code>facet_grid()</code> function. In this case we want the small multiples to appear on top of each other, so we will use <code>facet_grid()</code> and say that the small multiples (which <code>ggplot2</code> calls <em>facets</em>) should be based on the <code>district</code> column in the data by specifying <code>rows = vars(district)</code> (it is necessary to wrap the name of the column that you want to use as the basis of the small multiples in the <code>vars()</code> function, but we do not need to go into why).</p>
<div class="cell" data-exercise="true" data-exercise.lines="18">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>burglary <span class="sc">|&gt;</span> </span>
<span id="cb25-2"><a href="#cb25-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> count, <span class="at">fill =</span> district)) <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">colour =</span> <span class="st">"grey80"</span>) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(district), <span class="at">labeller =</span> <span class="fu">label_wrap_gen</span>(<span class="at">width =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6"></a>  <span class="fu">labs</span>(</span>
<span id="cb25-7"><a href="#cb25-7"></a>    <span class="at">title =</span> <span class="st">"Number of burglaries in Northamptonshire neighbourhoods"</span>,</span>
<span id="cb25-8"><a href="#cb25-8"></a>    <span class="at">x =</span> <span class="st">"count of burglaries, 2020"</span>,</span>
<span id="cb25-9"><a href="#cb25-9"></a>    <span class="at">y =</span> <span class="st">"number of LSOAs"</span></span>
<span id="cb25-10"><a href="#cb25-10"></a>  ) <span class="sc">+</span></span>
<span id="cb25-11"><a href="#cb25-11"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb25-12"><a href="#cb25-12"></a>  <span class="fu">theme</span>(</span>
<span id="cb25-13"><a href="#cb25-13"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span>,</span>
<span id="cb25-14"><a href="#cb25-14"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb25-15"><a href="#cb25-15"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb25-16"><a href="#cb25-16"></a>    <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">0</span>)</span>
<span id="cb25-17"><a href="#cb25-17"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/dist-exercise5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>You might have noticed we made some other changes to our code for this chart to make it clearer:</p>
<ul>
<li>Set the dot <code>fill</code> to be based on the <code>district</code> column in the data, so the bars in each small multiple will be a different colour. We then remove the legend that is automatically generated by adding the <code>fill</code> aesthetic using the <code>legend.position = "none"</code> attribute to <code>theme()</code>, since the legend is redundant (the same information is shown in the facet labels).</li>
<li>Removed the values and the title on the <em>y</em> axis, since it is clear from the rest of the chart that the vertical axis shows the count of dots in each stack.</li>
<li>Added a horizontal line at zero on the <em>y</em> axis using <code>geom_hline()</code> to make it easier to compare the height of each stack of dots to zero.</li>
<li>Wrapped the facet labels using the <code>label_wrap_gen()</code> helper function so that some of the longer district names don’t take up too much space horizontally.</li>
<li>Made the facet labels easier to read by making the text horizontal (rather than the default vertical text) using the <code>strip.text.y</code> attribute to <code>theme()</code> and the <code>element_text()</code> helper function. <code>angle</code> sets the rotation of the text (or in this case, specifies that there should be no rotation) and <code>hjust = 0</code> specifies that the text should be left aligned.</li>
</ul>
<div class="tutorial">
<p>If you want to play around with each of these parts of the code to understand what they do in more detail, remove one part at a time and re-run the code to see how the appearance of the plot changes.</p>
</div>
<p>There are many more-technical ways to show distributions, such as box plots or violin plots. However, these can be difficult to interpret for people who are not used to looking at those particular types of chart, so they should probably be avoided for communicating with general audiences.</p>
</section></section><section id="comparing-continuous-variables" class="level2" data-number="15.5"><h2 data-number="15.5" class="anchored" data-anchor-id="comparing-continuous-variables">
<span class="header-section-number">15.5</span> Comparing continuous variables</h2>
<p>So far we have used bar charts to communicate a single number (in our example, a number of murders) for each value of a categorical variable (the name of each Malaysian state or territory), and histograms to show multiple numbers (burglary counts for each neighbourhood) for each value of a categorical variable (districts in Northamptonshire).</p>
<p>Both these types of chart compare a numeric variable to a categorical one. But sometimes we may want to compare two categorical variables. We can do this with a <em>scatter plot</em>. For example, the object <code>vehicle_theft</code> contains rates of thefts of and from motor vehicles per 1,000 households saying they own a vehicle for a selection of 189 municipalities in South Africa. Since thefts <em>of</em> vehicle and thefts <em>from</em> vehicles are different but related crimes, we might want to see if there is a relationship between counts of each type.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>vehicle_theft <span class="sc">|&gt;</span> </span>
<span id="cb26-2"><a href="#cb26-2"></a>  <span class="fu">head</span>() <span class="sc">|&gt;</span> </span>
<span id="cb26-3"><a href="#cb26-3"></a>  <span class="fu">gt</span>() <span class="sc">|&gt;</span> </span>
<span id="cb26-4"><a href="#cb26-4"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb26-5"><a href="#cb26-5"></a>    <span class="at">title =</span> <span class="st">"Vehicle thefts in South African municipalities"</span>,</span>
<span id="cb26-6"><a href="#cb26-6"></a>    <span class="at">subtitle =</span> <span class="st">"a sample of the data"</span></span>
<span id="cb26-7"><a href="#cb26-7"></a>  )  <span class="sc">|&gt;</span>  </span>
<span id="cb26-8"><a href="#cb26-8"></a>  <span class="fu">tab_options</span>(</span>
<span id="cb26-9"><a href="#cb26-9"></a>    <span class="at">heading.align =</span> <span class="st">"left"</span></span>
<span id="cb26-10"><a href="#cb26-10"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<div id="mkrsybzlhi" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mkrsybzlhi table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mkrsybzlhi thead, #mkrsybzlhi tbody, #mkrsybzlhi tfoot, #mkrsybzlhi tr, #mkrsybzlhi td, #mkrsybzlhi th {
  border-style: none;
}

#mkrsybzlhi p {
  margin: 0;
  padding: 0;
}

#mkrsybzlhi .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mkrsybzlhi .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mkrsybzlhi .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mkrsybzlhi .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mkrsybzlhi .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mkrsybzlhi .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mkrsybzlhi .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mkrsybzlhi .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mkrsybzlhi .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mkrsybzlhi .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mkrsybzlhi .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mkrsybzlhi .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mkrsybzlhi .gt_spanner_row {
  border-bottom-style: hidden;
}

#mkrsybzlhi .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mkrsybzlhi .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mkrsybzlhi .gt_from_md > :first-child {
  margin-top: 0;
}

#mkrsybzlhi .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mkrsybzlhi .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mkrsybzlhi .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mkrsybzlhi .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mkrsybzlhi .gt_row_group_first td {
  border-top-width: 2px;
}

#mkrsybzlhi .gt_row_group_first th {
  border-top-width: 2px;
}

#mkrsybzlhi .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mkrsybzlhi .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mkrsybzlhi .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mkrsybzlhi .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mkrsybzlhi .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mkrsybzlhi .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mkrsybzlhi .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mkrsybzlhi .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mkrsybzlhi .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mkrsybzlhi .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mkrsybzlhi .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mkrsybzlhi .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mkrsybzlhi .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mkrsybzlhi .gt_left {
  text-align: left;
}

#mkrsybzlhi .gt_center {
  text-align: center;
}

#mkrsybzlhi .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mkrsybzlhi .gt_font_normal {
  font-weight: normal;
}

#mkrsybzlhi .gt_font_bold {
  font-weight: bold;
}

#mkrsybzlhi .gt_font_italic {
  font-style: italic;
}

#mkrsybzlhi .gt_super {
  font-size: 65%;
}

#mkrsybzlhi .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mkrsybzlhi .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mkrsybzlhi .gt_indent_1 {
  text-indent: 5px;
}

#mkrsybzlhi .gt_indent_2 {
  text-indent: 10px;
}

#mkrsybzlhi .gt_indent_3 {
  text-indent: 15px;
}

#mkrsybzlhi .gt_indent_4 {
  text-indent: 20px;
}

#mkrsybzlhi .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="4" class="gt_heading gt_title gt_font_normal">Vehicle thefts in South African municipalities</th>
</tr>
<tr class="odd gt_heading">
<th colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">a sample of the data</th>
</tr>
<tr class="header gt_col_headings">
<th id="province" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">province</th>
<th id="municipality" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">municipality</th>
<th id="crime_category" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">crime_category</th>
<th id="theft_rate" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">theft_rate</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="province">Eastern Cape</td>
<td class="gt_row gt_left" headers="municipality">Amahlathi</td>
<td class="gt_row gt_left" headers="crime_category">Theft of motor vehicle</td>
<td class="gt_row gt_right" headers="theft_rate">2.492026</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="province">Eastern Cape</td>
<td class="gt_row gt_left" headers="municipality">Amahlathi</td>
<td class="gt_row gt_left" headers="crime_category">Theft out of or from motor vehicle</td>
<td class="gt_row gt_right" headers="theft_rate">26.415470</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="province">Eastern Cape</td>
<td class="gt_row gt_left" headers="municipality">Blue Crane Route</td>
<td class="gt_row gt_left" headers="crime_category">Theft of motor vehicle</td>
<td class="gt_row gt_right" headers="theft_rate">6.054396</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="province">Eastern Cape</td>
<td class="gt_row gt_left" headers="municipality">Blue Crane Route</td>
<td class="gt_row gt_left" headers="crime_category">Theft out of or from motor vehicle</td>
<td class="gt_row gt_right" headers="theft_rate">19.094635</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="province">Eastern Cape</td>
<td class="gt_row gt_left" headers="municipality">Buffalo City</td>
<td class="gt_row gt_left" headers="crime_category">Theft of motor vehicle</td>
<td class="gt_row gt_right" headers="theft_rate">7.584509</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="province">Eastern Cape</td>
<td class="gt_row gt_left" headers="municipality">Buffalo City</td>
<td class="gt_row gt_left" headers="crime_category">Theft out of or from motor vehicle</td>
<td class="gt_row gt_right" headers="theft_rate">49.028434</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<p>To create a <code>ggplot()</code> scatter plot we use <code>geom_point()</code>, the same function we previously used to create point maps. This makes sense, since point maps are a specialised type of scatter plot in which the <em>x</em> and <em>y</em> axes of the chart show the latitude and longitude or easting and northing of each crime location.</p>
<p>The data in the <code>vehicle_theft</code> object are in long format, with each row representing a count of crime in a particular category for a particular municipality. To make a scatter plot where each point represents a municipality, we need to have all the data for a municipality in a single row of data, so we will need to transform the data with <code>pivot_wider()</code> (as we did for some of the tables at the start of this tutorial). Since this will turn the crime categories into column names, we will first change the column names to clean names (i.e.&nbsp; containing only lower-case letters, numbers and underscores) using <code>recode()</code> to make the column names easier to work with.</p>
<div class="cell" data-exercise="true">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>vehicle_theft_wider <span class="ot">&lt;-</span> vehicle_theft <span class="sc">|&gt;</span> </span>
<span id="cb27-2"><a href="#cb27-2"></a>  <span class="fu">mutate</span>(</span>
<span id="cb27-3"><a href="#cb27-3"></a>    <span class="at">crime_category =</span> <span class="fu">recode</span>(</span>
<span id="cb27-4"><a href="#cb27-4"></a>      crime_category,</span>
<span id="cb27-5"><a href="#cb27-5"></a>      <span class="st">"Theft of motor vehicle"</span> <span class="ot">=</span> <span class="st">"theft_of"</span>,</span>
<span id="cb27-6"><a href="#cb27-6"></a>      <span class="st">"Theft out of or from motor vehicle"</span> <span class="ot">=</span> <span class="st">"theft_from"</span></span>
<span id="cb27-7"><a href="#cb27-7"></a>    )</span>
<span id="cb27-8"><a href="#cb27-8"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb27-9"><a href="#cb27-9"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> crime_category, <span class="at">values_from =</span> theft_rate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can now make a basic scatter plot.</p>
<div class="cell" data-exercise="true">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="fu">ggplot</span>(vehicle_theft_wider, <span class="fu">aes</span>(<span class="at">x =</span> theft_of, <span class="at">y =</span> theft_from)) <span class="sc">+</span></span>
<span id="cb28-2"><a href="#cb28-2"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">comma_format</span>()) <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">comma_format</span>()) <span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5"></a>  <span class="fu">labs</span>(</span>
<span id="cb28-6"><a href="#cb28-6"></a>    <span class="at">title =</span> <span class="st">"Vehicle thefts in South African municipalities"</span>,</span>
<span id="cb28-7"><a href="#cb28-7"></a>    <span class="at">subtitle =</span> <span class="st">"each dot represents one municipality, 2018-19"</span>,</span>
<span id="cb28-8"><a href="#cb28-8"></a>    <span class="at">x =</span> <span class="st">"rate of thefts of motor vehicles per 1,000 vehicle-owning households"</span>,</span>
<span id="cb28-9"><a href="#cb28-9"></a>    <span class="at">y =</span> <span class="st">"rate of thefts from motor vehicles per 1,000 vehicle-owning households"</span></span>
<span id="cb28-10"><a href="#cb28-10"></a>  ) <span class="sc">+</span></span>
<span id="cb28-11"><a href="#cb28-11"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/scatter-exercise2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From this plot we can see that most areas have low rates of both theft of and theft from motor vehicles, with a few areas having very-high rates of one type or the other (but none have high rates of both).</p>
<p>Looking at the bottom-left corner of the chart we can see that we have again encountered the problem of overlapping points making patterns less clear. We can try to deal with this by making the points semi-transparent using the <code>alpha</code> argument to <code>geom_point()</code>.</p>
<p>Scatter plots can be hard for people to interpret, especially if they are not used to interpreting charts. To help readers, we can annotate the plot to show how to interpret each region of the chart. We will add two types of annotation: lines to show the median value on each axis, and labels to help interpretation.</p>
<p>We can add median lines using the <code>geom_hline()</code> and <code>geom_vline()</code> functions, which add horizontal and vertical lines to plots. We will add these to the <code>ggplot()</code> stack <em>before</em> <code>geom_point()</code> so that the lines appear <em>behind</em> the points.</p>
<p>To add text annotations we use the <code>annotate()</code> function from <code>ggplot2</code>, which allows us to add data to a chart by specifying the aesthetics (<em>x</em> and <em>y</em> position, etc.) directly rather than by referencing columns in the data. To add a text annotation, we set the <code>geom</code> argument of <code>annotate()</code> to <code>"text"</code>.</p>
<div class="cell" data-exercise="true" data-exercise.lines="40">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">ggplot</span>(vehicle_theft_wider, <span class="fu">aes</span>(<span class="at">x =</span> theft_of, <span class="at">y =</span> theft_from)) <span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb29-3"><a href="#cb29-3"></a>    <span class="at">xintercept =</span> <span class="fu">median</span>(<span class="fu">pull</span>(vehicle_theft_wider, <span class="st">"theft_of"</span>)),</span>
<span id="cb29-4"><a href="#cb29-4"></a>    <span class="at">linetype =</span> <span class="st">"22"</span></span>
<span id="cb29-5"><a href="#cb29-5"></a>  ) <span class="sc">+</span></span>
<span id="cb29-6"><a href="#cb29-6"></a>  <span class="fu">geom_hline</span>(</span>
<span id="cb29-7"><a href="#cb29-7"></a>    <span class="at">yintercept =</span> <span class="fu">median</span>(<span class="fu">pull</span>(vehicle_theft_wider, <span class="st">"theft_from"</span>)),</span>
<span id="cb29-8"><a href="#cb29-8"></a>    <span class="at">linetype =</span> <span class="st">"22"</span></span>
<span id="cb29-9"><a href="#cb29-9"></a>  ) <span class="sc">+</span></span>
<span id="cb29-10"><a href="#cb29-10"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb29-11"><a href="#cb29-11"></a>  <span class="fu">annotate</span>(</span>
<span id="cb29-12"><a href="#cb29-12"></a>    <span class="at">geom =</span> <span class="st">"text"</span>, </span>
<span id="cb29-13"><a href="#cb29-13"></a>    <span class="at">x =</span> <span class="dv">20</span>, </span>
<span id="cb29-14"><a href="#cb29-14"></a>    <span class="at">y =</span> <span class="dv">0</span>, </span>
<span id="cb29-15"><a href="#cb29-15"></a>    <span class="at">label =</span> <span class="st">"high rate of thefts of vehicles</span><span class="sc">\n</span><span class="st">low rate of thefts from vehicles"</span>, </span>
<span id="cb29-16"><a href="#cb29-16"></a>    <span class="at">hjust =</span> <span class="dv">1</span>,</span>
<span id="cb29-17"><a href="#cb29-17"></a>    <span class="at">lineheight =</span> <span class="dv">1</span></span>
<span id="cb29-18"><a href="#cb29-18"></a>  ) <span class="sc">+</span></span>
<span id="cb29-19"><a href="#cb29-19"></a>  <span class="fu">annotate</span>(</span>
<span id="cb29-20"><a href="#cb29-20"></a>    <span class="at">geom =</span> <span class="st">"text"</span>, </span>
<span id="cb29-21"><a href="#cb29-21"></a>    <span class="at">x =</span> <span class="dv">1</span>, </span>
<span id="cb29-22"><a href="#cb29-22"></a>    <span class="at">y =</span> <span class="dv">75</span>, </span>
<span id="cb29-23"><a href="#cb29-23"></a>    <span class="at">label =</span> <span class="st">"low rate of thefts of vehicles</span><span class="sc">\n</span><span class="st">high rate of thefts from vehicles"</span>, </span>
<span id="cb29-24"><a href="#cb29-24"></a>    <span class="at">hjust =</span> <span class="dv">0</span>,</span>
<span id="cb29-25"><a href="#cb29-25"></a>    <span class="at">lineheight =</span> <span class="dv">1</span></span>
<span id="cb29-26"><a href="#cb29-26"></a>  ) <span class="sc">+</span></span>
<span id="cb29-27"><a href="#cb29-27"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">comma_format</span>()) <span class="sc">+</span></span>
<span id="cb29-28"><a href="#cb29-28"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">comma_format</span>()) <span class="sc">+</span></span>
<span id="cb29-29"><a href="#cb29-29"></a>  <span class="fu">labs</span>(</span>
<span id="cb29-30"><a href="#cb29-30"></a>    <span class="at">title =</span> <span class="st">"Vehicle thefts in South African municipalities"</span>,</span>
<span id="cb29-31"><a href="#cb29-31"></a>    <span class="at">subtitle =</span> <span class="fu">str_glue</span>(</span>
<span id="cb29-32"><a href="#cb29-32"></a>      <span class="st">"each dot represents one municipality, 2018-19, dashed lines show "</span>,</span>
<span id="cb29-33"><a href="#cb29-33"></a>      <span class="st">"median values"</span></span>
<span id="cb29-34"><a href="#cb29-34"></a>    ),</span>
<span id="cb29-35"><a href="#cb29-35"></a>    <span class="at">x =</span> <span class="st">"rate of thefts of motor vehicles per 1,000 vehicle-owning households"</span>,</span>
<span id="cb29-36"><a href="#cb29-36"></a>    <span class="at">y =</span> <span class="st">"rate of thefts from motor vehicles per 1,000 vehicle-owning households"</span></span>
<span id="cb29-37"><a href="#cb29-37"></a>  ) <span class="sc">+</span></span>
<span id="cb29-38"><a href="#cb29-38"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/scatter-exercise3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From this plot we can now see that half of municipalities have very low rates of both types of theft (shown by the dots below and to the left of the median lines).</p>
<p>We can make some further changes to this chart. For example, instead of labelling areas on the plot we could instead label the municipalities with high rates of vehicle theft (we cannot include both types of label because they would overlap). To do that, we will create a new column in the data containing either the municipality name (for high-rate municipalities) or <code>NA</code> (meaning <code>ggplot()</code> will not create a label for that row if we set <code>na.rm = TRUE</code>). We can then use <code>geom_label_repel()</code> to add the labels to the chart, remembering to add <code>label = label</code> to the <code>aes()</code> function so <code>ggplot()</code> knows which column in the data to use for the labels.</p>
<div class="cell" data-exercise="true" data-exercise.lines="28">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb30-2"><a href="#cb30-2"></a></span>
<span id="cb30-3"><a href="#cb30-3"></a>vehicle_theft_wider <span class="sc">|&gt;</span> </span>
<span id="cb30-4"><a href="#cb30-4"></a>  <span class="fu">mutate</span>(</span>
<span id="cb30-5"><a href="#cb30-5"></a>    <span class="at">label =</span> <span class="fu">if_else</span>(theft_of <span class="sc">&gt;</span> <span class="dv">17</span> <span class="sc">|</span> theft_from <span class="sc">&gt;</span> <span class="dv">65</span>, municipality, <span class="cn">NA_character_</span>)</span>
<span id="cb30-6"><a href="#cb30-6"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb30-7"><a href="#cb30-7"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> theft_of, <span class="at">y =</span> theft_from, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb30-8"><a href="#cb30-8"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb30-9"><a href="#cb30-9"></a>    <span class="at">xintercept =</span> <span class="fu">median</span>(<span class="fu">pull</span>(vehicle_theft_wider, <span class="st">"theft_of"</span>)),</span>
<span id="cb30-10"><a href="#cb30-10"></a>    <span class="at">linetype =</span> <span class="st">"22"</span></span>
<span id="cb30-11"><a href="#cb30-11"></a>  ) <span class="sc">+</span></span>
<span id="cb30-12"><a href="#cb30-12"></a>  <span class="fu">geom_hline</span>(</span>
<span id="cb30-13"><a href="#cb30-13"></a>    <span class="at">yintercept =</span> <span class="fu">median</span>(<span class="fu">pull</span>(vehicle_theft_wider, <span class="st">"theft_from"</span>)),</span>
<span id="cb30-14"><a href="#cb30-14"></a>    <span class="at">linetype =</span> <span class="st">"22"</span></span>
<span id="cb30-15"><a href="#cb30-15"></a>  ) <span class="sc">+</span></span>
<span id="cb30-16"><a href="#cb30-16"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb30-17"><a href="#cb30-17"></a>  <span class="fu">geom_label_repel</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">label.size =</span> <span class="dv">0</span>, <span class="at">lineheight =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb30-18"><a href="#cb30-18"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">comma_format</span>()) <span class="sc">+</span></span>
<span id="cb30-19"><a href="#cb30-19"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">comma_format</span>()) <span class="sc">+</span></span>
<span id="cb30-20"><a href="#cb30-20"></a>  <span class="fu">labs</span>(</span>
<span id="cb30-21"><a href="#cb30-21"></a>    <span class="at">title =</span> <span class="st">"Vehicle thefts in South African municipalities"</span>,</span>
<span id="cb30-22"><a href="#cb30-22"></a>    <span class="at">subtitle =</span> <span class="fu">str_glue</span>(</span>
<span id="cb30-23"><a href="#cb30-23"></a>      <span class="st">"each dot represents one municipality, 2018-19, dashed lines show "</span>,</span>
<span id="cb30-24"><a href="#cb30-24"></a>      <span class="st">"median values"</span></span>
<span id="cb30-25"><a href="#cb30-25"></a>    ),</span>
<span id="cb30-26"><a href="#cb30-26"></a>    <span class="at">x =</span> <span class="st">"rate of thefts of motor vehicles per 1,000 vehicle-owning households"</span>,</span>
<span id="cb30-27"><a href="#cb30-27"></a>    <span class="at">y =</span> <span class="st">"rate of thefts from motor vehicles per 1,000 vehicle-owning households"</span></span>
<span id="cb30-28"><a href="#cb30-28"></a>  ) <span class="sc">+</span></span>
<span id="cb30-29"><a href="#cb30-29"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/scatter-exercise4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Finally, we can add a trend line to the plot. We do this using the <code>geom_smooth()</code> function from <code>ggplot2</code>. <code>geom_smooth()</code> can add different types of trend line to a plot, but in this example we will specify a simple linear trend line by setting <code>method = "lm"</code>. We will also specify <code>formula = y ~ x</code> (the default) to avoid <code>geom_smooth()</code> producing a message to tell us what formula it used to calculate the trend.</p>
<div class="cell" data-exercise="true" data-exercise.lines="27">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>vehicle_theft_wider <span class="sc">|&gt;</span> </span>
<span id="cb31-2"><a href="#cb31-2"></a>  <span class="fu">mutate</span>(</span>
<span id="cb31-3"><a href="#cb31-3"></a>    <span class="at">label =</span> <span class="fu">if_else</span>(theft_of <span class="sc">&gt;</span> <span class="dv">17</span> <span class="sc">|</span> theft_from <span class="sc">&gt;</span> <span class="dv">65</span>, municipality, <span class="cn">NA_character_</span>)</span>
<span id="cb31-4"><a href="#cb31-4"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb31-5"><a href="#cb31-5"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> theft_of, <span class="at">y =</span> theft_from)) <span class="sc">+</span></span>
<span id="cb31-6"><a href="#cb31-6"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb31-7"><a href="#cb31-7"></a>    <span class="at">xintercept =</span> <span class="fu">median</span>(<span class="fu">pull</span>(vehicle_theft_wider, <span class="st">"theft_of"</span>)),</span>
<span id="cb31-8"><a href="#cb31-8"></a>    <span class="at">linetype =</span> <span class="st">"22"</span></span>
<span id="cb31-9"><a href="#cb31-9"></a>  ) <span class="sc">+</span></span>
<span id="cb31-10"><a href="#cb31-10"></a>  <span class="fu">geom_hline</span>(</span>
<span id="cb31-11"><a href="#cb31-11"></a>    <span class="at">yintercept =</span> <span class="fu">median</span>(<span class="fu">pull</span>(vehicle_theft_wider, <span class="st">"theft_from"</span>)),</span>
<span id="cb31-12"><a href="#cb31-12"></a>    <span class="at">linetype =</span> <span class="st">"22"</span></span>
<span id="cb31-13"><a href="#cb31-13"></a>  ) <span class="sc">+</span></span>
<span id="cb31-14"><a href="#cb31-14"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">colour =</span> <span class="st">"grey20"</span>) <span class="sc">+</span></span>
<span id="cb31-15"><a href="#cb31-15"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb31-16"><a href="#cb31-16"></a>  <span class="fu">geom_label_repel</span>(</span>
<span id="cb31-17"><a href="#cb31-17"></a>    <span class="fu">aes</span>(<span class="at">label =</span> label), </span>
<span id="cb31-18"><a href="#cb31-18"></a>    <span class="at">na.rm =</span> <span class="cn">TRUE</span>, </span>
<span id="cb31-19"><a href="#cb31-19"></a>    <span class="at">label.size =</span> <span class="dv">0</span>, </span>
<span id="cb31-20"><a href="#cb31-20"></a>    <span class="at">lineheight =</span> <span class="dv">1</span></span>
<span id="cb31-21"><a href="#cb31-21"></a>  ) <span class="sc">+</span></span>
<span id="cb31-22"><a href="#cb31-22"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">comma_format</span>()) <span class="sc">+</span></span>
<span id="cb31-23"><a href="#cb31-23"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">comma_format</span>()) <span class="sc">+</span></span>
<span id="cb31-24"><a href="#cb31-24"></a>  <span class="fu">labs</span>(</span>
<span id="cb31-25"><a href="#cb31-25"></a>    <span class="at">title =</span> <span class="st">"Vehicle thefts in South African municipalities"</span>,</span>
<span id="cb31-26"><a href="#cb31-26"></a>    <span class="at">subtitle =</span> <span class="fu">str_glue</span>(</span>
<span id="cb31-27"><a href="#cb31-27"></a>      <span class="st">"each dot represents one municipality, 2018-19, dashed lines show "</span>,</span>
<span id="cb31-28"><a href="#cb31-28"></a>      <span class="st">"median values"</span></span>
<span id="cb31-29"><a href="#cb31-29"></a>    ),</span>
<span id="cb31-30"><a href="#cb31-30"></a>    <span class="at">x =</span> <span class="st">"rate of thefts of motor vehicles per 1,000 vehicle-owning households"</span>,</span>
<span id="cb31-31"><a href="#cb31-31"></a>    <span class="at">y =</span> <span class="st">"rate of thefts from motor vehicles per 1,000 vehicle-owning households"</span></span>
<span id="cb31-32"><a href="#cb31-32"></a>  ) <span class="sc">+</span></span>
<span id="cb31-33"><a href="#cb31-33"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/scatter-exercise5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From this chart, we can see which municipalities have particularly unusual vehicle theft rates. For example, we might well want to explore the rates of theft from vehicles in Beaufort West or Stellenbosch municipalities to see what makes them so different from the others, and similarly for the rate of theft of vehicles in Ethekwini.</p>
<p>One note of caution when using <code>geom_smooth()</code>: this function will show the <em>direction</em> of the relationship between two variables regardless of the <em>strength</em> of that relationship. In extreme cases, that could mean that a chart would show a trend line between two variables even if the variables had almost no relationship to one another.</p>
<p>For example, <code>geom_smooth()</code> produces a line showing the direction of the relationship between the two variables in each of these three charts, even though the relationship on the right is much stronger than the one on the left.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="fu">tibble</span>(</span>
<span id="cb32-2"><a href="#cb32-2"></a>  <span class="at">group =</span> <span class="fu">factor</span>(</span>
<span id="cb32-3"><a href="#cb32-3"></a>    <span class="fu">c</span>(<span class="st">"weak relationship"</span>, <span class="st">"moderate relationship"</span>, <span class="st">"strong relationship"</span>), </span>
<span id="cb32-4"><a href="#cb32-4"></a>    <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"weak relationship"</span>, <span class="st">"moderate relationship"</span>, <span class="st">"strong relationship"</span>)</span>
<span id="cb32-5"><a href="#cb32-5"></a>  ),</span>
<span id="cb32-6"><a href="#cb32-6"></a>  <span class="at">x =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb32-7"><a href="#cb32-7"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb32-8"><a href="#cb32-8"></a>  <span class="fu">mutate</span>(</span>
<span id="cb32-9"><a href="#cb32-9"></a>    <span class="at">sd =</span> <span class="fu">recode</span>(</span>
<span id="cb32-10"><a href="#cb32-10"></a>      group, </span>
<span id="cb32-11"><a href="#cb32-11"></a>      <span class="st">"weak relationship"</span> <span class="ot">=</span> <span class="dv">10</span>, </span>
<span id="cb32-12"><a href="#cb32-12"></a>      <span class="st">"moderate relationship"</span> <span class="ot">=</span> <span class="dv">4</span>, </span>
<span id="cb32-13"><a href="#cb32-13"></a>      <span class="st">"strong relationship"</span> <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb32-14"><a href="#cb32-14"></a>    )</span>
<span id="cb32-15"><a href="#cb32-15"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb32-16"><a href="#cb32-16"></a>  <span class="fu">group_by</span>(sd) <span class="sc">|&gt;</span> </span>
<span id="cb32-17"><a href="#cb32-17"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">list</span>(<span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">sd =</span> sd))) <span class="sc">|&gt;</span> </span>
<span id="cb32-18"><a href="#cb32-18"></a>  <span class="fu">unnest</span>(<span class="fu">c</span>(x, y)) <span class="sc">|&gt;</span> </span>
<span id="cb32-19"><a href="#cb32-19"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> scales<span class="sc">::</span><span class="fu">rescale</span>(x <span class="sc">+</span> y, <span class="at">to =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb32-20"><a href="#cb32-20"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb32-21"><a href="#cb32-21"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">colour =</span> group)) <span class="sc">+</span> </span>
<span id="cb32-22"><a href="#cb32-22"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> <span class="st">"y ~ x"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb32-23"><a href="#cb32-23"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb32-24"><a href="#cb32-24"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb32-25"><a href="#cb32-25"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb32-26"><a href="#cb32-26"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb32-27"><a href="#cb32-27"></a>  <span class="fu">coord_fixed</span>() <span class="sc">+</span></span>
<span id="cb32-28"><a href="#cb32-28"></a>  <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(group)) <span class="sc">+</span></span>
<span id="cb32-29"><a href="#cb32-29"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb32-30"><a href="#cb32-30"></a>  <span class="fu">theme</span>(</span>
<span id="cb32-31"><a href="#cb32-31"></a>    <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb32-32"><a href="#cb32-32"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb32-33"><a href="#cb32-33"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb32-34"><a href="#cb32-34"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="index_files/figure-html/geom-smooth-relationships-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="box notewell">
<p>Be very careful about trying to interpret the strength of relationships between two variables by plotting them on a chart. It is much better to measure the strength of the relationship using a statistical test such as a correlation test, but statistical tests are outside the scope of this course.</p>
</div>
</section><section id="in-summary" class="level2" data-number="15.6"><h2 data-number="15.6" class="anchored" data-anchor-id="in-summary">
<span class="header-section-number">15.6</span> In summary</h2>
<div class="box welldone">
<p>In this tutorial we have learned how to present data about crime at places without using maps. These techniques give us more flexibility about how to best present data to communicate the main points that we want to get across.</p>
<p>Whether to use a map or a chart, and which type of map or chart to use, are design decisions for you to make. When you make these decisions, always remember that what is most important is that your audience understands your message. This makes it very important that you understand your audience.</p>
</div>
<p>Visualising data with charts is a very large topic and there are lots of resources available to help you learn more. To get started, you might want to look at:</p>
<ul>
<li>
<a href="https://uc-r.github.io/ggplot_intro">An Introduction to ggplot2</a> from the University of Cincinnati Business Analytics team.</li>
<li>The <a href="https://github.com/rstudio/cheatsheets/blob/master/data-visualization-2.1.pdf">ggplot2 cheat sheet</a> by the team that develops the `ggplot2 package.</li>
<li>The <a href="https://www.r-graph-gallery.com/">R Graph Gallery</a> for examples of many other types of chart that you can produce in R.</li>
</ul>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../14_writing_reports/index.html" class="pagination-link" aria-label="Writing reports in R">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Writing reports in R</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../16_mapping_time/index.html" class="pagination-link" aria-label="Mapping crime over time">
        <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Mapping crime over time</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
<li class="nav-item">
    <a class="nav-link" href="https://creativecommons.org/licenses/by/4.0/">
<p>This book is available under a Creative Commons Attribution 4.0 International licence</p>
</a>
  </li>  
</ul>
<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/mpjashby/crimemappingbook/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


</body></html>