<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>14&nbsp; Writing reports in R – Learn Crime Mapping with R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../15_no_maps/index.html" rel="next">
<link href="../13_crime_series/index.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<!-- START OF INCLUDED HEADER -->

<!--
This file contains code that will be included in the header of each page of the
quarto book
-->

<script src="https://code.jquery.com/jquery-3.6.3.min.js" integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU=" crossorigin="anonymous"></script>

<!-- END OF INCLUDED HEADER -->


<link rel="stylesheet" href="../css/styles.css">
<link rel="stylesheet" href="../include/webex.css">
<meta name="twitter:title" content="14&nbsp; Writing reports in R – Learn Crime Mapping with R">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="../images/cover_image.png">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../14_writing_reports/index.html"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Writing reports in R</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../images/cover_image.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Learn Crime Mapping with R</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/mpjashby/crimemappingbook/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="../learn_crime_mapping_with_r.epub" title="Download ePub" class="quarto-navigation-tool px-1" aria-label="Download ePub"><i class="bi bi-journal"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome!</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Contents</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Install the software needed for this book</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01_getting_started/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting started</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02_your_first_crime_map/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Your first crime map</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_data_wrangling/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Wrangling data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04_your_second_crime_map/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Your second crime map</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05_code_with_style/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Code with style</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../06_mapping_crime_patterns/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Mapping crime patterns</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../07_map_context/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Giving a map context</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../08_handling_bugs/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Handling bugs in your code</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../09_mapping_areas/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Mapping area data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../10_place_data/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Using data about places</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../11_mapping_hotspots/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Mapping hotspots</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../12_messy_data/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Handling messy data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../13_crime_series/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Mapping crime series</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../14_writing_reports/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Writing reports in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../15_no_maps/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Presenting spatial data without maps</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../16_mapping_time/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Mapping crime over time</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/read_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Functions for reading data into R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/map_checklist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Checklist: Making a good crime map</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/common_errors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Common R errors and how to fix them</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/functions_to_avoid.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Some R functions you should avoid</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/handling_errors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Checklist: handling code errors</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">In this chapter</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">14.1</span> Introduction</a></li>
  <li><a href="#markdown" id="toc-markdown" class="nav-link" data-scroll-target="#markdown"><span class="header-section-number">14.2</span> Markdown</a>
  <ul class="collapse">
  <li><a href="#markdown-document-structure" id="toc-markdown-document-structure" class="nav-link" data-scroll-target="#markdown-document-structure"><span class="header-section-number">14.2.1</span> Markdown document structure</a></li>
  <li><a href="#inline-elements" id="toc-inline-elements" class="nav-link" data-scroll-target="#inline-elements"><span class="header-section-number">14.2.2</span> Inline elements</a></li>
  <li><a href="#processing-markdown-in-rstudio" id="toc-processing-markdown-in-rstudio" class="nav-link" data-scroll-target="#processing-markdown-in-rstudio"><span class="header-section-number">14.2.3</span> Processing Markdown in RStudio</a></li>
  </ul></li>
  <li><a href="#quarto" id="toc-quarto" class="nav-link" data-scroll-target="#quarto"><span class="header-section-number">14.3</span> Quarto</a>
  <ul class="collapse">
  <li><a href="#r-code-in-quarto" id="toc-r-code-in-quarto" class="nav-link" data-scroll-target="#r-code-in-quarto"><span class="header-section-number">14.3.1</span> R code in Quarto</a></li>
  </ul></li>
  <li><a href="#rendering-quarto" id="toc-rendering-quarto" class="nav-link" data-scroll-target="#rendering-quarto"><span class="header-section-number">14.4</span> Rendering Quarto</a>
  <ul class="collapse">
  <li><a href="#making-self-contained-html-documents" id="toc-making-self-contained-html-documents" class="nav-link" data-scroll-target="#making-self-contained-html-documents"><span class="header-section-number">14.4.1</span> Making self-contained HTML documents</a></li>
  </ul></li>
  <li><a href="#in-summary" id="toc-in-summary" class="nav-link" data-scroll-target="#in-summary"><span class="header-section-number">14.5</span> In summary</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/mpjashby/crimemappingbook/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-reports" class="quarto-section-identifier"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Writing reports in R</span></span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><strong>Learn how to write reports directly in RStudio that integrate text, data, tables and charts using Quarto.</strong></p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>This chapter has not yet been updated for 2025, so some material is out of date. Check back for an update in mid-February 2025.</p>
</div>
</div>
<section id="introduction" class="level2" data-number="14.1">
<h2 data-number="14.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">14.1</span> Introduction</h2>
<p>We already know how to produce useful maps in R so that people can use them to make decisions about understanding and responding to crime problems. But maps are only one part of most spatial analysis. In practice, maps are usually part of a larger report in which you as an analyst will explain what your maps show and perhaps make recommendations about what decisions people should make.</p>
<p>You are probably used to creating graphics in one piece of software (such as a map in R or a chart in Excel) and then importing or pasting those graphics into another program (such as Word) to including them in a written report. This way of working is often fine, but it has some shortcomings. For example, if you want to make a change to a graphic (maybe to correct a typo), you then have to import it into your writing program again. More importantly, it can become hard to keep track of which version of a graphic you need to import and you may end up including the wrong version of a file.</p>
<p>The same problem applies to numbers that you might calculate in statistical software such as R. You might calculate a statistic such as the mean number of burglaries in local council wards, then paste the result into Word to include it in your report. But if you then realise later on that there is a problem with your data and re-run your code, it would be very easy (especially in a long report) to forget that you needed to update the mean value presented in the report. The risk of making errors like this is particularly high if you are asked to update an existing report based on new data. Perhaps the worst aspect of this problem is that you will never know if the numbers in your final report are correct, unless you go back and check every one of them in whatever program you used to generate the numbers in the first place.</p>
<p>We can describe this risk of a report containing obsolete charts or incorrect statistics by saying that is is not <em>reproducible</em> – if we were asked to go back and demonstrate each stage in producing the report to prove that we had done everything correctly, it would be very hard to do so. This is important because the reports that analysts write about crime are so often used to make decisions about how to respond to crime. An error in copying and pasting a number from R or Excel into Word could lead to police officers being deployed to the wrong place, or the wrong local council being given funding to install crime-prevention measures.</p>
<p>In this tutorial we will learn to use a tool called <em>Quarto</em> to write reports directly in RStudio, integrating data, maps and statistics directly into reports so that they are always up-to-date. Quarto can be used to produce detailed and polished reports in a way that makes sure they are always up to date. For example, the report <a href="https://discovery.ucl.ac.uk/id/eprint/10115766/1/2020-Q3.pdf"><em>Stop and Search in London</em></a> was created entirely in Quarto.</p>
<p class="centered-image">
<img src="images/quarto_process.png" alt="A schematic representing the multi-language input (e.g. Python, R, Observable, Julia) and multi-format output (e.g. PDF, html, Word documents, and more) versatility of Quarto.">
</p>
</section>
<section id="markdown" class="level2" data-number="14.2">
<h2 data-number="14.2" class="anchored" data-anchor-id="markdown"><span class="header-section-number">14.2</span> Markdown</h2>
<p><em>Markdown</em> is a way of formatting plain text so that a computer can convert it into different file formats. For example, RStudio can convert Markdown documents into Word, PDF, PowerPoint and many other formats.</p>
<p class="full-width-image">
<img src="images/markdown_flowchart.png" alt="Flow chart showing that a Markdown document can be processed by RStudio into Word, PDF, PowerPoint, web or other formats">
</p>
<p>Markdown uses plain-text characters to represent formatting such as titles, italic text and so on. For example, the Markdown text:</p>
<div class="sourceCode" id="cb1" data-code-line-numbers=""><pre class="sourceCode numberSource lang-md number-lines code-with-copy"><code class="sourceCode"><span id="cb1-1"><a href="#cb1-1"></a># Introduction</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a>In this tutorial we will learn to use a tool called *Quarto* to write reports directly in RStudio.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>produces the output:</p>
<div class="faux-markdown">
<h1>
Introduction
</h1>
<p>
In this tutorial we will learn to use a tool called <em>Quarto</em> to write reports directly in RStudio.
</p>
</div>
<p>In this example, the character <code>#</code> followed by a space at the start of a line mean that line should be shown as a first-level heading and the asterisks (<code>*</code> – we could also have used the underscore character <code>_</code>) around the word <code>Quarto</code> indicate that it should be emphasised (typically with <em>italic</em> text).</p>
<div class="box notewell">
<p>In Markdown we use the hash character <code>#</code> followed by a space to indicate that a line should be formatted as a top-level heading. The space after the <code>#</code> is important – if you write <code>#Introduction</code> instead of <code># Introduction</code> then R will not recognise that line as representing a heading and it will not be formatted properly.</p>
</div>
<p>Markdown is designed to be easy to read and easy to write. It is perfectly possible, for example, to read the unformatted Markdown text in the example above. Since Markdown files (which have the file extension <code>.md</code>) are plain text, it’s also possible to open them on virtually any computer. Markdown is very widely used on the web – using underscores to mark out italic text and asterisks to mark out bold text even works in messaging apps such as Telegram and WhatsApp.</p>
<p>In Markdown you describe the <em>structure</em> of a document, not its appearance. The appearance of the document (which fonts it uses, what margins the pages have and so on) are determined by the templates that RStudio uses to convert markdown files into documents of different types. This can save you a lot of time, because you don’t need to specify fonts and other formatting. Instead, you can concentrate on the structure of your argument rather than the details of formatting.</p>
<p>You can create your own templates for documents (for example if you want to create documents that match a particular corporate style) but in this course we will use the templates built into RStudio, which are designed to create documents that communicate data effectively.</p>
<section id="markdown-document-structure" class="level3" data-number="14.2.1">
<h3 data-number="14.2.1" class="anchored"><span class="header-section-number">14.2.1</span> Markdown document structure</h3>
<p>To create paragraphs in Markdown, you simply split text with a blank line. So this Markdown text:</p>
<div class="sourceCode" id="cb2" data-code-line-numbers=""><pre class="sourceCode numberSource lang-md number-lines code-with-copy"><code class="sourceCode"><span id="cb2-1"><a href="#cb2-1"></a>In this tutorial we will learn to use a tool called _Quarto_ to write reports directly in RStudio.</span>
<span id="cb2-2"><a href="#cb2-2"></a>Markdown is a way of formatting plain text so that a computer can convert it into different file formats.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>produces the output:</p>
<div class="faux-markdown">
<p>In this tutorial we will learn to use a tool called <em>Quarto</em> to write reports directly in RStudio. Markdown is a way of formatting plain text so that a computer can convert it into different file formats.</p>
</div>
<p>because there is no blank line between the first and second sentences. We can split this into two paragraphs just by adding a blank line:</p>
<div class="sourceCode" id="cb3" data-code-line-numbers=""><pre class="sourceCode numberSource lang-md number-lines code-with-copy"><code class="sourceCode"><span id="cb3-1"><a href="#cb3-1"></a>In this tutorial we will learn to use a tool called _Quarto_ to write reports directly in RStudio.</span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a>Markdown is a way of formatting plain text so that a computer can convert it into different file formats.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>which produces the output:</p>
<div class="faux-markdown">
<p>In this tutorial we will learn to use a tool called <em>Quarto</em> to write reports directly in RStudio.</p>
<p>Markdown is a way of formatting plain text so that a computer can convert it into different file formats.</p>
</div>
<section id="headings" class="level4" data-number="14.2.1.1">
<h4 data-number="14.2.1.1" class="anchored"><span class="header-section-number">14.2.1.1</span> Headings</h4>
<p>There are six levels of headings available in Markdown documents, although it is very unlikely that you will need all six. Headings are specified by adding one or more <code>#</code> characters to the start of the line, followed by a space:</p>
<div class="sourceCode" id="cb4" data-code-line-numbers=""><pre class="sourceCode numberSource lang-md number-lines code-with-copy"><code class="sourceCode"><span id="cb4-1"><a href="#cb4-1"></a># First-level heading</span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a>## Second-level heading</span>
<span id="cb4-4"><a href="#cb4-4"></a></span>
<span id="cb4-5"><a href="#cb4-5"></a>### Third-level heading</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>produces:</p>
<div class="faux-markdown">
<h1>
First-level heading
</h1>
<h2 class="anchored" data-anchor-id="headings">
Second-level heading
</h2>
<h3 class="anchored">
Third-level heading
</h3>
</div>
<p>Headings should have at least one blank line above and below them, so that they stand out from the surrounding code. I usually leave three blank lines before a second-level heading and two blank lines before other headings, with exactly one blank line after every type of heading.</p>
<div class="box notewell">
<p>Remember that Markdown describes the <em>structure</em> of a document, not its appearance, so you should not choose a heading level based on what size of text it produces in a particular output format. It is often best to save the first-level heading for your document title, so break the document up into sections by specifying second-level headings and then break those sections up into sub-sections with third-level headings etc.</p>
</div>
</section>
<section id="lists" class="level4" data-number="14.2.1.2">
<h4 data-number="14.2.1.2" class="anchored" data-anchor-id="lists"><span class="header-section-number">14.2.1.2</span> Lists</h4>
<p>Markdown supports two types of list: ordered lists and unordered lists. You can make an ordered list by putting each list item on a new line and starting each line with a number followed by a full stop (<code>.</code>). You make an unordered list in the same way, but starting each line with an asterisk:</p>
<div class="sourceCode" id="cb5" data-code-line-numbers=""><pre class="sourceCode numberSource lang-md number-lines code-with-copy"><code class="sourceCode"><span id="cb5-1"><a href="#cb5-1"></a>1. A list of items</span>
<span id="cb5-2"><a href="#cb5-2"></a>2. for which the ordering</span>
<span id="cb5-3"><a href="#cb5-3"></a>3. of items is important</span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a>* A list of items</span>
<span id="cb5-6"><a href="#cb5-6"></a>* for which the ordering</span>
<span id="cb5-7"><a href="#cb5-7"></a>* of items is *not* important</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>produces:</p>
<div class="faux-markdown">
<ol type="1">
<li>A list of items</li>
<li>for which the ordering</li>
<li>of items is important</li>
</ol>
<ul>
<li>A list of items</li>
<li>for which the ordering</li>
<li>of items is <em>not</em> important</li>
</ul>
</div>
</section>
<section id="quotes" class="level4" data-number="14.2.1.3">
<h4 data-number="14.2.1.3" class="anchored" data-anchor-id="quotes"><span class="header-section-number">14.2.1.3</span> Quotes</h4>
<p>If you want to insert a quote into your Markdown document, you can do that by putting a greater-than (<code>&gt;</code>) symbol followed by a space at the start of each line of the quote:</p>
<div class="sourceCode" id="cb6" data-code-line-numbers=""><pre class="sourceCode numberSource lang-md number-lines code-with-copy"><code class="sourceCode"><span id="cb6-1"><a href="#cb6-1"></a>&gt; In this tutorial we will learn to use a tool called _Quarto_ to write reports directly in RStudio.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>produces</p>
<div class="faux-markdown">
<blockquote class="blockquote">
In this tutorial we will learn to use a tool called <em>Quarto</em> to write reports directly in RStudio.
</blockquote>
</div>
</section>
</section>
<section id="inline-elements" class="level3" data-number="14.2.2">
<h3 data-number="14.2.2" class="anchored" data-anchor-id="inline-elements"><span class="header-section-number">14.2.2</span> Inline elements</h3>
<p>As well as using Markdown to describe the structure of a document, you can use it to mark up particular text within a paragraph. We’ve already seen how to do this using <code>_to emphasise text_</code> (usually displayed in <em>italics</em>). We can also <code>**strongly emphasise**</code> text, which will usually appear in <strong>bold</strong>. Note that the <code>_</code>, <code>*</code> or <code>**</code> characters must be touching a word on exactly one side:</p>
<ul>
<li><code>some _emphasised_ text</code> produces some <em>emphasised</em> text</li>
<li><code>some_emphasised_text</code> does not produce emphasised text</li>
<li><code>some _ emphasised _ text</code> does not produce emphasised text</li>
</ul>
<p>We can add links to a document using the format <code>[link text](URL)</code>. For example, the text:</p>
<div class="sourceCode" id="cb7" data-code-line-numbers=""><pre class="sourceCode numberSource lang-md number-lines code-with-copy"><code class="sourceCode"><span id="cb7-1"><a href="#cb7-1"></a>[learn about the tidyverse](https://www.tidyverse.org/)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>produces the link:</p>
<div class="faux-markdown">
<p><a href="https://www.tidyverse.org/">learn about the tidyverse</a></p>
</div>
<p>There are several other Markdown codes for describing different elements within a document, including images, videos and segments of code. You can find out more about what’s possible with Markdown on the <a href="https://quarto.org/docs/authoring/markdown-basics.html">Markdown Basics page of the Quarto website</a>.</p>
</section>
<section id="processing-markdown-in-rstudio" class="level3" data-number="14.2.3">
<h3 data-number="14.2.3" class="anchored" data-anchor-id="processing-markdown-in-rstudio"><span class="header-section-number">14.2.3</span> Processing Markdown in RStudio</h3>
<p>Once you’ve written a Markdown document, you can convert it into a web page, a Word document or a PDF file from within RStudio. First, save your document with a <code>.md</code> file extension – this tells RStudio that the file is a Markdown document. You should now see a new button at the top of the RStudio script panel marked <code>Preview</code>.</p>
<p class="centered-image">
<img src="images/rstudio-markdown-preview.png" alt="Screen shot of the Preview button in RStudio that allows converting Markdown documents to web pages, PDFs or Word documents.">
</p>
<p>If you click on the small downward-pointing triangle next to that button, you have the option to produce your report in <abbr title="hypertext markup language">HTML</abbr> (web page) format, PDF or Microsoft Word. HTML format is useful for creating documents to be published on the web, but also for quickly previewing documents in RStudio while you are working on them. Click on the relevant option to create the document in your format of choice.</p>
<p>You do not need to have Microsoft Word installed on your computer to produce Word documents from Markdown files in RStudio, although you will need Word (or other word-processing software) to view the file.</p>
<p>To create PDF files from Markdown in RStudio, your computer has to have a version of software called TeX installed. If you’ve never heard of TeX, you can install it automatically using the <code>tinytex</code> R package. To install TeX, just run this R code <em>once</em> on your computer:</p>
<div class="sourceCode" id="cb8" data-code-line-numbers=""><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">install.packages</span>(<span class="st">"tinytex"</span>)</span>
<span id="cb8-2"><a href="#cb8-2"></a>tinytex<span class="sc">::</span><span class="fu">install_tinytex</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>TeX should now be installed on your computer. After you have restarted RStudio you will be able to create PDFs from within RStudio.</p>
<div class="box notewell">
<p>Note that you only have to install TeX once on each computer you use, so you should not include <code>tinytex::install_tinytex()</code> in any Quarto scripts that you write.</p>
</div>
</section>
</section>
<section id="quarto" class="level2" data-number="14.3">
<h2 data-number="14.3" class="anchored" data-anchor-id="quarto"><span class="header-section-number">14.3</span> Quarto</h2>
<p>Markdown allows you to create static documents in RStudio. We can add all types of R output – including maps, tables, charts and the results of calculations – to Markdown documents using <em>Quarto</em>, which is built into RStudio.</p>
<p>Quarto is a system that converts Markdown documents that contain chunks of code written in R or Python, runs the code and then integrates the Markdown text and the code results into one or more output files. Quarto can produce web pages, Word documents, PDF files, presentations, websites, e-books and other formats.</p>
<p>A Quarto file is just like a Markdown document except that it has the file extension <code>.qmd</code> rather than the extension <code>.md</code>. The <code>.qmd</code> extension tells RStudio that a file will contain a mixture of text formatted with Markdown and code that produces tables, charts and so on.</p>
<p>Since Quarto can produce many types of document, RStudio has a dialogue box in which you can select from all the installed Quarto templates. Click on the ‘new file’ button in the top-left corner of the RStudio window and then on <code>Quarto Document…</code></p>
<p class="centered-image">
<img src="images/rstudio-quarto-menu.png" alt="Screen shot of RStudio's menu for creating a new documents.">
</p>
<p>This will open a box containing all the Quarto templates that are installed on your computer. Some of these are installed by default and some may have been added by packages that you have installed.</p>
<p class="centered-image">
<img src="images/rstudio-new-quarto.png" alt="Screen shot of RStudio's dialogue box for creating a new Quarto document.">
</p>
<p>You can edit Quarto documents in two ways in RStudio. When you create a new Quarto document, RStudio will open it in the <em>Visual editor</em>. This allows you to write the text content of your document as you would in word-processing software such as Word. For example, you can make text bold using buttons on the tool bar at the top of the document, or using standard keyboard short-cuts such as <code>Ctrl+B</code> on Windows or <code>Command+B</code> on Mac. There is also a <em>Source editor</em>, which allows you to edit the underlying Markdown formatted text directly.</p>
<p>In this tutorial we will use the Visual editor, but you can choose to use the Source editor if you prefer. To switch between the two editors, slick the <code>Source</code> or <code>Visual</code> buttons at the left-hand end of the formatting tool bar at the top of the Quarto document window.</p>
<p>Whichever editor you use, Quarto documents start with a <em>header</em> that provides some basic information about the document, such as the title. A simple Quarto header looks like this:</p>
<div class="sourceCode" id="cb9" data-code-line-numbers=""><pre class="sourceCode numberSource yaml number-lines code-with-copy"><code class="sourceCode yaml"><span id="cb9-1"><a href="#cb9-1"></a><span class="pp">---</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="fu">title</span><span class="kw">:</span><span class="at">  </span><span class="st">"An Quarto document"</span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="fu">author</span><span class="kw">:</span><span class="at"> </span><span class="st">"Joe Bloggs"</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="fu">date</span><span class="kw">:</span><span class="at">   </span><span class="st">"3 March 2021"</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="pp">---</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The header is written in yet another programming language called <a href="https://en.wikipedia.org/wiki/YAML">YAML</a>. You don’t need to know the details of YAML to write headers for Quarto documents. Two things you do need to know, though:</p>
<ul>
<li>The three dashes (<code>---</code>) are important, because they tell RStudio that the content inside the dashes is the document header. The dashes must appear at the start of a line on their own.</li>
<li>Indentation matters in YAML. Every line takes the form <code>key: value</code> and in most cases the key must be at the very start of the line. Lines in YAML are not limited to 80 characters, so you should not break a single value (such as the document title) over multiple lines.</li>
</ul>
<section id="r-code-in-quarto" class="level3" data-number="14.3.1">
<h3 data-number="14.3.1" class="anchored" data-anchor-id="r-code-in-quarto"><span class="header-section-number">14.3.1</span> R code in Quarto</h3>
<p>Quarto will process everything in an Quarto document after the header (marked with <code>---</code>) as Markdown text. The only exception to this is when you include sections of code in an Quarto document.</p>
<p>You can include R code inside a line of Markdown text (known as <em>inline</em> code) and the result of that code will be included in the document output. To do this in the visual editor, you type a lower-case <code>r</code> followed by a space, then the code you want to run. You then select the text from the letter <code>r</code> to the end of the code, open the <code>Format</code> menu in the Quarto tool bar and select <code>Code</code> (alternatively you can select the text and use the keyboard short-cut <code>Command+D</code> on Mac or <code>Ctrl+D</code> on Windows).</p>
<p>For example, if you wanted to insert today’s date into a Quarto document, you can type:</p>
<p class="centered-image">
<img src="images/quarto-inline-code.gif" alt="Animated screen shot of adding inline code to a Quarto document">
</p>
<p>Which would produce the output:</p>
<p class="centered-image">
<img src="images/quarto-inline-code.png" alt="Screen shot of a Quarto document with the text 'This document was written on 3 March 2023'.">
</p>
<p>Putting R code inline is fine for simple pieces of code, but longer pieces of code included inline would become difficult to read (and therefore difficult to debug). Fortunately, we can put as much code as we like in a <em>code block</em>. To add a block of R code to an Quarto document, we open the <code>Insert</code> menu on the Quarto tool bar, click <code>Code Chunk</code> and then <code>R</code>. You will then see a grey box appear at the point in your document where you had placed the cursor, with the text <code>{r}</code> at the start of the box.</p>
<p>We can use code chunks to run longer pieces of code that would be difficult to read if the code were inline. For example, if you wanted to load a data file of crime data, filter it for crimes occurring in a particular month and then count the number of rows, you could do the calculation in a code chunk and then include the result inline:</p>
<p class="centered-image">
<img src="images/quarto-code-chunk.png" alt="Screen shot of an R code chunk in an Quarto document.">
</p>
<p>Note that to make the Quarto document more readable, RStudio has given the R code chunk a grey background, in contrast to the white background of the rest of the document. If a code chunk does not have a grey background, this is a good sign that there is something wrong: maybe you haven’t saved the file with a <code>.qmd</code> file extension, or maybe you have not inserted the code block correctly.</p>
<p>Code chunks can also be used to insert tables and charts (including maps) into a Quarto document. To add a nicely formatted table of data, use the <code>kable()</code> function from the <code>knitr</code> library. For example:</p>
<div class="sourceCode" id="cb10" data-code-line-numbers=""><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># Print table of crime counts in each police division</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>crimes <span class="sc">|&gt;</span> </span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2021</span>, month <span class="sc">==</span> <span class="st">"February"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb10-4"><a href="#cb10-4"></a>  <span class="fu">count</span>(division) <span class="sc">|&gt;</span> </span>
<span id="cb10-5"><a href="#cb10-5"></a>  <span class="co"># We haven't loaded the `knitr` package, so we need to refer to the `kable()`</span></span>
<span id="cb10-6"><a href="#cb10-6"></a>  <span class="co"># function using the `::` operator</span></span>
<span id="cb10-7"><a href="#cb10-7"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>We can also use code chunks to produce graphics. In this case, you just include the code to produce your map or chart in a code chunk as you normally would.</p>
<p>To help keep track of code chunks, we can name them. To name a code chunk, put a single space after the letter <code>r</code> in the line that begins the chunk and then give the chunk name. Names can include letters, numbers and dashes (<code>-</code>). For example, if we wanted to call the chunk above <code>count-all-crimes</code> we would start the code chunk with the code <code>{r count-all-crimes}</code>.</p>
<p>The package that converts Quarto documents into other formats is called <code>knitr</code> – actually, it’s a bit more complicated than that, but one of the nice things about Quarto is you don’t need to worry about what’s happening behind the scenes.</p>
<p class="full-width-image">
<img src="images/knitr-process.png" alt="A schematic representing rendering of Quarto documents from .qmd, to knitr or jupyter, to plain text markdown, then converted by pandoc into any number of output types including html, PDF, or Word document.">
</p>
<p>The default Quarto template is set up so that the final document that is produced from your Quarto file will include both the code that you include in any code chunks <em>and</em> the output that the code produces. For example, this Quarto document:</p>
<p class="centered-image">
<img src="images/quarto-example-doc.png" alt="Screen shot of an example Quarto document containing a code chunk.">
</p>
<p>Produces this output, which is probably not what you want:</p>
<p class="centered-image image-border">
<img src="images/quarto-example-output.png" alt="Screen shot of the output from an example Quarto document showing code and chunk output.">
</p>
<p>We can control the results of code chunks using <em>chunk options</em>, sometimes called <em>knitr options</em>. We put these on the first line of each code chunk, with each option on a separate line and each line starting with the characters <code>#|</code> (referred to as a <em>hash-pipe</em>). Note that the <code>#|</code> <em>must</em> be followed by a space for Quarto to recognise it as a chunk option.</p>
<p>To specify that the code in our R code chunks should not be printed in the final document, we can set the chunk option <code>#| echo: false</code>. To specify that both the R code and the <em>output</em> produced by that code in each code chunk (e.g.&nbsp;and messages or warnings) should not be shown, we can set the chunk option <code>#| include: false</code>.</p>
<p>If we change the code in our previous example to include this line, the output becomes much more like the report we want:</p>
<p class="centered-image image-border">
<img src="images/quarto-example-output-better.png" alt="Screen shot of the output from an example Quarto document with code and chunk output suppressed.">
</p>
<p>If a code chunk produces a chart or map then we <em>do</em> want to show the output (although not the code), so in that case we should not set <code>#| include: false</code> – we do not need to set <code>#| include: true</code> because it is the default.</p>
<p>Since we probably don’t want any chunks in our code to include the code in our final document, we could end up setting the chunk option <code>#| echo: false</code> for every code chunk. In a long or complicated document, this would get tedious. Fortunately, we can set chunk options <em>globally</em> (i.e.&nbsp;for all chunks in a document) by setting them in the YAML document header. To do this, we add a key called <code>execute</code> to the header. Instead of giving the <code>execute</code> key a value such as <code>true</code> or <code>false</code>, we instead indent the <em>next</em> line of the header by exactly two spaces and then set the chunk option <code>echo: false</code>. If we wanted to set multiple global chunk options here, we would put each one on a new line, all of the lines indented by two spaces from the start of each document.</p>
<div class="sourceCode" id="cb11" data-code-line-numbers=""><pre class="sourceCode numberSource yaml number-lines code-with-copy"><code class="sourceCode yaml"><span id="cb11-1"><a href="#cb11-1"></a><span class="pp">---</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="fu">title</span><span class="kw">:</span><span class="at">  </span><span class="st">"An Quarto document"</span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="fu">author</span><span class="kw">:</span><span class="at"> </span><span class="st">"Joe Bloggs"</span></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="fu">date</span><span class="kw">:</span><span class="at">   </span><span class="st">"3 March 2021"</span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="fu">execute</span><span class="kw">:</span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="at">  </span><span class="fu">echo</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="pp">---</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Some of the R code we write produces messages or warnings that we will not want to include in our Quarto documents. For example, readers of a report based on crime data are unlikely to want to see the warning produced by the <code>st_intersection()</code> function, and will probably be quite surprised if this appears in their code. To hide these messages, we can split the code needed to produce a map into two code chunks: one to do the pre-processing that often creates messages or warnings, and a second chunk to create the map itself.</p>
<p class="centered-image">
<img src="images/quarto-multiple-chunks.png" alt="Screen shot of the a Quarto document including multiple code chunks with different chunk options.">
</p>
</section>
</section>
<section id="rendering-quarto" class="level2" data-number="14.4">
<h2 data-number="14.4" class="anchored" data-anchor-id="rendering-quarto"><span class="header-section-number">14.4</span> Rendering Quarto</h2>
<p>Once you’ve written the text for your document and added the code needed to produce statistics, tables and figures, it’s time to convert your Quarto file to a document in the format you need. This process is called <em>rendering</em>.</p>
<p>In RStudio you can render a Quarto document by clicking the <code>Render</code> button (if you can’t see the <code>Render</code> button at the top of your Quarto document, that is a sign you haven’t saved the file as a <code>.qmd</code> file). By default, RStudio will produce an HTML file (a web page) and open it in the HTML viewer built into RStudio. You can produce other formats instead of a web page by clicking on the downward-pointing arrow next to the <code>Render</code> button and then choosing the format you want.</p>
<p>You can control the output format that RStudio will produce by changing the <code>format:</code> value in the YAML header of your Quarto document. The default is <code>format: html</code>, but you can also use <code>format: pdf</code> to produce a PDF file, <code>format: docx</code> to produce a Word document, <code>format: epub</code> to produce an e-book, <code>format: pptx</code> to produce a PowerPoint presentation. There are <a href="https://quarto.org/docs/output-formats/all-formats.html">many other ouput formats available</a>.</p>
<div class="box notewell">
<p>If you have a choice of which format to produce a report in, I would suggest you choose HTML because it can do things (like include interactive maps made with <code>leaflet</code>) that Word and PDF format cannot, and can easily be read on mobile devices. If, for whatever reason, you cannot choose HTML, I recommend choosing PDF format since it is readable on almost all computers, even those that do not have Word installed on them. Only produce reports in Word format if you are specifically required to submit something in that format.</p>
</div>
<p>Whatever format you choose, the output file will be saved in the same folder on your computer that you saved your <code>.qmd</code> file in, and will have the same file name but with a different file extension (<code>.html</code>, <code>.pdf</code>, <code>.docx</code>, etc.). If you render the document again, RStudio will overwrite the previous output file.</p>
<p>When you render a Quarto document, RStudio will run all the code in the file so that it can knit the results together with the document text. This is similar to running the code in a <code>.R</code> file using the <code>Source</code> button, except that when RStudio runs the code in a Quarto document, RStudio can only access functions from the packages that are loaded in the Quarto document itself, and only make use of objects created inside the Quarto document. This means that nothing you do in the console or in any other files you have open in RStudio (e.g.&nbsp;loading a package or creating an object) affects the results that will be produced when you render a Quarto document.</p>
<p>Since rendering a Quarto document involves running all the code contained in it, it is possible that the code will cause errors at the time when the Quarto document is rendered. When this happens, the R error message will appear in the RStudio Render panel. When you run a <code>.R</code> file that produces an error, the error message typically tells you which line of code the error occurred on. But when an error occurs while rendering a Quarto file, the error message only specifies the first and last lines of the <em>part</em> of the document in which the error occurred. If the error occurred inside a code chunk, the error message will refer to the first and last lines of that chunk, but the error itself could have occurred anywhere inside that chunk. If the error occurs <em>outside</em> a code chunk, the error message will report that the error occurred somewhere between the last line of the previous code chunk and the first line of the next code chunk. It is up to you to find the exact location of the error.</p>
<section id="making-self-contained-html-documents" class="level3" data-number="14.4.1">
<h3 data-number="14.4.1" class="anchored" data-anchor-id="making-self-contained-html-documents"><span class="header-section-number">14.4.1</span> Making self-contained HTML documents</h3>
<p>Web pages written in HTML typically make use of images, videos and other resources stored in separate files. In fact, the web page you’re reading now makes use of resources stored in 51 separate files. This works well on the web, since it allows resources to be shared between lots of HTML files, which reduces how much data has to be stored and transmitted across networks. But it works less well when you want to send an HTML report to someone else over email, since it can be hard to keep track of all the external files associated with a particular HTML file.</p>
<p>To deal with this problem, we can tell Quarto that when it creates an HTML report, all the necessary data and other resources should be embedded inside the HTML file itself. This makes the HTML file larger, but easier to manage. To make HTML reports produced by Quarto self-contained in this way, we can change the <code>format</code> section of the header of a Quarto document from simply <code>format: html</code> to instead specify exactly what settings we want to be used to create that HTML file:</p>
<div class="sourceCode" id="cb12" data-code-line-numbers=""><pre class="sourceCode numberSource yaml number-lines code-with-copy"><code class="sourceCode yaml"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">format</span><span class="kw">:</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="at">  </span><span class="fu">html</span><span class="kw">:</span></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="at">    </span><span class="fu">embed-resources</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>There are lots of other ways we can use the <code>format</code> section of the header in a Quarto document to fine-tune how the resulting document works. You can find out more <a href="https://quarto.org/docs/output-formats/html-basics.html">in the HTML section of the Quarto website</a>.</p>
</section>
</section>
<section id="in-summary" class="level2" data-number="14.5">
<h2 data-number="14.5" class="anchored" data-anchor-id="in-summary"><span class="header-section-number">14.5</span> In summary</h2>
<div class="box welldone">
<p>In this tutorial we have learned how to use Markdown to create structured text using simple formatting codes and how to integrate that text with our code to produce integrated reports that include the results of our analysis. This means we can make our work <em>reproducible</em> so that we can avoid all the mistakes that can happen if we have to copy and paste statistics and graphics into reports written in software like Word.</p>
<p>It also means we can produce periodic reports with updated data very easily, since we can just choose the data we want the report to be based on using <code>filter()</code> at the start of our file and render the document. This can save a huge amount of time in producing reports such as performance bulletins or monthly summaries of crime in an area.</p>
</div>
<p>To get used to working with Quarto files, download <a href="https://github.com/mpjashby/crimemapping/raw/main/inst/example_quarto_report.qmd">this example report</a> to your computer and open it in RStudio. Now make the following changes:</p>
<ol type="1">
<li>Change the global chunk options so that the code used in each code chunk is not shown in the final document.</li>
<li>Render the file into documents of at least two different formats (e.g.&nbsp;HTML and Word). If you have installed <code>tinytex</code> on your computer so that you can create PDF documents, look at how different the document appears in PDF format compared to HTML format because of the different templates used.</li>
</ol>
<p>There is a lot more you can do with Quarto. To find out more, refer to these resources.</p>
<ul>
<li><a href="https://r4ds.hadley.nz/quarto.html">R for Data Science chapter on Quarto</a>.</li>
<li>A <a href="https://quarto.org/docs/gallery/">gallery of different documents, websites and presentations written with Quarto</a>.</li>
</ul>
<p class="credits">
<a href="https://twitter.com/allison_horst">Artwork by <span class="citation" data-cites="allison_horst">@allison_horst</span></a>
</p>


<!-- -->

</section>

</main> <!-- /main -->
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Show Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Show Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../13_crime_series/index.html" class="pagination-link" aria-label="Mapping crime series">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Mapping crime series</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../15_no_maps/index.html" class="pagination-link" aria-label="Presenting spatial data without maps">
        <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Presenting spatial data without maps</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb13" data-shortcodes="false" data-code-line-numbers=""><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu"># Writing reports in R {#sec-reports}</span></span>
<span id="cb13-2"><a href="#cb13-2"></a></span>
<span id="cb13-3"><a href="#cb13-3"></a></span>
<span id="cb13-4"><a href="#cb13-4"></a>**Learn how to write reports directly in RStudio that integrate text, data, tables and charts using Quarto.**</span>
<span id="cb13-5"><a href="#cb13-5"></a></span>
<span id="cb13-6"><a href="#cb13-6"></a></span>
<span id="cb13-7"><a href="#cb13-7"></a>::: {.callout-important}</span>
<span id="cb13-8"><a href="#cb13-8"></a>This chapter has not yet been updated for 2025, so some material is out of date. Check back for an update in mid-February 2025.</span>
<span id="cb13-9"><a href="#cb13-9"></a>:::</span>
<span id="cb13-10"><a href="#cb13-10"></a></span>
<span id="cb13-11"><a href="#cb13-11"></a></span>
<span id="cb13-12"><a href="#cb13-12"></a><span class="in">```{r setup}</span></span>
<span id="cb13-13"><a href="#cb13-13"></a><span class="in">#| echo: false</span></span>
<span id="cb13-14"><a href="#cb13-14"></a><span class="in">#| include: false</span></span>
<span id="cb13-15"><a href="#cb13-15"></a></span>
<span id="cb13-16"><a href="#cb13-16"></a><span class="in">source(here::here("mask_learnr_functions.R"))</span></span>
<span id="cb13-17"><a href="#cb13-17"></a></span>
<span id="cb13-18"><a href="#cb13-18"></a><span class="in"># Load packages</span></span>
<span id="cb13-19"><a href="#cb13-19"></a><span class="in">library(sf)</span></span>
<span id="cb13-20"><a href="#cb13-20"></a><span class="in">library(tidyverse)</span></span>
<span id="cb13-21"><a href="#cb13-21"></a><span class="in">```</span></span>
<span id="cb13-22"><a href="#cb13-22"></a></span>
<span id="cb13-23"><a href="#cb13-23"></a><span class="fu">## Introduction</span></span>
<span id="cb13-24"><a href="#cb13-24"></a></span>
<span id="cb13-25"><a href="#cb13-25"></a>We already know how to produce useful maps in R so that people can use them to</span>
<span id="cb13-26"><a href="#cb13-26"></a>make decisions about understanding and responding to crime problems. But maps </span>
<span id="cb13-27"><a href="#cb13-27"></a>are only one part of most spatial analysis. In practice, maps are usually</span>
<span id="cb13-28"><a href="#cb13-28"></a>part of a larger report in which you as an analyst will explain what your maps</span>
<span id="cb13-29"><a href="#cb13-29"></a>show and perhaps make recommendations about what decisions people should make.</span>
<span id="cb13-30"><a href="#cb13-30"></a></span>
<span id="cb13-31"><a href="#cb13-31"></a>You are probably used to creating graphics in one piece of software (such as a</span>
<span id="cb13-32"><a href="#cb13-32"></a>map in R or a chart in Excel) and then importing or pasting those graphics into</span>
<span id="cb13-33"><a href="#cb13-33"></a>another program (such as Word) to including them in a written report. This way</span>
<span id="cb13-34"><a href="#cb13-34"></a>of working is often fine, but it has some shortcomings. For example, if you want</span>
<span id="cb13-35"><a href="#cb13-35"></a>to make a change to a graphic (maybe to correct a typo), you then have to import</span>
<span id="cb13-36"><a href="#cb13-36"></a>it into your writing program again. More importantly, it can become hard to keep</span>
<span id="cb13-37"><a href="#cb13-37"></a>track of which version of a graphic you need to import and you may end up </span>
<span id="cb13-38"><a href="#cb13-38"></a>including the wrong version of a file. </span>
<span id="cb13-39"><a href="#cb13-39"></a></span>
<span id="cb13-40"><a href="#cb13-40"></a>The same problem applies to numbers that you might calculate in statistical</span>
<span id="cb13-41"><a href="#cb13-41"></a>software such as R. You might calculate a statistic such as the mean number of </span>
<span id="cb13-42"><a href="#cb13-42"></a>burglaries in local council wards, then paste the result into Word to include it</span>
<span id="cb13-43"><a href="#cb13-43"></a>in your report. But if you then realise later on that there is a problem with</span>
<span id="cb13-44"><a href="#cb13-44"></a>your data and re-run your code, it would be very easy (especially in a long </span>
<span id="cb13-45"><a href="#cb13-45"></a>report) to forget that you needed to update the mean value presented in the</span>
<span id="cb13-46"><a href="#cb13-46"></a>report. The risk of making errors like this is particularly high if you are </span>
<span id="cb13-47"><a href="#cb13-47"></a>asked to update an existing report based on new data. Perhaps the worst aspect</span>
<span id="cb13-48"><a href="#cb13-48"></a>of this problem is that you will never know if the numbers in your final report</span>
<span id="cb13-49"><a href="#cb13-49"></a>are correct, unless you go back and check every one of them in whatever program</span>
<span id="cb13-50"><a href="#cb13-50"></a>you used to generate the numbers in the first place.</span>
<span id="cb13-51"><a href="#cb13-51"></a></span>
<span id="cb13-52"><a href="#cb13-52"></a>We can describe this risk of a report containing obsolete charts or incorrect</span>
<span id="cb13-53"><a href="#cb13-53"></a>statistics by saying that is is not *reproducible* -- if we were asked to go </span>
<span id="cb13-54"><a href="#cb13-54"></a>back and demonstrate each stage in producing the report to prove that we had</span>
<span id="cb13-55"><a href="#cb13-55"></a>done everything correctly, it would be very hard to do so. This is important </span>
<span id="cb13-56"><a href="#cb13-56"></a>because the reports that analysts write about crime are so often used to make</span>
<span id="cb13-57"><a href="#cb13-57"></a>decisions about how to respond to crime. An error in copying and pasting a </span>
<span id="cb13-58"><a href="#cb13-58"></a>number from R or Excel into Word could lead to police officers being deployed to</span>
<span id="cb13-59"><a href="#cb13-59"></a>the wrong place, or the wrong local council being given funding to install</span>
<span id="cb13-60"><a href="#cb13-60"></a>crime-prevention measures.</span>
<span id="cb13-61"><a href="#cb13-61"></a></span>
<span id="cb13-62"><a href="#cb13-62"></a>In this tutorial we will learn to use a tool called *Quarto* to write reports</span>
<span id="cb13-63"><a href="#cb13-63"></a>directly in RStudio, integrating data, maps and statistics directly into reports</span>
<span id="cb13-64"><a href="#cb13-64"></a>so that they are always up-to-date. Quarto can be used to produce detailed and </span>
<span id="cb13-65"><a href="#cb13-65"></a>polished reports in a way that makes sure they are always up to date. For</span>
<span id="cb13-66"><a href="#cb13-66"></a>example, the report </span>
<span id="cb13-67"><a href="#cb13-67"></a><span class="co">[</span><span class="ot">*Stop and Search in London*</span><span class="co">](https://discovery.ucl.ac.uk/id/eprint/10115766/1/2020-Q3.pdf)</span></span>
<span id="cb13-68"><a href="#cb13-68"></a>was created entirely in Quarto.</span>
<span id="cb13-69"><a href="#cb13-69"></a></span>
<span id="cb13-70"><a href="#cb13-70"></a>&lt;p class="centered-image"&gt;&lt;img src="images/quarto_process.png" alt="A schematic representing the multi-language input (e.g. Python, R, Observable, Julia) and multi-format output (e.g. PDF, html, Word documents, and more) versatility of Quarto."&gt;&lt;/p&gt;</span>
<span id="cb13-71"><a href="#cb13-71"></a></span>
<span id="cb13-72"><a href="#cb13-72"></a></span>
<span id="cb13-73"><a href="#cb13-73"></a></span>
<span id="cb13-74"><a href="#cb13-74"></a><span class="fu">## Markdown</span></span>
<span id="cb13-75"><a href="#cb13-75"></a></span>
<span id="cb13-76"><a href="#cb13-76"></a>*Markdown* is a way of formatting plain text so that a computer can convert it</span>
<span id="cb13-77"><a href="#cb13-77"></a>into different file formats. For example, RStudio can convert Markdown documents</span>
<span id="cb13-78"><a href="#cb13-78"></a>into Word, PDF, PowerPoint and many other formats. </span>
<span id="cb13-79"><a href="#cb13-79"></a></span>
<span id="cb13-80"><a href="#cb13-80"></a></span>
<span id="cb13-81"><a href="#cb13-81"></a><span class="in">```{r markdown-flowchart, echo=FALSE, eval=FALSE}</span></span>
<span id="cb13-82"><a href="#cb13-82"></a><span class="in">library(Gmisc)</span></span>
<span id="cb13-83"><a href="#cb13-83"></a></span>
<span id="cb13-84"><a href="#cb13-84"></a><span class="in">box_markdown &lt;- boxGrob(</span></span>
<span id="cb13-85"><a href="#cb13-85"></a><span class="in">  "a Markdown\ndocument",</span></span>
<span id="cb13-86"><a href="#cb13-86"></a><span class="in">  x = unit(0.2, "npc"),</span></span>
<span id="cb13-87"><a href="#cb13-87"></a><span class="in">  bjust = "right"</span></span>
<span id="cb13-88"><a href="#cb13-88"></a><span class="in">)</span></span>
<span id="cb13-89"><a href="#cb13-89"></a><span class="in">box_rstudio &lt;- boxGrob("… can be processed\nby RStudio into …")</span></span>
<span id="cb13-90"><a href="#cb13-90"></a><span class="in">box_word &lt;- boxGrob(</span></span>
<span id="cb13-91"><a href="#cb13-91"></a><span class="in">  "Word",</span></span>
<span id="cb13-92"><a href="#cb13-92"></a><span class="in">  x = unit(0.8, "npc"),</span></span>
<span id="cb13-93"><a href="#cb13-93"></a><span class="in">  y = unit(0.8, "npc"),</span></span>
<span id="cb13-94"><a href="#cb13-94"></a><span class="in">  width = unit(0.15, "npc"),</span></span>
<span id="cb13-95"><a href="#cb13-95"></a><span class="in">  bjust = "left"</span></span>
<span id="cb13-96"><a href="#cb13-96"></a><span class="in">)</span></span>
<span id="cb13-97"><a href="#cb13-97"></a><span class="in">box_pdf &lt;- boxGrob(</span></span>
<span id="cb13-98"><a href="#cb13-98"></a><span class="in">  "PDF",</span></span>
<span id="cb13-99"><a href="#cb13-99"></a><span class="in">  x = unit(0.8, "npc"),</span></span>
<span id="cb13-100"><a href="#cb13-100"></a><span class="in">  y = unit(0.65, "npc"),</span></span>
<span id="cb13-101"><a href="#cb13-101"></a><span class="in">  width = unit(0.15, "npc"),</span></span>
<span id="cb13-102"><a href="#cb13-102"></a><span class="in">  bjust = "left"</span></span>
<span id="cb13-103"><a href="#cb13-103"></a><span class="in">)</span></span>
<span id="cb13-104"><a href="#cb13-104"></a><span class="in">box_pp &lt;- boxGrob(</span></span>
<span id="cb13-105"><a href="#cb13-105"></a><span class="in">  "PowerPoint",</span></span>
<span id="cb13-106"><a href="#cb13-106"></a><span class="in">  x = unit(0.8, "npc"),</span></span>
<span id="cb13-107"><a href="#cb13-107"></a><span class="in">  y = unit(0.5, "npc"),</span></span>
<span id="cb13-108"><a href="#cb13-108"></a><span class="in">  width = unit(0.15, "npc"),</span></span>
<span id="cb13-109"><a href="#cb13-109"></a><span class="in">  bjust = "left"</span></span>
<span id="cb13-110"><a href="#cb13-110"></a><span class="in">)</span></span>
<span id="cb13-111"><a href="#cb13-111"></a><span class="in">box_web &lt;- boxGrob(</span></span>
<span id="cb13-112"><a href="#cb13-112"></a><span class="in">  "web page",</span></span>
<span id="cb13-113"><a href="#cb13-113"></a><span class="in">  x = unit(0.8, "npc"),</span></span>
<span id="cb13-114"><a href="#cb13-114"></a><span class="in">  y = unit(0.35, "npc"),</span></span>
<span id="cb13-115"><a href="#cb13-115"></a><span class="in">  width = unit(0.15, "npc"),</span></span>
<span id="cb13-116"><a href="#cb13-116"></a><span class="in">  bjust = "left"</span></span>
<span id="cb13-117"><a href="#cb13-117"></a><span class="in">)</span></span>
<span id="cb13-118"><a href="#cb13-118"></a><span class="in">box_other &lt;- boxGrob(</span></span>
<span id="cb13-119"><a href="#cb13-119"></a><span class="in">  "other formats",</span></span>
<span id="cb13-120"><a href="#cb13-120"></a><span class="in">  x = unit(0.8, "npc"),</span></span>
<span id="cb13-121"><a href="#cb13-121"></a><span class="in">  y = unit(0.2, "npc"),</span></span>
<span id="cb13-122"><a href="#cb13-122"></a><span class="in">  width = unit(0.15, "npc"),</span></span>
<span id="cb13-123"><a href="#cb13-123"></a><span class="in">  bjust = "left"</span></span>
<span id="cb13-124"><a href="#cb13-124"></a><span class="in">)</span></span>
<span id="cb13-125"><a href="#cb13-125"></a></span>
<span id="cb13-126"><a href="#cb13-126"></a><span class="in">arw &lt;- arrow(type = "open")</span></span>
<span id="cb13-127"><a href="#cb13-127"></a></span>
<span id="cb13-128"><a href="#cb13-128"></a><span class="in"># create file</span></span>
<span id="cb13-129"><a href="#cb13-129"></a><span class="in">png(</span></span>
<span id="cb13-130"><a href="#cb13-130"></a><span class="in">  here::here("inst/tutorials/14_writing_reports/images/markdown_flowchart.png"),</span></span>
<span id="cb13-131"><a href="#cb13-131"></a><span class="in">  width = 800,</span></span>
<span id="cb13-132"><a href="#cb13-132"></a><span class="in">  height = 300,</span></span>
<span id="cb13-133"><a href="#cb13-133"></a><span class="in">  units = "px"</span></span>
<span id="cb13-134"><a href="#cb13-134"></a><span class="in">)</span></span>
<span id="cb13-135"><a href="#cb13-135"></a></span>
<span id="cb13-136"><a href="#cb13-136"></a><span class="in"># create new page</span></span>
<span id="cb13-137"><a href="#cb13-137"></a><span class="in">grid::grid.newpage()</span></span>
<span id="cb13-138"><a href="#cb13-138"></a></span>
<span id="cb13-139"><a href="#cb13-139"></a><span class="in"># print connections</span></span>
<span id="cb13-140"><a href="#cb13-140"></a><span class="in">connectGrob(box_markdown, box_rstudio, type = "horizontal", arrow_obj = arw)</span></span>
<span id="cb13-141"><a href="#cb13-141"></a><span class="in">connectGrob(box_rstudio, box_word, type = "Z", arrow_obj = arw)</span></span>
<span id="cb13-142"><a href="#cb13-142"></a><span class="in">connectGrob(box_rstudio, box_pdf, type = "Z", arrow_obj = arw)</span></span>
<span id="cb13-143"><a href="#cb13-143"></a><span class="in">connectGrob(box_rstudio, box_pp, type = "Z", arrow_obj = arw)</span></span>
<span id="cb13-144"><a href="#cb13-144"></a><span class="in">connectGrob(box_rstudio, box_web, type = "Z", arrow_obj = arw)</span></span>
<span id="cb13-145"><a href="#cb13-145"></a><span class="in">connectGrob(box_rstudio, box_other, type = "Z", arrow_obj = arw)</span></span>
<span id="cb13-146"><a href="#cb13-146"></a></span>
<span id="cb13-147"><a href="#cb13-147"></a><span class="in"># print boxes</span></span>
<span id="cb13-148"><a href="#cb13-148"></a><span class="in">box_markdown</span></span>
<span id="cb13-149"><a href="#cb13-149"></a><span class="in">box_rstudio</span></span>
<span id="cb13-150"><a href="#cb13-150"></a><span class="in">box_word</span></span>
<span id="cb13-151"><a href="#cb13-151"></a><span class="in">box_pdf</span></span>
<span id="cb13-152"><a href="#cb13-152"></a><span class="in">box_pp</span></span>
<span id="cb13-153"><a href="#cb13-153"></a><span class="in">box_web</span></span>
<span id="cb13-154"><a href="#cb13-154"></a><span class="in">box_other</span></span>
<span id="cb13-155"><a href="#cb13-155"></a></span>
<span id="cb13-156"><a href="#cb13-156"></a><span class="in"># write plot to file</span></span>
<span id="cb13-157"><a href="#cb13-157"></a><span class="in">dev.off()</span></span>
<span id="cb13-158"><a href="#cb13-158"></a><span class="in">```</span></span>
<span id="cb13-159"><a href="#cb13-159"></a></span>
<span id="cb13-160"><a href="#cb13-160"></a></span>
<span id="cb13-161"><a href="#cb13-161"></a>&lt;p class="full-width-image"&gt;&lt;img src="images/markdown_flowchart.png" alt="Flow chart showing that a Markdown document can be processed by RStudio into Word, PDF, PowerPoint, web or other formats"&gt;&lt;/p&gt;</span>
<span id="cb13-162"><a href="#cb13-162"></a></span>
<span id="cb13-163"><a href="#cb13-163"></a>Markdown uses plain-text characters to represent formatting such as titles, </span>
<span id="cb13-164"><a href="#cb13-164"></a>italic text and so on. For example, the Markdown text:</span>
<span id="cb13-165"><a href="#cb13-165"></a></span>
<span id="cb13-166"><a href="#cb13-166"></a><span class="in">```lang-md</span></span>
<span id="cb13-167"><a href="#cb13-167"></a><span class="in"># Introduction</span></span>
<span id="cb13-168"><a href="#cb13-168"></a></span>
<span id="cb13-169"><a href="#cb13-169"></a><span class="in">In this tutorial we will learn to use a tool called *Quarto* to write reports directly in RStudio.</span></span>
<span id="cb13-170"><a href="#cb13-170"></a><span class="in">```</span></span>
<span id="cb13-171"><a href="#cb13-171"></a></span>
<span id="cb13-172"><a href="#cb13-172"></a>produces the output:</span>
<span id="cb13-173"><a href="#cb13-173"></a></span>
<span id="cb13-174"><a href="#cb13-174"></a></span>
<span id="cb13-175"><a href="#cb13-175"></a>::: {.faux-markdown}</span>
<span id="cb13-176"><a href="#cb13-176"></a></span>
<span id="cb13-177"><a href="#cb13-177"></a>&lt;h1&gt;Introduction&lt;/h1&gt;</span>
<span id="cb13-178"><a href="#cb13-178"></a></span>
<span id="cb13-179"><a href="#cb13-179"></a>&lt;p&gt;In this tutorial we will learn to use a tool called &lt;em&gt;Quarto&lt;/em&gt; to </span>
<span id="cb13-180"><a href="#cb13-180"></a>write reports directly in RStudio.&lt;/p&gt;</span>
<span id="cb13-181"><a href="#cb13-181"></a></span>
<span id="cb13-182"><a href="#cb13-182"></a>:::</span>
<span id="cb13-183"><a href="#cb13-183"></a></span>
<span id="cb13-184"><a href="#cb13-184"></a></span>
<span id="cb13-185"><a href="#cb13-185"></a>In this example, the character <span class="in">`#`</span> followed by a space at the start of a line </span>
<span id="cb13-186"><a href="#cb13-186"></a>mean that line should be shown as a first-level heading and the asterisks (<span class="in">`*`</span> </span>
<span id="cb13-187"><a href="#cb13-187"></a>-- we could also have used the underscore character <span class="in">`_`</span>) around the word </span>
<span id="cb13-188"><a href="#cb13-188"></a><span class="in">`Quarto`</span> indicate that it should be emphasised (typically with *italic* </span>
<span id="cb13-189"><a href="#cb13-189"></a>text).</span>
<span id="cb13-190"><a href="#cb13-190"></a></span>
<span id="cb13-191"><a href="#cb13-191"></a></span>
<span id="cb13-192"><a href="#cb13-192"></a>::: {.box .notewell}</span>
<span id="cb13-193"><a href="#cb13-193"></a></span>
<span id="cb13-194"><a href="#cb13-194"></a>In Markdown we use the hash character <span class="in">`#`</span> followed by a space to indicate that a </span>
<span id="cb13-195"><a href="#cb13-195"></a>line should be formatted as a top-level heading. The space after the <span class="in">`#`</span> is</span>
<span id="cb13-196"><a href="#cb13-196"></a>important – if you write <span class="in">`#Introduction`</span> instead of <span class="in">`# Introduction`</span> then R will</span>
<span id="cb13-197"><a href="#cb13-197"></a>not recognise that line as representing a heading and it will not be formatted</span>
<span id="cb13-198"><a href="#cb13-198"></a>properly.</span>
<span id="cb13-199"><a href="#cb13-199"></a></span>
<span id="cb13-200"><a href="#cb13-200"></a>:::</span>
<span id="cb13-201"><a href="#cb13-201"></a></span>
<span id="cb13-202"><a href="#cb13-202"></a></span>
<span id="cb13-203"><a href="#cb13-203"></a>Markdown is designed to be easy to read and easy to write. It is perfectly </span>
<span id="cb13-204"><a href="#cb13-204"></a>possible, for example, to read the unformatted Markdown text in the example </span>
<span id="cb13-205"><a href="#cb13-205"></a>above. Since Markdown files (which have the file extension <span class="in">`.md`</span>) are plain </span>
<span id="cb13-206"><a href="#cb13-206"></a>text, it's also possible to open them on virtually any computer. Markdown is</span>
<span id="cb13-207"><a href="#cb13-207"></a>very widely used on the web -- using underscores to mark out italic text </span>
<span id="cb13-208"><a href="#cb13-208"></a>and asterisks to mark out bold text even works in messaging apps such as </span>
<span id="cb13-209"><a href="#cb13-209"></a>Telegram and WhatsApp.</span>
<span id="cb13-210"><a href="#cb13-210"></a></span>
<span id="cb13-211"><a href="#cb13-211"></a>In Markdown you describe the *structure* of a document, not its appearance. The </span>
<span id="cb13-212"><a href="#cb13-212"></a>appearance of the document (which fonts it uses, what margins the pages have and</span>
<span id="cb13-213"><a href="#cb13-213"></a>so on) are determined by the templates that RStudio uses to convert markdown</span>
<span id="cb13-214"><a href="#cb13-214"></a>files into documents of different types. This can save you a lot of time, </span>
<span id="cb13-215"><a href="#cb13-215"></a>because you don't need to specify fonts and other formatting. Instead, you can</span>
<span id="cb13-216"><a href="#cb13-216"></a>concentrate on the structure of your argument rather than the details of</span>
<span id="cb13-217"><a href="#cb13-217"></a>formatting. </span>
<span id="cb13-218"><a href="#cb13-218"></a></span>
<span id="cb13-219"><a href="#cb13-219"></a>You can create your own templates for documents (for example if you want to </span>
<span id="cb13-220"><a href="#cb13-220"></a>create documents that match a particular corporate style) but in this course we </span>
<span id="cb13-221"><a href="#cb13-221"></a>will use the templates built into RStudio, which are designed to create </span>
<span id="cb13-222"><a href="#cb13-222"></a>documents that communicate data effectively.</span>
<span id="cb13-223"><a href="#cb13-223"></a></span>
<span id="cb13-224"><a href="#cb13-224"></a></span>
<span id="cb13-225"><a href="#cb13-225"></a></span>
<span id="cb13-226"><a href="#cb13-226"></a><span class="fu">### Markdown document structure</span></span>
<span id="cb13-227"><a href="#cb13-227"></a></span>
<span id="cb13-228"><a href="#cb13-228"></a>To create paragraphs in Markdown, you simply split text with a blank line. So</span>
<span id="cb13-229"><a href="#cb13-229"></a>this Markdown text:</span>
<span id="cb13-230"><a href="#cb13-230"></a></span>
<span id="cb13-231"><a href="#cb13-231"></a><span class="in">```lang-md</span></span>
<span id="cb13-232"><a href="#cb13-232"></a><span class="in">In this tutorial we will learn to use a tool called _Quarto_ to write reports directly in RStudio.</span></span>
<span id="cb13-233"><a href="#cb13-233"></a><span class="in">Markdown is a way of formatting plain text so that a computer can convert it into different file formats.</span></span>
<span id="cb13-234"><a href="#cb13-234"></a><span class="in">```</span></span>
<span id="cb13-235"><a href="#cb13-235"></a></span>
<span id="cb13-236"><a href="#cb13-236"></a>produces the output:</span>
<span id="cb13-237"><a href="#cb13-237"></a></span>
<span id="cb13-238"><a href="#cb13-238"></a></span>
<span id="cb13-239"><a href="#cb13-239"></a>::: {.faux-markdown}</span>
<span id="cb13-240"><a href="#cb13-240"></a></span>
<span id="cb13-241"><a href="#cb13-241"></a>In this tutorial we will learn to use a tool called _Quarto_ to write reports</span>
<span id="cb13-242"><a href="#cb13-242"></a>directly in RStudio.</span>
<span id="cb13-243"><a href="#cb13-243"></a>Markdown is a way of formatting plain text so that a computer can convert it</span>
<span id="cb13-244"><a href="#cb13-244"></a>into different file formats.</span>
<span id="cb13-245"><a href="#cb13-245"></a></span>
<span id="cb13-246"><a href="#cb13-246"></a>:::</span>
<span id="cb13-247"><a href="#cb13-247"></a></span>
<span id="cb13-248"><a href="#cb13-248"></a></span>
<span id="cb13-249"><a href="#cb13-249"></a>because there is no blank line between the first and second sentences. We can</span>
<span id="cb13-250"><a href="#cb13-250"></a>split this into two paragraphs just by adding a blank line:</span>
<span id="cb13-251"><a href="#cb13-251"></a></span>
<span id="cb13-252"><a href="#cb13-252"></a><span class="in">```lang-md</span></span>
<span id="cb13-253"><a href="#cb13-253"></a><span class="in">In this tutorial we will learn to use a tool called _Quarto_ to write reports directly in RStudio.</span></span>
<span id="cb13-254"><a href="#cb13-254"></a></span>
<span id="cb13-255"><a href="#cb13-255"></a><span class="in">Markdown is a way of formatting plain text so that a computer can convert it into different file formats.</span></span>
<span id="cb13-256"><a href="#cb13-256"></a><span class="in">```</span></span>
<span id="cb13-257"><a href="#cb13-257"></a></span>
<span id="cb13-258"><a href="#cb13-258"></a>which produces the output:</span>
<span id="cb13-259"><a href="#cb13-259"></a></span>
<span id="cb13-260"><a href="#cb13-260"></a></span>
<span id="cb13-261"><a href="#cb13-261"></a>::: {.faux-markdown}</span>
<span id="cb13-262"><a href="#cb13-262"></a></span>
<span id="cb13-263"><a href="#cb13-263"></a>In this tutorial we will learn to use a tool called _Quarto_ to write reports</span>
<span id="cb13-264"><a href="#cb13-264"></a>directly in RStudio.</span>
<span id="cb13-265"><a href="#cb13-265"></a></span>
<span id="cb13-266"><a href="#cb13-266"></a>Markdown is a way of formatting plain text so that a computer can convert it</span>
<span id="cb13-267"><a href="#cb13-267"></a>into different file formats.</span>
<span id="cb13-268"><a href="#cb13-268"></a></span>
<span id="cb13-269"><a href="#cb13-269"></a>:::</span>
<span id="cb13-270"><a href="#cb13-270"></a></span>
<span id="cb13-271"><a href="#cb13-271"></a></span>
<span id="cb13-272"><a href="#cb13-272"></a><span class="fu">#### Headings</span></span>
<span id="cb13-273"><a href="#cb13-273"></a></span>
<span id="cb13-274"><a href="#cb13-274"></a>There are six levels of headings available in Markdown documents, although it is</span>
<span id="cb13-275"><a href="#cb13-275"></a>very unlikely that you will need all six. Headings are specified by adding one </span>
<span id="cb13-276"><a href="#cb13-276"></a>or more <span class="in">`#`</span> characters to the start of the line, followed by a space:</span>
<span id="cb13-277"><a href="#cb13-277"></a></span>
<span id="cb13-278"><a href="#cb13-278"></a><span class="in">```lang-md</span></span>
<span id="cb13-279"><a href="#cb13-279"></a><span class="in"># First-level heading</span></span>
<span id="cb13-280"><a href="#cb13-280"></a></span>
<span id="cb13-281"><a href="#cb13-281"></a><span class="in">## Second-level heading</span></span>
<span id="cb13-282"><a href="#cb13-282"></a></span>
<span id="cb13-283"><a href="#cb13-283"></a><span class="in">### Third-level heading</span></span>
<span id="cb13-284"><a href="#cb13-284"></a><span class="in">```</span></span>
<span id="cb13-285"><a href="#cb13-285"></a></span>
<span id="cb13-286"><a href="#cb13-286"></a>produces:</span>
<span id="cb13-287"><a href="#cb13-287"></a></span>
<span id="cb13-288"><a href="#cb13-288"></a></span>
<span id="cb13-289"><a href="#cb13-289"></a>::: {.faux-markdown}</span>
<span id="cb13-290"><a href="#cb13-290"></a></span>
<span id="cb13-291"><a href="#cb13-291"></a>&lt;h1&gt;First-level heading&lt;/h1&gt;</span>
<span id="cb13-292"><a href="#cb13-292"></a></span>
<span id="cb13-293"><a href="#cb13-293"></a>&lt;h2&gt;Second-level heading&lt;/h2&gt;</span>
<span id="cb13-294"><a href="#cb13-294"></a></span>
<span id="cb13-295"><a href="#cb13-295"></a>&lt;h3&gt;Third-level heading&lt;/h3&gt;</span>
<span id="cb13-296"><a href="#cb13-296"></a></span>
<span id="cb13-297"><a href="#cb13-297"></a>:::</span>
<span id="cb13-298"><a href="#cb13-298"></a></span>
<span id="cb13-299"><a href="#cb13-299"></a></span>
<span id="cb13-300"><a href="#cb13-300"></a>Headings should have at least one blank line above and below them, so that they</span>
<span id="cb13-301"><a href="#cb13-301"></a>stand out from the surrounding code. I usually leave three blank lines before a</span>
<span id="cb13-302"><a href="#cb13-302"></a>second-level heading and two blank lines before other headings, with exactly one</span>
<span id="cb13-303"><a href="#cb13-303"></a>blank line after every type of heading.</span>
<span id="cb13-304"><a href="#cb13-304"></a></span>
<span id="cb13-305"><a href="#cb13-305"></a></span>
<span id="cb13-306"><a href="#cb13-306"></a>::: {.box .notewell}</span>
<span id="cb13-307"><a href="#cb13-307"></a></span>
<span id="cb13-308"><a href="#cb13-308"></a>Remember that Markdown describes the *structure* of a document, not its </span>
<span id="cb13-309"><a href="#cb13-309"></a>appearance, so you should not choose a heading level based on what size of text</span>
<span id="cb13-310"><a href="#cb13-310"></a>it produces in a particular output format. It is often best to save the </span>
<span id="cb13-311"><a href="#cb13-311"></a>first-level heading for your document title, so break the document up into </span>
<span id="cb13-312"><a href="#cb13-312"></a>sections by specifying second-level headings and then break those sections up</span>
<span id="cb13-313"><a href="#cb13-313"></a>into sub-sections with third-level headings etc.</span>
<span id="cb13-314"><a href="#cb13-314"></a></span>
<span id="cb13-315"><a href="#cb13-315"></a>:::</span>
<span id="cb13-316"><a href="#cb13-316"></a></span>
<span id="cb13-317"><a href="#cb13-317"></a></span>
<span id="cb13-318"><a href="#cb13-318"></a><span class="fu">#### Lists</span></span>
<span id="cb13-319"><a href="#cb13-319"></a></span>
<span id="cb13-320"><a href="#cb13-320"></a>Markdown supports two types of list: ordered lists and unordered lists. You can</span>
<span id="cb13-321"><a href="#cb13-321"></a>make an ordered list by putting each list item on a new line and starting each</span>
<span id="cb13-322"><a href="#cb13-322"></a>line with a number followed by a full stop (<span class="in">`.`</span>). You make an unordered list in</span>
<span id="cb13-323"><a href="#cb13-323"></a>the same way, but starting each line with an asterisk:</span>
<span id="cb13-324"><a href="#cb13-324"></a></span>
<span id="cb13-325"><a href="#cb13-325"></a><span class="in">```lang-md</span></span>
<span id="cb13-326"><a href="#cb13-326"></a><span class="in">1. A list of items</span></span>
<span id="cb13-327"><a href="#cb13-327"></a><span class="in">2. for which the ordering</span></span>
<span id="cb13-328"><a href="#cb13-328"></a><span class="in">3. of items is important</span></span>
<span id="cb13-329"><a href="#cb13-329"></a></span>
<span id="cb13-330"><a href="#cb13-330"></a><span class="in">* A list of items</span></span>
<span id="cb13-331"><a href="#cb13-331"></a><span class="in">* for which the ordering</span></span>
<span id="cb13-332"><a href="#cb13-332"></a><span class="in">* of items is *not* important</span></span>
<span id="cb13-333"><a href="#cb13-333"></a><span class="in">```</span></span>
<span id="cb13-334"><a href="#cb13-334"></a></span>
<span id="cb13-335"><a href="#cb13-335"></a>produces:</span>
<span id="cb13-336"><a href="#cb13-336"></a></span>
<span id="cb13-337"><a href="#cb13-337"></a></span>
<span id="cb13-338"><a href="#cb13-338"></a>::: {.faux-markdown}</span>
<span id="cb13-339"><a href="#cb13-339"></a></span>
<span id="cb13-340"><a href="#cb13-340"></a><span class="ss">1. </span>A list of items</span>
<span id="cb13-341"><a href="#cb13-341"></a><span class="ss">2. </span>for which the ordering</span>
<span id="cb13-342"><a href="#cb13-342"></a><span class="ss">3. </span>of items is important</span>
<span id="cb13-343"><a href="#cb13-343"></a></span>
<span id="cb13-344"><a href="#cb13-344"></a><span class="ss">* </span>A list of items</span>
<span id="cb13-345"><a href="#cb13-345"></a><span class="ss">* </span>for which the ordering</span>
<span id="cb13-346"><a href="#cb13-346"></a><span class="ss">* </span>of items is *not* important</span>
<span id="cb13-347"><a href="#cb13-347"></a></span>
<span id="cb13-348"><a href="#cb13-348"></a>:::</span>
<span id="cb13-349"><a href="#cb13-349"></a></span>
<span id="cb13-350"><a href="#cb13-350"></a></span>
<span id="cb13-351"><a href="#cb13-351"></a><span class="fu">#### Quotes</span></span>
<span id="cb13-352"><a href="#cb13-352"></a></span>
<span id="cb13-353"><a href="#cb13-353"></a>If you want to insert a quote into your Markdown document, you can do that by</span>
<span id="cb13-354"><a href="#cb13-354"></a>putting a greater-than (<span class="in">`&gt;`</span>) symbol followed by a space at the start of each</span>
<span id="cb13-355"><a href="#cb13-355"></a>line of the quote:</span>
<span id="cb13-356"><a href="#cb13-356"></a></span>
<span id="cb13-357"><a href="#cb13-357"></a><span class="in">```lang-md</span></span>
<span id="cb13-358"><a href="#cb13-358"></a><span class="in">&gt; In this tutorial we will learn to use a tool called _Quarto_ to write reports directly in RStudio.</span></span>
<span id="cb13-359"><a href="#cb13-359"></a><span class="in">```</span></span>
<span id="cb13-360"><a href="#cb13-360"></a></span>
<span id="cb13-361"><a href="#cb13-361"></a>produces </span>
<span id="cb13-362"><a href="#cb13-362"></a></span>
<span id="cb13-363"><a href="#cb13-363"></a></span>
<span id="cb13-364"><a href="#cb13-364"></a>::: {.faux-markdown}</span>
<span id="cb13-365"><a href="#cb13-365"></a></span>
<span id="cb13-366"><a href="#cb13-366"></a>&lt;blockquote&gt;</span>
<span id="cb13-367"><a href="#cb13-367"></a>In this tutorial we will learn to use a tool called _Quarto_ to write reports </span>
<span id="cb13-368"><a href="#cb13-368"></a>directly in RStudio.</span>
<span id="cb13-369"><a href="#cb13-369"></a>&lt;/blockquote&gt;</span>
<span id="cb13-370"><a href="#cb13-370"></a></span>
<span id="cb13-371"><a href="#cb13-371"></a>:::</span>
<span id="cb13-372"><a href="#cb13-372"></a></span>
<span id="cb13-373"><a href="#cb13-373"></a></span>
<span id="cb13-374"><a href="#cb13-374"></a><span class="fu">### Inline elements</span></span>
<span id="cb13-375"><a href="#cb13-375"></a></span>
<span id="cb13-376"><a href="#cb13-376"></a>As well as using Markdown to describe the structure of a document, you can use</span>
<span id="cb13-377"><a href="#cb13-377"></a>it to mark up particular text within a paragraph. We've already seen how to do </span>
<span id="cb13-378"><a href="#cb13-378"></a>this using <span class="in">`_to emphasise text_`</span> (usually displayed in _italics_). We can also </span>
<span id="cb13-379"><a href="#cb13-379"></a><span class="in">`**strongly emphasise**`</span> text, which will usually appear in **bold**. Note that</span>
<span id="cb13-380"><a href="#cb13-380"></a>the <span class="in">`_`</span>, <span class="in">`*`</span> or <span class="in">`**`</span> characters must be touching a word on exactly one side:</span>
<span id="cb13-381"><a href="#cb13-381"></a></span>
<span id="cb13-382"><a href="#cb13-382"></a><span class="ss">  * </span><span class="in">`some _emphasised_ text`</span> produces some _emphasised_ text</span>
<span id="cb13-383"><a href="#cb13-383"></a><span class="ss">  * </span><span class="in">`some_emphasised_text`</span> does not produce emphasised text</span>
<span id="cb13-384"><a href="#cb13-384"></a><span class="ss">  * </span><span class="in">`some _ emphasised _ text`</span> does not produce emphasised text</span>
<span id="cb13-385"><a href="#cb13-385"></a></span>
<span id="cb13-386"><a href="#cb13-386"></a>We can add links to a document using the format <span class="in">`[link text](URL)`</span>. For example,</span>
<span id="cb13-387"><a href="#cb13-387"></a>the text:</span>
<span id="cb13-388"><a href="#cb13-388"></a></span>
<span id="cb13-389"><a href="#cb13-389"></a><span class="in">```lang-md</span></span>
<span id="cb13-390"><a href="#cb13-390"></a><span class="in">[learn about the tidyverse](https://www.tidyverse.org/)</span></span>
<span id="cb13-391"><a href="#cb13-391"></a><span class="in">```</span></span>
<span id="cb13-392"><a href="#cb13-392"></a></span>
<span id="cb13-393"><a href="#cb13-393"></a>produces the link:</span>
<span id="cb13-394"><a href="#cb13-394"></a></span>
<span id="cb13-395"><a href="#cb13-395"></a></span>
<span id="cb13-396"><a href="#cb13-396"></a>::: {.faux-markdown}</span>
<span id="cb13-397"><a href="#cb13-397"></a></span>
<span id="cb13-398"><a href="#cb13-398"></a><span class="co">[</span><span class="ot">learn about the tidyverse</span><span class="co">](https://www.tidyverse.org/)</span></span>
<span id="cb13-399"><a href="#cb13-399"></a></span>
<span id="cb13-400"><a href="#cb13-400"></a>:::</span>
<span id="cb13-401"><a href="#cb13-401"></a></span>
<span id="cb13-402"><a href="#cb13-402"></a></span>
<span id="cb13-403"><a href="#cb13-403"></a>There are several other Markdown codes for describing different elements within</span>
<span id="cb13-404"><a href="#cb13-404"></a>a document, including images, videos and segments of code. You can find out more</span>
<span id="cb13-405"><a href="#cb13-405"></a>about what's possible with Markdown on the </span>
<span id="cb13-406"><a href="#cb13-406"></a><span class="co">[</span><span class="ot">Markdown Basics page of the Quarto website</span><span class="co">](https://quarto.org/docs/authoring/markdown-basics.html)</span>.</span>
<span id="cb13-407"><a href="#cb13-407"></a></span>
<span id="cb13-408"><a href="#cb13-408"></a></span>
<span id="cb13-409"><a href="#cb13-409"></a><span class="fu">### Processing Markdown in RStudio</span></span>
<span id="cb13-410"><a href="#cb13-410"></a></span>
<span id="cb13-411"><a href="#cb13-411"></a>Once you've written a Markdown document, you can convert it into a web page, a</span>
<span id="cb13-412"><a href="#cb13-412"></a>Word document or a PDF file from within RStudio. First, save your document with </span>
<span id="cb13-413"><a href="#cb13-413"></a>a <span class="in">`.md`</span> file extension -- this tells RStudio that the file is a Markdown </span>
<span id="cb13-414"><a href="#cb13-414"></a>document. You should now see a new button at the top of the RStudio script panel </span>
<span id="cb13-415"><a href="#cb13-415"></a>marked <span class="in">`Preview`</span>. </span>
<span id="cb13-416"><a href="#cb13-416"></a></span>
<span id="cb13-417"><a href="#cb13-417"></a>&lt;p class="centered-image"&gt;&lt;img src="images/rstudio-markdown-preview.png" alt="Screen shot of the Preview button in RStudio that allows converting Markdown documents to web pages, PDFs or Word documents."&gt;&lt;/p&gt;</span>
<span id="cb13-418"><a href="#cb13-418"></a></span>
<span id="cb13-419"><a href="#cb13-419"></a>If you click on the small downward-pointing triangle next to that button, you </span>
<span id="cb13-420"><a href="#cb13-420"></a>have the option to produce your report in </span>
<span id="cb13-421"><a href="#cb13-421"></a>&lt;abbr title="hypertext markup language"&gt;HTML&lt;/abbr&gt; (web page) format, PDF or </span>
<span id="cb13-422"><a href="#cb13-422"></a>Microsoft Word. HTML format is useful for creating documents to be published on </span>
<span id="cb13-423"><a href="#cb13-423"></a>the web, but also for quickly previewing documents in RStudio while you are </span>
<span id="cb13-424"><a href="#cb13-424"></a>working on them. Click on the relevant option to create the document in your</span>
<span id="cb13-425"><a href="#cb13-425"></a>format of choice.</span>
<span id="cb13-426"><a href="#cb13-426"></a></span>
<span id="cb13-427"><a href="#cb13-427"></a>You do not need to have Microsoft Word installed on your computer to produce </span>
<span id="cb13-428"><a href="#cb13-428"></a>Word documents from Markdown files in RStudio, although you will need Word (or</span>
<span id="cb13-429"><a href="#cb13-429"></a>other word-processing software) to view the file.</span>
<span id="cb13-430"><a href="#cb13-430"></a></span>
<span id="cb13-431"><a href="#cb13-431"></a>To create PDF files from Markdown in RStudio, your computer has to have a </span>
<span id="cb13-432"><a href="#cb13-432"></a>version of software called TeX installed. If you've never heard of TeX, you can</span>
<span id="cb13-433"><a href="#cb13-433"></a>install it automatically using the <span class="in">`tinytex`</span> R package. To install TeX, just run</span>
<span id="cb13-434"><a href="#cb13-434"></a>this R code _once_ on your computer:</span>
<span id="cb13-435"><a href="#cb13-435"></a></span>
<span id="cb13-436"><a href="#cb13-436"></a><span class="in">```r</span></span>
<span id="cb13-437"><a href="#cb13-437"></a><span class="fu">install.packages</span>(<span class="st">"tinytex"</span>)</span>
<span id="cb13-438"><a href="#cb13-438"></a>tinytex<span class="sc">::</span><span class="fu">install_tinytex</span>()</span>
<span id="cb13-439"><a href="#cb13-439"></a><span class="in">```</span></span>
<span id="cb13-440"><a href="#cb13-440"></a></span>
<span id="cb13-441"><a href="#cb13-441"></a>TeX should now be installed on your computer. After you have restarted RStudio</span>
<span id="cb13-442"><a href="#cb13-442"></a>you will be able to create PDFs from within RStudio.</span>
<span id="cb13-443"><a href="#cb13-443"></a></span>
<span id="cb13-444"><a href="#cb13-444"></a>::: {.box .notewell}</span>
<span id="cb13-445"><a href="#cb13-445"></a></span>
<span id="cb13-446"><a href="#cb13-446"></a>Note that you only have to install TeX once on each computer you use, so you</span>
<span id="cb13-447"><a href="#cb13-447"></a>should not include <span class="in">`tinytex::install_tinytex()`</span> in any Quarto scripts that</span>
<span id="cb13-448"><a href="#cb13-448"></a>you write.</span>
<span id="cb13-449"><a href="#cb13-449"></a></span>
<span id="cb13-450"><a href="#cb13-450"></a>:::</span>
<span id="cb13-451"><a href="#cb13-451"></a></span>
<span id="cb13-452"><a href="#cb13-452"></a></span>
<span id="cb13-453"><a href="#cb13-453"></a></span>
<span id="cb13-454"><a href="#cb13-454"></a><span class="fu">## Quarto</span></span>
<span id="cb13-455"><a href="#cb13-455"></a></span>
<span id="cb13-456"><a href="#cb13-456"></a>Markdown allows you to create static documents in RStudio. We can add all types</span>
<span id="cb13-457"><a href="#cb13-457"></a>of R output -- including maps, tables, charts and the results of calculations --</span>
<span id="cb13-458"><a href="#cb13-458"></a>to Markdown documents using *Quarto*, which is built into RStudio.</span>
<span id="cb13-459"><a href="#cb13-459"></a></span>
<span id="cb13-460"><a href="#cb13-460"></a>Quarto is a system that converts Markdown documents that contain chunks of code</span>
<span id="cb13-461"><a href="#cb13-461"></a>written in R or Python, runs the code and then integrates the Markdown text and</span>
<span id="cb13-462"><a href="#cb13-462"></a>the code results into one or more output files. Quarto can produce web pages,</span>
<span id="cb13-463"><a href="#cb13-463"></a>Word documents, PDF files, presentations, websites, e-books and other formats.</span>
<span id="cb13-464"><a href="#cb13-464"></a></span>
<span id="cb13-465"><a href="#cb13-465"></a>A Quarto file is just like a Markdown document except that it has the file</span>
<span id="cb13-466"><a href="#cb13-466"></a>extension <span class="in">`.qmd`</span> rather than the extension <span class="in">`.md`</span>. The <span class="in">`.qmd`</span> extension tells </span>
<span id="cb13-467"><a href="#cb13-467"></a>RStudio that a file will contain a mixture of text formatted with Markdown and</span>
<span id="cb13-468"><a href="#cb13-468"></a>code that produces tables, charts and so on.</span>
<span id="cb13-469"><a href="#cb13-469"></a></span>
<span id="cb13-470"><a href="#cb13-470"></a>Since Quarto can produce many types of document, RStudio has a dialogue box in</span>
<span id="cb13-471"><a href="#cb13-471"></a>which you can select from all the installed Quarto templates. Click on the </span>
<span id="cb13-472"><a href="#cb13-472"></a>'new file' button in the top-left corner of the RStudio window and then on</span>
<span id="cb13-473"><a href="#cb13-473"></a><span class="in">`Quarto Document…`</span></span>
<span id="cb13-474"><a href="#cb13-474"></a></span>
<span id="cb13-475"><a href="#cb13-475"></a>&lt;p class="centered-image"&gt;&lt;img src="images/rstudio-quarto-menu.png" alt="Screen shot of RStudio's menu for creating a new documents."&gt;&lt;/p&gt;</span>
<span id="cb13-476"><a href="#cb13-476"></a></span>
<span id="cb13-477"><a href="#cb13-477"></a>This will open a box containing all the Quarto templates that are installed</span>
<span id="cb13-478"><a href="#cb13-478"></a>on your computer. Some of these are installed by default and some may have been</span>
<span id="cb13-479"><a href="#cb13-479"></a>added by packages that you have installed.</span>
<span id="cb13-480"><a href="#cb13-480"></a></span>
<span id="cb13-481"><a href="#cb13-481"></a>&lt;p class="centered-image"&gt;&lt;img src="images/rstudio-new-quarto.png" alt="Screen shot of RStudio's dialogue box for creating a new Quarto document."&gt;&lt;/p&gt;</span>
<span id="cb13-482"><a href="#cb13-482"></a></span>
<span id="cb13-483"><a href="#cb13-483"></a>You can edit Quarto documents in two ways in RStudio. When you create a new</span>
<span id="cb13-484"><a href="#cb13-484"></a>Quarto document, RStudio will open it in the _Visual editor_. This allows you to</span>
<span id="cb13-485"><a href="#cb13-485"></a>write the text content of your document as you would in word-processing software</span>
<span id="cb13-486"><a href="#cb13-486"></a>such as Word. For example, you can make text bold using buttons on the tool bar</span>
<span id="cb13-487"><a href="#cb13-487"></a>at the top of the document, or using standard keyboard short-cuts such as </span>
<span id="cb13-488"><a href="#cb13-488"></a><span class="in">`Ctrl+B`</span> on Windows or <span class="in">`Command+B`</span> on Mac. There is also a _Source editor_, </span>
<span id="cb13-489"><a href="#cb13-489"></a>which allows you to edit the underlying Markdown formatted text directly. </span>
<span id="cb13-490"><a href="#cb13-490"></a></span>
<span id="cb13-491"><a href="#cb13-491"></a>In this tutorial we will use the Visual editor, but you can choose to use the</span>
<span id="cb13-492"><a href="#cb13-492"></a>Source editor if you prefer. To switch between the two editors, slick the </span>
<span id="cb13-493"><a href="#cb13-493"></a><span class="in">`Source`</span> or <span class="in">`Visual`</span> buttons at the left-hand end of the formatting tool bar at</span>
<span id="cb13-494"><a href="#cb13-494"></a>the top of the Quarto document window.</span>
<span id="cb13-495"><a href="#cb13-495"></a></span>
<span id="cb13-496"><a href="#cb13-496"></a>Whichever editor you use, Quarto documents start with a *header* that provides </span>
<span id="cb13-497"><a href="#cb13-497"></a>some basic information about the document, such as the title. A simple Quarto </span>
<span id="cb13-498"><a href="#cb13-498"></a>header looks like this:</span>
<span id="cb13-499"><a href="#cb13-499"></a></span>
<span id="cb13-500"><a href="#cb13-500"></a><span class="in">```yaml</span></span>
<span id="cb13-501"><a href="#cb13-501"></a><span class="pp">---</span></span>
<span id="cb13-502"><a href="#cb13-502"></a><span class="fu">title</span><span class="kw">:</span><span class="at">  </span><span class="st">"An Quarto document"</span></span>
<span id="cb13-503"><a href="#cb13-503"></a><span class="fu">author</span><span class="kw">:</span><span class="at"> </span><span class="st">"Joe Bloggs"</span></span>
<span id="cb13-504"><a href="#cb13-504"></a><span class="fu">date</span><span class="kw">:</span><span class="at">   </span><span class="st">"3 March 2021"</span></span>
<span id="cb13-505"><a href="#cb13-505"></a><span class="pp">---</span></span>
<span id="cb13-506"><a href="#cb13-506"></a><span class="in">```</span></span>
<span id="cb13-507"><a href="#cb13-507"></a></span>
<span id="cb13-508"><a href="#cb13-508"></a>The header is written in yet another programming language called </span>
<span id="cb13-509"><a href="#cb13-509"></a><span class="co">[</span><span class="ot">YAML</span><span class="co">](https://en.wikipedia.org/wiki/YAML)</span>. You don't need to know the details </span>
<span id="cb13-510"><a href="#cb13-510"></a>of YAML to write headers for Quarto documents. Two things you do need to know, </span>
<span id="cb13-511"><a href="#cb13-511"></a>though: </span>
<span id="cb13-512"><a href="#cb13-512"></a></span>
<span id="cb13-513"><a href="#cb13-513"></a><span class="ss">  * </span>The three dashes (<span class="in">`---`</span>) are important, because they tell RStudio that the </span>
<span id="cb13-514"><a href="#cb13-514"></a>    content inside the dashes is the document header. The dashes must appear at</span>
<span id="cb13-515"><a href="#cb13-515"></a>    the start of a line on their own.</span>
<span id="cb13-516"><a href="#cb13-516"></a><span class="ss">  * </span>Indentation matters in YAML. Every line takes the form <span class="in">`key: value`</span> and in </span>
<span id="cb13-517"><a href="#cb13-517"></a>    most cases the key must be at the very start of the line. Lines in YAML are</span>
<span id="cb13-518"><a href="#cb13-518"></a>    not limited to 80 characters, so you should not break a single value (such</span>
<span id="cb13-519"><a href="#cb13-519"></a>    as the document title) over multiple lines.</span>
<span id="cb13-520"><a href="#cb13-520"></a></span>
<span id="cb13-521"><a href="#cb13-521"></a></span>
<span id="cb13-522"><a href="#cb13-522"></a><span class="fu">### R code in Quarto</span></span>
<span id="cb13-523"><a href="#cb13-523"></a></span>
<span id="cb13-524"><a href="#cb13-524"></a>Quarto will process everything in an Quarto document after the header </span>
<span id="cb13-525"><a href="#cb13-525"></a>(marked with <span class="in">`---`</span>) as Markdown text. The only exception to this is when you</span>
<span id="cb13-526"><a href="#cb13-526"></a>include sections of code in an Quarto document.</span>
<span id="cb13-527"><a href="#cb13-527"></a></span>
<span id="cb13-528"><a href="#cb13-528"></a>You can include R code inside a line of Markdown text (known as *inline* code)</span>
<span id="cb13-529"><a href="#cb13-529"></a>and the result of that code will be included in the document output. To do this </span>
<span id="cb13-530"><a href="#cb13-530"></a>in the visual editor, you type a lower-case <span class="in">`r`</span> followed by a space, then the </span>
<span id="cb13-531"><a href="#cb13-531"></a>code you want to run. You then select the text from the letter <span class="in">`r`</span> to the end of</span>
<span id="cb13-532"><a href="#cb13-532"></a>the code, open the <span class="in">`Format`</span> menu in the Quarto tool bar and select <span class="in">`Code`</span></span>
<span id="cb13-533"><a href="#cb13-533"></a>(alternatively you can select the text and use the keyboard short-cut </span>
<span id="cb13-534"><a href="#cb13-534"></a><span class="in">`Command+D`</span> on Mac or <span class="in">`Ctrl+D`</span> on Windows).</span>
<span id="cb13-535"><a href="#cb13-535"></a></span>
<span id="cb13-536"><a href="#cb13-536"></a>For example, if you wanted to insert today's date into a Quarto document, you</span>
<span id="cb13-537"><a href="#cb13-537"></a>can type:</span>
<span id="cb13-538"><a href="#cb13-538"></a></span>
<span id="cb13-539"><a href="#cb13-539"></a>&lt;p class="centered-image"&gt;&lt;img src="images/quarto-inline-code.gif" alt="Animated screen shot of adding inline code to a Quarto document"&gt;&lt;/p&gt;</span>
<span id="cb13-540"><a href="#cb13-540"></a></span>
<span id="cb13-541"><a href="#cb13-541"></a>Which would produce the output:</span>
<span id="cb13-542"><a href="#cb13-542"></a></span>
<span id="cb13-543"><a href="#cb13-543"></a>&lt;p class="centered-image"&gt;&lt;img src="images/quarto-inline-code.png" alt="Screen shot of a Quarto document with the text 'This document was written on 3 March 2023'."&gt;&lt;/p&gt;</span>
<span id="cb13-544"><a href="#cb13-544"></a></span>
<span id="cb13-545"><a href="#cb13-545"></a>Putting R code inline is fine for simple pieces of code, but longer pieces of</span>
<span id="cb13-546"><a href="#cb13-546"></a>code included inline would become difficult to read (and therefore difficult to</span>
<span id="cb13-547"><a href="#cb13-547"></a>debug). Fortunately, we can put as much code as we like in a *code block*. To</span>
<span id="cb13-548"><a href="#cb13-548"></a>add a block of R code to an Quarto document, we open the <span class="in">`Insert`</span> menu on the</span>
<span id="cb13-549"><a href="#cb13-549"></a>Quarto tool bar, click <span class="in">`Code Chunk`</span> and then <span class="in">`R`</span>. You will then see a grey box</span>
<span id="cb13-550"><a href="#cb13-550"></a>appear at the point in your document where you had placed the cursor, with the</span>
<span id="cb13-551"><a href="#cb13-551"></a>text <span class="in">`{r}`</span> at the start of the box.</span>
<span id="cb13-552"><a href="#cb13-552"></a></span>
<span id="cb13-553"><a href="#cb13-553"></a>We can use code chunks to run longer pieces of code that would be difficult to</span>
<span id="cb13-554"><a href="#cb13-554"></a>read if the code were inline. For example, if you wanted to load a data file of</span>
<span id="cb13-555"><a href="#cb13-555"></a>crime data, filter it for crimes occurring in a particular month and then count</span>
<span id="cb13-556"><a href="#cb13-556"></a>the number of rows, you could do the calculation in a code chunk and then </span>
<span id="cb13-557"><a href="#cb13-557"></a>include the result inline:</span>
<span id="cb13-558"><a href="#cb13-558"></a></span>
<span id="cb13-559"><a href="#cb13-559"></a>&lt;p class="centered-image"&gt;&lt;img src="images/quarto-code-chunk.png" alt="Screen shot of an R code chunk in an Quarto document."&gt;&lt;/p&gt;</span>
<span id="cb13-560"><a href="#cb13-560"></a></span>
<span id="cb13-561"><a href="#cb13-561"></a>Note that to make the Quarto document more readable, RStudio has given the</span>
<span id="cb13-562"><a href="#cb13-562"></a>R code chunk a grey background, in contrast to the white background of the rest</span>
<span id="cb13-563"><a href="#cb13-563"></a>of the document. If a code chunk does not have a grey background, this is a good</span>
<span id="cb13-564"><a href="#cb13-564"></a>sign that there is something wrong: maybe you haven't saved the file with a </span>
<span id="cb13-565"><a href="#cb13-565"></a><span class="in">`.qmd`</span> file extension, or maybe you have not inserted the code block correctly.</span>
<span id="cb13-566"><a href="#cb13-566"></a></span>
<span id="cb13-567"><a href="#cb13-567"></a>Code chunks can also be used to insert tables and charts (including maps) into</span>
<span id="cb13-568"><a href="#cb13-568"></a>a Quarto document. To add a nicely formatted table of data, use the <span class="in">`kable()`</span> </span>
<span id="cb13-569"><a href="#cb13-569"></a>function from the <span class="in">`knitr`</span> library. For example:</span>
<span id="cb13-570"><a href="#cb13-570"></a></span>
<span id="cb13-571"><a href="#cb13-571"></a><span class="in">```r</span></span>
<span id="cb13-572"><a href="#cb13-572"></a><span class="co"># Print table of crime counts in each police division</span></span>
<span id="cb13-573"><a href="#cb13-573"></a>crimes <span class="sc">|&gt;</span> </span>
<span id="cb13-574"><a href="#cb13-574"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2021</span>, month <span class="sc">==</span> <span class="st">"February"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb13-575"><a href="#cb13-575"></a>  <span class="fu">count</span>(division) <span class="sc">|&gt;</span> </span>
<span id="cb13-576"><a href="#cb13-576"></a>  <span class="co"># We haven't loaded the `knitr` package, so we need to refer to the `kable()`</span></span>
<span id="cb13-577"><a href="#cb13-577"></a>  <span class="co"># function using the `::` operator</span></span>
<span id="cb13-578"><a href="#cb13-578"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb13-579"><a href="#cb13-579"></a><span class="in">```</span></span>
<span id="cb13-580"><a href="#cb13-580"></a></span>
<span id="cb13-581"><a href="#cb13-581"></a>We can also use code chunks to produce graphics. In this case, you just include</span>
<span id="cb13-582"><a href="#cb13-582"></a>the code to produce your map or chart in a code chunk as you normally would.</span>
<span id="cb13-583"><a href="#cb13-583"></a></span>
<span id="cb13-584"><a href="#cb13-584"></a>To help keep track of code chunks, we can name them. To name a code chunk, put a</span>
<span id="cb13-585"><a href="#cb13-585"></a>single space after the letter <span class="in">`r`</span> in the line that begins the chunk and then </span>
<span id="cb13-586"><a href="#cb13-586"></a>give the chunk name. Names can include letters, numbers and dashes (<span class="in">`-`</span>). For</span>
<span id="cb13-587"><a href="#cb13-587"></a>example, if we wanted to call the chunk above <span class="in">`count-all-crimes`</span> we would start</span>
<span id="cb13-588"><a href="#cb13-588"></a>the code chunk with the code <span class="in">`{r count-all-crimes}`</span>.</span>
<span id="cb13-589"><a href="#cb13-589"></a></span>
<span id="cb13-590"><a href="#cb13-590"></a>The package that converts Quarto documents into other formats is called <span class="in">`knitr`</span> </span>
<span id="cb13-591"><a href="#cb13-591"></a>-- actually, it's a bit more complicated than that, but one of the nice</span>
<span id="cb13-592"><a href="#cb13-592"></a>things about Quarto is you don't need to worry about what's happening behind</span>
<span id="cb13-593"><a href="#cb13-593"></a>the scenes.</span>
<span id="cb13-594"><a href="#cb13-594"></a></span>
<span id="cb13-595"><a href="#cb13-595"></a>&lt;p class="full-width-image"&gt;&lt;img src="images/knitr-process.png" alt="A schematic representing rendering of Quarto documents from .qmd, to knitr or jupyter, to plain text markdown, then converted by pandoc into any number of output types including html, PDF, or Word document."&gt;&lt;/p&gt;</span>
<span id="cb13-596"><a href="#cb13-596"></a></span>
<span id="cb13-597"><a href="#cb13-597"></a>The default Quarto template is set up so that the final document that is</span>
<span id="cb13-598"><a href="#cb13-598"></a>produced from your Quarto file will include both the code that you include in</span>
<span id="cb13-599"><a href="#cb13-599"></a>any code chunks *and* the output that the code produces. For example, this </span>
<span id="cb13-600"><a href="#cb13-600"></a>Quarto document:</span>
<span id="cb13-601"><a href="#cb13-601"></a></span>
<span id="cb13-602"><a href="#cb13-602"></a>&lt;p class="centered-image"&gt;&lt;img src="images/quarto-example-doc.png" alt="Screen shot of an example Quarto document containing a code chunk."&gt;&lt;/p&gt;</span>
<span id="cb13-603"><a href="#cb13-603"></a></span>
<span id="cb13-604"><a href="#cb13-604"></a>Produces this output, which is probably not what you want:</span>
<span id="cb13-605"><a href="#cb13-605"></a></span>
<span id="cb13-606"><a href="#cb13-606"></a>&lt;p class="centered-image image-border"&gt;&lt;img src="images/quarto-example-output.png" alt="Screen shot of the output from an example Quarto document showing code and chunk output."&gt;&lt;/p&gt;</span>
<span id="cb13-607"><a href="#cb13-607"></a></span>
<span id="cb13-608"><a href="#cb13-608"></a>We can control the results of code chunks using *chunk options*, sometimes </span>
<span id="cb13-609"><a href="#cb13-609"></a>called *knitr options*. We put these on the first line of each code chunk, with</span>
<span id="cb13-610"><a href="#cb13-610"></a>each option on a separate line and each line starting with the characters <span class="in">`#| `</span></span>
<span id="cb13-611"><a href="#cb13-611"></a>(referred to as a _hash-pipe_). Note that the `#|` _must_ be followed by a space</span>
<span id="cb13-612"><a href="#cb13-612"></a>for Quarto to recognise it as a chunk option.</span>
<span id="cb13-613"><a href="#cb13-613"></a></span>
<span id="cb13-614"><a href="#cb13-614"></a>To specify that the code in our R code chunks should not be printed in the final</span>
<span id="cb13-615"><a href="#cb13-615"></a>document, we can set the chunk option <span class="in">`#| echo: false`</span>. To specify that both the </span>
<span id="cb13-616"><a href="#cb13-616"></a>R code and the _output_ produced by that code in each code chunk (e.g. and </span>
<span id="cb13-617"><a href="#cb13-617"></a>messages or warnings) should not be shown, we can set the chunk option </span>
<span id="cb13-618"><a href="#cb13-618"></a><span class="in">`#| include: false`</span>. </span>
<span id="cb13-619"><a href="#cb13-619"></a></span>
<span id="cb13-620"><a href="#cb13-620"></a>If we change the code in our previous example to include this line, the output</span>
<span id="cb13-621"><a href="#cb13-621"></a>becomes much more like the report we want:</span>
<span id="cb13-622"><a href="#cb13-622"></a></span>
<span id="cb13-623"><a href="#cb13-623"></a>&lt;p class="centered-image image-border"&gt;&lt;img src="images/quarto-example-output-better.png" alt="Screen shot of the output from an example Quarto document with code and chunk output suppressed."&gt;&lt;/p&gt;</span>
<span id="cb13-624"><a href="#cb13-624"></a></span>
<span id="cb13-625"><a href="#cb13-625"></a>If a code chunk produces a chart or map then we *do* want to show the output </span>
<span id="cb13-626"><a href="#cb13-626"></a>(although not the code), so in that case we should not set <span class="in">`#| include: false`</span> </span>
<span id="cb13-627"><a href="#cb13-627"></a>-- we do not need to set <span class="in">`#| include: true`</span> because it is the default.</span>
<span id="cb13-628"><a href="#cb13-628"></a></span>
<span id="cb13-629"><a href="#cb13-629"></a>Since we probably don't want any chunks in our code to include the code in our</span>
<span id="cb13-630"><a href="#cb13-630"></a>final document, we could end up setting the chunk option <span class="in">`#| echo: false`</span> for </span>
<span id="cb13-631"><a href="#cb13-631"></a>every code chunk. In a long or complicated document, this would get tedious. </span>
<span id="cb13-632"><a href="#cb13-632"></a>Fortunately, we can set chunk options *globally* (i.e. for all chunks in a </span>
<span id="cb13-633"><a href="#cb13-633"></a>document) by setting them in the YAML document header. To do this, we add a key</span>
<span id="cb13-634"><a href="#cb13-634"></a>called <span class="in">`execute`</span> to the header. Instead of giving the <span class="in">`execute`</span> key a value such</span>
<span id="cb13-635"><a href="#cb13-635"></a>as <span class="in">`true`</span> or <span class="in">`false`</span>, we instead indent the _next_ line of the header by exactly</span>
<span id="cb13-636"><a href="#cb13-636"></a>two spaces and then set the chunk option <span class="in">`echo: false`</span>. If we wanted to set </span>
<span id="cb13-637"><a href="#cb13-637"></a>multiple global chunk options here, we would put each one on a new line, all of</span>
<span id="cb13-638"><a href="#cb13-638"></a>the lines indented by two spaces from the start of each document. </span>
<span id="cb13-639"><a href="#cb13-639"></a></span>
<span id="cb13-640"><a href="#cb13-640"></a><span class="in">```yaml</span></span>
<span id="cb13-641"><a href="#cb13-641"></a><span class="pp">---</span></span>
<span id="cb13-642"><a href="#cb13-642"></a><span class="fu">title</span><span class="kw">:</span><span class="at">  </span><span class="st">"An Quarto document"</span></span>
<span id="cb13-643"><a href="#cb13-643"></a><span class="fu">author</span><span class="kw">:</span><span class="at"> </span><span class="st">"Joe Bloggs"</span></span>
<span id="cb13-644"><a href="#cb13-644"></a><span class="fu">date</span><span class="kw">:</span><span class="at">   </span><span class="st">"3 March 2021"</span></span>
<span id="cb13-645"><a href="#cb13-645"></a><span class="fu">execute</span><span class="kw">:</span></span>
<span id="cb13-646"><a href="#cb13-646"></a><span class="at">  </span><span class="fu">echo</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb13-647"><a href="#cb13-647"></a><span class="pp">---</span></span>
<span id="cb13-648"><a href="#cb13-648"></a><span class="in">```</span></span>
<span id="cb13-649"><a href="#cb13-649"></a></span>
<span id="cb13-650"><a href="#cb13-650"></a>Some of the R code we write produces messages or warnings that we will not want</span>
<span id="cb13-651"><a href="#cb13-651"></a>to include in our Quarto documents. For example, readers of a report based on</span>
<span id="cb13-652"><a href="#cb13-652"></a>crime data are unlikely to want to see the warning produced by the </span>
<span id="cb13-653"><a href="#cb13-653"></a><span class="in">`st_intersection()`</span> function, and will probably be quite surprised if this </span>
<span id="cb13-654"><a href="#cb13-654"></a>appears in their code. To hide these messages, we can split the code needed to</span>
<span id="cb13-655"><a href="#cb13-655"></a>produce a map into two code chunks: one to do the pre-processing that often</span>
<span id="cb13-656"><a href="#cb13-656"></a>creates messages or warnings, and a second chunk to create the map itself.</span>
<span id="cb13-657"><a href="#cb13-657"></a></span>
<span id="cb13-658"><a href="#cb13-658"></a>&lt;p class="centered-image"&gt;&lt;img src="images/quarto-multiple-chunks.png" alt="Screen shot of the a Quarto document including multiple code chunks with different chunk options."&gt;&lt;/p&gt;</span>
<span id="cb13-659"><a href="#cb13-659"></a></span>
<span id="cb13-660"><a href="#cb13-660"></a></span>
<span id="cb13-661"><a href="#cb13-661"></a></span>
<span id="cb13-662"><a href="#cb13-662"></a><span class="fu">## Rendering Quarto</span></span>
<span id="cb13-663"><a href="#cb13-663"></a></span>
<span id="cb13-664"><a href="#cb13-664"></a>Once you've written the text for your document and added the code needed to</span>
<span id="cb13-665"><a href="#cb13-665"></a>produce statistics, tables and figures, it's time to convert your Quarto file</span>
<span id="cb13-666"><a href="#cb13-666"></a>to a document in the format you need. This process is called *rendering*.</span>
<span id="cb13-667"><a href="#cb13-667"></a></span>
<span id="cb13-668"><a href="#cb13-668"></a>In RStudio you can render a Quarto document by clicking the <span class="in">`Render`</span> button (if</span>
<span id="cb13-669"><a href="#cb13-669"></a>you can't see the <span class="in">`Render`</span> button at the top of your Quarto document, that is a</span>
<span id="cb13-670"><a href="#cb13-670"></a>sign you haven't saved the file as a <span class="in">`.qmd`</span> file). By default, RStudio will </span>
<span id="cb13-671"><a href="#cb13-671"></a>produce an HTML file (a web page) and open it in the HTML viewer built into </span>
<span id="cb13-672"><a href="#cb13-672"></a>RStudio. You can produce other formats instead of a web page by clicking on the </span>
<span id="cb13-673"><a href="#cb13-673"></a>downward-pointing arrow next to the <span class="in">`Render`</span> button and then choosing the format</span>
<span id="cb13-674"><a href="#cb13-674"></a>you want.</span>
<span id="cb13-675"><a href="#cb13-675"></a></span>
<span id="cb13-676"><a href="#cb13-676"></a>You can control the output format that RStudio will produce by changing the</span>
<span id="cb13-677"><a href="#cb13-677"></a><span class="in">`format:`</span> value in the YAML header of your Quarto document. The default is</span>
<span id="cb13-678"><a href="#cb13-678"></a><span class="in">`format: html`</span>, but you can also use <span class="in">`format: pdf`</span> to produce a PDF file,</span>
<span id="cb13-679"><a href="#cb13-679"></a><span class="in">`format: docx`</span> to produce a Word document, <span class="in">`format: epub`</span> to produce an e-book,</span>
<span id="cb13-680"><a href="#cb13-680"></a><span class="in">`format: pptx`</span> to produce a PowerPoint presentation. There are </span>
<span id="cb13-681"><a href="#cb13-681"></a><span class="co">[</span><span class="ot">many other ouput formats available</span><span class="co">](https://quarto.org/docs/output-formats/all-formats.html)</span>.</span>
<span id="cb13-682"><a href="#cb13-682"></a></span>
<span id="cb13-683"><a href="#cb13-683"></a></span>
<span id="cb13-684"><a href="#cb13-684"></a>::: {.box .notewell}</span>
<span id="cb13-685"><a href="#cb13-685"></a></span>
<span id="cb13-686"><a href="#cb13-686"></a>If you have a choice of which format to produce a report in, I would suggest you</span>
<span id="cb13-687"><a href="#cb13-687"></a>choose HTML because it can do things (like include interactive maps made with</span>
<span id="cb13-688"><a href="#cb13-688"></a><span class="in">`leaflet`</span>) that Word and PDF format cannot, and can easily be read on mobile </span>
<span id="cb13-689"><a href="#cb13-689"></a>devices. If, for whatever reason, you cannot choose HTML, I recommend choosing </span>
<span id="cb13-690"><a href="#cb13-690"></a>PDF format since it is readable on almost all computers, even those that do not</span>
<span id="cb13-691"><a href="#cb13-691"></a>have Word installed on them. Only produce reports in Word format if you are </span>
<span id="cb13-692"><a href="#cb13-692"></a>specifically required to submit something in that format.</span>
<span id="cb13-693"><a href="#cb13-693"></a></span>
<span id="cb13-694"><a href="#cb13-694"></a>:::</span>
<span id="cb13-695"><a href="#cb13-695"></a></span>
<span id="cb13-696"><a href="#cb13-696"></a></span>
<span id="cb13-697"><a href="#cb13-697"></a>Whatever format you choose, the output file will be saved in the same folder on</span>
<span id="cb13-698"><a href="#cb13-698"></a>your computer that you saved your <span class="in">`.qmd`</span> file in, and will have the same file</span>
<span id="cb13-699"><a href="#cb13-699"></a>name but with a different file extension (<span class="in">`.html`</span>, <span class="in">`.pdf`</span>, <span class="in">`.docx`</span>, etc.). If </span>
<span id="cb13-700"><a href="#cb13-700"></a>you render the document again, RStudio will overwrite the previous output file.</span>
<span id="cb13-701"><a href="#cb13-701"></a></span>
<span id="cb13-702"><a href="#cb13-702"></a>When you render a Quarto document, RStudio will run all the code in the file so</span>
<span id="cb13-703"><a href="#cb13-703"></a>that it can knit the results together with the document text. This is similar to</span>
<span id="cb13-704"><a href="#cb13-704"></a>running the code in a <span class="in">`.R`</span> file using the <span class="in">`Source`</span> button, except that when</span>
<span id="cb13-705"><a href="#cb13-705"></a>RStudio runs the code in a Quarto document, RStudio can only access functions</span>
<span id="cb13-706"><a href="#cb13-706"></a>from the packages that are loaded in the Quarto document itself, and only make </span>
<span id="cb13-707"><a href="#cb13-707"></a>use of objects created inside the Quarto document. This means that nothing you</span>
<span id="cb13-708"><a href="#cb13-708"></a>do in the console or in any other files you have open in RStudio (e.g. loading a </span>
<span id="cb13-709"><a href="#cb13-709"></a>package or creating an object) affects the results that will be produced when</span>
<span id="cb13-710"><a href="#cb13-710"></a>you render a Quarto document.</span>
<span id="cb13-711"><a href="#cb13-711"></a></span>
<span id="cb13-712"><a href="#cb13-712"></a>Since rendering a Quarto document involves running all the code contained in it,</span>
<span id="cb13-713"><a href="#cb13-713"></a>it is possible that the code will cause errors at the time when the Quarto</span>
<span id="cb13-714"><a href="#cb13-714"></a>document is rendered. When this happens, the R error message will appear in the</span>
<span id="cb13-715"><a href="#cb13-715"></a>RStudio Render panel. When you run a <span class="in">`.R`</span> file that produces an error, the error</span>
<span id="cb13-716"><a href="#cb13-716"></a>message typically tells you which line of code the error occurred on. But when</span>
<span id="cb13-717"><a href="#cb13-717"></a>an error occurs while rendering a Quarto file, the error message only specifies </span>
<span id="cb13-718"><a href="#cb13-718"></a>the first and last lines of the _part_ of the document in which the error</span>
<span id="cb13-719"><a href="#cb13-719"></a>occurred. If the error occurred inside a code chunk, the error message will</span>
<span id="cb13-720"><a href="#cb13-720"></a>refer to the first and last lines of that chunk, but the error itself could have</span>
<span id="cb13-721"><a href="#cb13-721"></a>occurred anywhere inside that chunk. If the error occurs _outside_ a code chunk,</span>
<span id="cb13-722"><a href="#cb13-722"></a>the error message will report that the error occurred somewhere between the last</span>
<span id="cb13-723"><a href="#cb13-723"></a>line of the previous code chunk and the first line of the next code chunk. It is</span>
<span id="cb13-724"><a href="#cb13-724"></a>up to you to find the exact location of the error.</span>
<span id="cb13-725"><a href="#cb13-725"></a></span>
<span id="cb13-726"><a href="#cb13-726"></a></span>
<span id="cb13-727"><a href="#cb13-727"></a><span class="fu">### Making self-contained HTML documents</span></span>
<span id="cb13-728"><a href="#cb13-728"></a></span>
<span id="cb13-729"><a href="#cb13-729"></a>Web pages written in HTML typically make use of images, videos and other </span>
<span id="cb13-730"><a href="#cb13-730"></a>resources stored in separate files. In fact, the web page you're reading now</span>
<span id="cb13-731"><a href="#cb13-731"></a>makes use of resources stored in 51 separate files. This works well on the web,</span>
<span id="cb13-732"><a href="#cb13-732"></a>since it allows resources to be shared between lots of HTML files, which reduces</span>
<span id="cb13-733"><a href="#cb13-733"></a>how much data has to be stored and transmitted across networks. But it works </span>
<span id="cb13-734"><a href="#cb13-734"></a>less well when you want to send an HTML report to someone else over email, since</span>
<span id="cb13-735"><a href="#cb13-735"></a>it can be hard to keep track of all the external files associated with a </span>
<span id="cb13-736"><a href="#cb13-736"></a>particular HTML file.</span>
<span id="cb13-737"><a href="#cb13-737"></a></span>
<span id="cb13-738"><a href="#cb13-738"></a>To deal with this problem, we can tell Quarto that when it creates an HTML </span>
<span id="cb13-739"><a href="#cb13-739"></a>report, all the necessary data and other resources should be embedded inside the</span>
<span id="cb13-740"><a href="#cb13-740"></a>HTML file itself. This makes the HTML file larger, but easier to manage. To make</span>
<span id="cb13-741"><a href="#cb13-741"></a>HTML reports produced by Quarto self-contained in this way, we can change the</span>
<span id="cb13-742"><a href="#cb13-742"></a><span class="in">`format`</span> section of the header of a Quarto document from simply <span class="in">`format: html`</span></span>
<span id="cb13-743"><a href="#cb13-743"></a>to instead specify exactly what settings we want to be used to create that HTML</span>
<span id="cb13-744"><a href="#cb13-744"></a>file:</span>
<span id="cb13-745"><a href="#cb13-745"></a></span>
<span id="cb13-746"><a href="#cb13-746"></a><span class="in">```yaml</span></span>
<span id="cb13-747"><a href="#cb13-747"></a><span class="fu">format</span><span class="kw">:</span></span>
<span id="cb13-748"><a href="#cb13-748"></a><span class="at">  </span><span class="fu">html</span><span class="kw">:</span></span>
<span id="cb13-749"><a href="#cb13-749"></a><span class="at">    </span><span class="fu">embed-resources</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb13-750"><a href="#cb13-750"></a><span class="in">```</span></span>
<span id="cb13-751"><a href="#cb13-751"></a></span>
<span id="cb13-752"><a href="#cb13-752"></a>There are lots of other ways we can use the <span class="in">`format`</span> section of the header in a</span>
<span id="cb13-753"><a href="#cb13-753"></a>Quarto document to fine-tune how the resulting document works. You can find out</span>
<span id="cb13-754"><a href="#cb13-754"></a>more <span class="co">[</span><span class="ot">in the HTML section of the Quarto website</span><span class="co">](https://quarto.org/docs/output-formats/html-basics.html)</span>.</span>
<span id="cb13-755"><a href="#cb13-755"></a></span>
<span id="cb13-756"><a href="#cb13-756"></a></span>
<span id="cb13-757"><a href="#cb13-757"></a><span class="fu">## In summary</span></span>
<span id="cb13-758"><a href="#cb13-758"></a></span>
<span id="cb13-759"><a href="#cb13-759"></a>::: {.box .welldone}</span>
<span id="cb13-760"><a href="#cb13-760"></a></span>
<span id="cb13-761"><a href="#cb13-761"></a>In this tutorial we have learned how to use Markdown to create structured </span>
<span id="cb13-762"><a href="#cb13-762"></a>text using simple formatting codes and how to integrate that text with our code</span>
<span id="cb13-763"><a href="#cb13-763"></a>to produce integrated reports that include the results of our analysis. This </span>
<span id="cb13-764"><a href="#cb13-764"></a>means we can make our work *reproducible* so that we can avoid all the mistakes</span>
<span id="cb13-765"><a href="#cb13-765"></a>that can happen if we have to copy and paste statistics and graphics into </span>
<span id="cb13-766"><a href="#cb13-766"></a>reports written in software like Word. </span>
<span id="cb13-767"><a href="#cb13-767"></a></span>
<span id="cb13-768"><a href="#cb13-768"></a>It also means we can produce periodic reports with updated data very easily, </span>
<span id="cb13-769"><a href="#cb13-769"></a>since we can just choose the data we want the report to be based on using </span>
<span id="cb13-770"><a href="#cb13-770"></a><span class="in">`filter()`</span> at the start of our file and render the document. This can save a </span>
<span id="cb13-771"><a href="#cb13-771"></a>huge amount of time in producing reports such as performance bulletins or </span>
<span id="cb13-772"><a href="#cb13-772"></a>monthly summaries of crime in an area.</span>
<span id="cb13-773"><a href="#cb13-773"></a></span>
<span id="cb13-774"><a href="#cb13-774"></a>:::</span>
<span id="cb13-775"><a href="#cb13-775"></a></span>
<span id="cb13-776"><a href="#cb13-776"></a></span>
<span id="cb13-777"><a href="#cb13-777"></a>To get used to working with Quarto files, download </span>
<span id="cb13-778"><a href="#cb13-778"></a><span class="co">[</span><span class="ot">this example report</span><span class="co">](https://github.com/mpjashby/crimemapping/raw/main/inst/example_quarto_report.qmd)</span></span>
<span id="cb13-779"><a href="#cb13-779"></a>to your computer and open it in RStudio. Now make the following changes:</span>
<span id="cb13-780"><a href="#cb13-780"></a></span>
<span id="cb13-781"><a href="#cb13-781"></a><span class="ss">  1. </span>Change the global chunk options so that the code used in each code chunk is</span>
<span id="cb13-782"><a href="#cb13-782"></a>     not shown in the final document.</span>
<span id="cb13-783"><a href="#cb13-783"></a><span class="ss">  3. </span>Render the file into documents of at least two different formats (e.g. HTML</span>
<span id="cb13-784"><a href="#cb13-784"></a>     and Word). If you have installed <span class="in">`tinytex`</span> on your computer so that you can</span>
<span id="cb13-785"><a href="#cb13-785"></a>     create PDF documents, look at how different the document appears in PDF</span>
<span id="cb13-786"><a href="#cb13-786"></a>     format compared to HTML format because of the different templates used.</span>
<span id="cb13-787"><a href="#cb13-787"></a></span>
<span id="cb13-788"><a href="#cb13-788"></a>There is a lot more you can do with Quarto. To find out more, refer to these</span>
<span id="cb13-789"><a href="#cb13-789"></a>resources.</span>
<span id="cb13-790"><a href="#cb13-790"></a></span>
<span id="cb13-791"><a href="#cb13-791"></a><span class="ss">  * </span><span class="co">[</span><span class="ot">R for Data Science chapter on Quarto</span><span class="co">](https://r4ds.hadley.nz/quarto.html)</span>.</span>
<span id="cb13-792"><a href="#cb13-792"></a><span class="ss">  * </span>A <span class="co">[</span><span class="ot">gallery of different documents, websites and presentations written with Quarto</span><span class="co">](https://quarto.org/docs/gallery/)</span>.</span>
<span id="cb13-793"><a href="#cb13-793"></a></span>
<span id="cb13-794"><a href="#cb13-794"></a>&lt;p class="credits"&gt;&lt;a href="https://twitter.com/allison_horst"&gt;Artwork by @allison_horst&lt;/a&gt;&lt;/p&gt;</span></code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://creativecommons.org/licenses/by/4.0/">
<p>This book is available under a Creative Commons Attribution 4.0 International licence</p>
</a>
  </li>  
</ul>
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/mpjashby/crimemappingbook/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




<script src="../site_libs/quarto-contrib/line-highlight-1.0.0/line-highlight.js" defer="true"></script>
</body></html>