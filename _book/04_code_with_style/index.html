<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Learn crime mapping with R - 4&nbsp; Code with style</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../05_your_second_crime_map/index.html" rel="next">
<link href="../03_data_wrangling/index.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><!-- START OF INCLUDED HEADER --><!--
This file contains code that will be included in the header of each page of the
quarto book
--><script src="https://code.jquery.com/jquery-3.6.3.min.js" integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU=" crossorigin="anonymous"></script><!-- END OF INCLUDED HEADER --><link rel="stylesheet" href="../css/styles.css">
<meta name="twitter:title" content="Learn crime mapping with R - 4&nbsp; Code with style">
<meta name="twitter:description" content="">
<meta name="twitter:card" content="summary">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../04_code_with_style/index.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Code with style</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Learn crime mapping with R</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/mpjashby/crimemappingbook/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="../learn_crime_mapping_with_r.epub" title="Download ePub" class="quarto-navigation-tool px-1" aria-label="Download ePub"><i class="bi bi-journal"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=%7Curl%7C">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=%7Curl%7C">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=%7Curl%7C">
              <i class="bi bi-bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
</div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome!</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../00_setup/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Install the software needed for this book</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01_getting_started/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting started</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02_your_first_crime_map/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Your first crime map</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_data_wrangling/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Wrangling data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04_code_with_style/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Code with style</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05_your_second_crime_map/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Your second crime map</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../06_map_context/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Giving a map context</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../07_handling_bugs/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Handling bugs in your code</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../08_projects/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Don’t get lost in data analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../09_mapping_areas/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Mapping area data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../10_place_data/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Crime Mapping: Using data about places</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../11_mapping_hotspots/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Crime Mapping: Mapping hotspots</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../12_messy_data/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Handling messy data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../13_crime_series/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Mapping crime series</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../14_writing_reports/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Writing reports in R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../15_no_maps/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Presenting spatial data without maps</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../16_mapping_time/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Mapping crime over time</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/read_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Functions for reading data into R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/common_errors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Common R errors and how to fix them</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
    <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">In this chapter</h2>
   
  <ul class="collapse">
<li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">4.1</span> Introduction</a></li>
  <li><a href="#organising-your-code" id="toc-organising-your-code" class="nav-link" data-scroll-target="#organising-your-code"><span class="header-section-number">4.2</span> Organising your code</a></li>
  <li><a href="#naming-objects" id="toc-naming-objects" class="nav-link" data-scroll-target="#naming-objects"><span class="header-section-number">4.3</span> Naming objects</a></li>
  <li><a href="#spacing" id="toc-spacing" class="nav-link" data-scroll-target="#spacing"><span class="header-section-number">4.4</span> Spacing</a></li>
  <li><a href="#functions" id="toc-functions" class="nav-link" data-scroll-target="#functions"><span class="header-section-number">4.5</span> Functions</a></li>
  <li><a href="#styling-your-code-automatically" id="toc-styling-your-code-automatically" class="nav-link" data-scroll-target="#styling-your-code-automatically"><span class="header-section-number">4.6</span> Styling your code automatically</a></li>
  <li><a href="#in-summary" id="toc-in-summary" class="nav-link" data-scroll-target="#in-summary"><span class="header-section-number">4.7</span> In summary</a></li>
  </ul><div class="toc-actions"><ul class="collapse"><li><a href="https://github.com/mpjashby/crimemappingbook/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Code with style</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p><strong>Learn how to format your code so that it is easier to read, both for you and for others.</strong></p>
<div class="box load-tutorial">
<p>To load the <a href="../#how-to-use-this-book">interactive tutorial</a> for this chapter, copy and paste the following code into the RStudio console:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>crimemapping<span class="sc">::</span><span class="fu">tutorial</span>(<span class="st">"04_code_with_style"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and press <code>Enter</code>.</p>
</div>
<section id="introduction" class="level2" data-number="4.1"><h2 data-number="4.1" class="anchored" data-anchor-id="introduction">
<span class="header-section-number">4.1</span> Introduction</h2>
<p>Now that you’re beginning to write code in R, it’s time to introduce a few conventions for how to write code so that it’s easier to read. This is important because “<a href="https://style.tidyverse.org/">good coding style is like correct punctuation: you can manage without it, butitsuremakesthingseasiertoread</a>”.</p>
<p>Writing readable code is particularly important because it is much easier to find mistakes in well-written code, and your code will inevitably contain mistakes (everyone’s code contains mistakes!).</p>
<p>Writing code has been compared to performing in a band:</p>
<blockquote class="blockquote">
<p><a href="https://www.smashingmagazine.com/2012/10/why-coding-style-matters/">I liken the situation to a group of musicians trying to form a band. Each one comes in believing that their way of doing things is best (their “method” or “process”). The band will struggle so long as everyone is trying to do their own thing. It’s impossible to create good music unless everyone in the band agrees on the tempo, the style and who should take lead during a song. Anyone who has ever heard a high school band perform knows this to be true. Unless everyone is on the same page, you aren’t going to accomplish much.</a></p>
</blockquote>
<p>You might be relaxing at this point, thinking “that isn’t a problem for me, because I’m the only person who is going to be working on my code”. If so, think again. It’s been said that in data science that there are always at least two people working on a project: the <em>you</em> who is working on the code now, and the <em>past you</em> who has worked on the same code previously. The problem is that <em><a href="https://datasciencecampus.ons.gov.uk/taking-reproducible-analytical-pipelines-on-a-virtual-tour-first-stop-the-caribbean/">past you does not answer emails</a></em>. So you can save <em>future you</em> a lot of hassle later by writing readable code.</p>
<p>This tutorial introduces some basic guidelines on formatting your code. This is a condensed version of the <a href="https://style.tidyverse.org/">The tidyverse style guide</a>, which provides lots more detail. All the code you see in the tutorials in this course was written following this style guide.</p>
<p class="full-width-image">
<img src="https://github.com/mpjashby/crimemapping/raw/main/inst/tutorials/04_code_with_style/images/on_perl.png" alt="A three-panel cartoon. In the first panel a man says 'this is the worst code I've ever seen'. In the second panel, he says 'the comments are useless, there's variables that do nothing …' and 'what depraved madman wrote this?'. In the third panel, he says 'wait, I did this two weeks ago'."></p>
<p class="credits">
<a href="http://www.threepanelsoul.com/comic/on-perl">On Perl</a> from <a href="http://www.threepanelsoul.com/">Three Panel Soul</a>. Some content on this page contains public sector information licensed under the Open Government Licence v3.
</p>
</section><section id="organising-your-code" class="level2" data-number="4.2"><h2 data-number="4.2" class="anchored" data-anchor-id="organising-your-code">
<span class="header-section-number">4.2</span> Organising your code</h2>
<p>Up until now we have only written code in the code boxes within these interactive tutorials, but when you move on to make maps using your own R code you will typically write that code in the RStudio source panel. Your code will usually be in one or more files with the <code>.R</code> file extension. Whether you keep all your code for a specific project in one file or split it into multiple files is up to you. Generally you should do whatever makes it easier to understand how your code is structured.</p>
<section id="leaving-notes-for-future-you" class="level3" data-number="4.2.1"><h3 data-number="4.2.1" class="anchored" data-anchor-id="leaving-notes-for-future-you">
<span class="header-section-number">4.2.1</span> Leaving notes for future you</h3>
<p>Within each <code>.R</code> file, you can make your code easier to understand in several ways. First, add a comment (one or more lines beginning with <code>#</code> <em>followed by a space</em>) at the top of the file to explain what the code in that file does. This will make it easier for you to know that you’ve found the right file if you are looking for it in a few weeks when you’ve forgotten (which you will) what file contains what code.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># This code produces a density map of bike thefts in Vancouver in 2020</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Comments should usually start with a capital letter and follow normal English rules of punctuation, spacing, etc.</p>
</section><section id="letting-your-code-breathe" class="level3" data-number="4.2.2"><h3 data-number="4.2.2" class="anchored" data-anchor-id="letting-your-code-breathe">
<span class="header-section-number">4.2.2</span> Letting your code breathe</h3>
<p>Unless your code is very simple, it will probably consist of several separate tasks that are completed one after another. For example your code might download some data, wrangle it and then plot it on a map. In that case, it can be useful to split your code up into blocks by leaving a blank line between the code needed for each task. For example, if we take the code:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb3-3"><a href="#cb3-3"></a>crimes <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"crime_data.csv"</span>)</span>
<span id="cb3-4"><a href="#cb3-4"></a>crimes <span class="ot">&lt;-</span> janitor<span class="sc">::</span><span class="fu">clean_names</span>(crimes)</span>
<span id="cb3-5"><a href="#cb3-5"></a>burglaries <span class="ot">&lt;-</span> <span class="fu">filter</span>(crimes, type <span class="sc">==</span> <span class="st">"burglary"</span>)</span>
<span id="cb3-6"><a href="#cb3-6"></a>burglaries <span class="ot">&lt;-</span> <span class="fu">mutate</span>(burglaries, <span class="at">month =</span> <span class="fu">month</span>(date_time))</span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb3-8"><a href="#cb3-8"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> lon, <span class="at">y =</span> lat, <span class="at">colour =</span> month)) <span class="sc">+</span></span>
<span id="cb3-9"><a href="#cb3-9"></a>  <span class="fu">theme_void</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>it becomes easier to read if we split the code up into four tasks: loading the necessary packages, reading the data, wrangling the data and plotting the data.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb4-3"><a href="#cb4-3"></a></span>
<span id="cb4-4"><a href="#cb4-4"></a>crimes <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"crime_data.csv"</span>)</span>
<span id="cb4-5"><a href="#cb4-5"></a></span>
<span id="cb4-6"><a href="#cb4-6"></a>crimes <span class="ot">&lt;-</span> janitor<span class="sc">::</span><span class="fu">clean_names</span>(crimes)</span>
<span id="cb4-7"><a href="#cb4-7"></a>burglaries <span class="ot">&lt;-</span> <span class="fu">filter</span>(crimes, type <span class="sc">==</span> <span class="st">"burglary"</span>)</span>
<span id="cb4-8"><a href="#cb4-8"></a>burglaries <span class="ot">&lt;-</span> <span class="fu">mutate</span>(burglaries, <span class="at">month =</span> <span class="fu">month</span>(date_time))</span>
<span id="cb4-9"><a href="#cb4-9"></a></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="fu">ggplot</span>(burglaries) <span class="sc">+</span> </span>
<span id="cb4-11"><a href="#cb4-11"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> lon, <span class="at">y =</span> lat, <span class="at">colour =</span> month)) <span class="sc">+</span></span>
<span id="cb4-12"><a href="#cb4-12"></a>  <span class="fu">theme_void</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Since data wrangling involves several steps and each function uses the result of the previous step, we could use the pipe operator <code>|&gt;</code> to make that code a bit cleaner:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb5-3"><a href="#cb5-3"></a></span>
<span id="cb5-4"><a href="#cb5-4"></a>crimes <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"crime_data.csv"</span>)</span>
<span id="cb5-5"><a href="#cb5-5"></a></span>
<span id="cb5-6"><a href="#cb5-6"></a>burglaries <span class="ot">&lt;-</span> crimes <span class="sc">|&gt;</span> </span>
<span id="cb5-7"><a href="#cb5-7"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb5-8"><a href="#cb5-8"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"burglary"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-9"><a href="#cb5-9"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">month</span>(date_time))</span>
<span id="cb5-10"><a href="#cb5-10"></a></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="fu">ggplot</span>(burglaries) <span class="sc">+</span> </span>
<span id="cb5-12"><a href="#cb5-12"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> lon, <span class="at">y =</span> lat, <span class="at">colour =</span> month)) <span class="sc">+</span></span>
<span id="cb5-13"><a href="#cb5-13"></a>  <span class="fu">theme_void</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section><section id="header-comments" class="level3" data-number="4.2.3"><h3 data-number="4.2.3" class="anchored" data-anchor-id="header-comments">
<span class="header-section-number">4.2.3</span> Header comments</h3>
<p>If your code includes very long tasks (e.g.&nbsp;where the code takes up more than a full screen on your computer), you might want to use header comments to divide your code into sections. You can do this by writing a comment that is followed by four of more hyphens (<code>----</code>):</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># Load data ----</span></span>
<span id="cb6-2"><a href="#cb6-2"></a></span>
<span id="cb6-3"><a href="#cb6-3"></a>… some code …</span>
<span id="cb6-4"><a href="#cb6-4"></a></span>
<span id="cb6-5"><a href="#cb6-5"></a></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="co"># Wrangle data ----</span></span>
<span id="cb6-7"><a href="#cb6-7"></a></span>
<span id="cb6-8"><a href="#cb6-8"></a>… some code …</span>
<span id="cb6-9"><a href="#cb6-9"></a></span>
<span id="cb6-10"><a href="#cb6-10"></a></span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="co"># Plot data ----</span></span>
<span id="cb6-12"><a href="#cb6-12"></a></span>
<span id="cb6-13"><a href="#cb6-13"></a>… some code …</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>RStudio will recognise lines that end in four or more hyphens as being headings, and will create a table of contents for your code. You can use this to move between headings by clicking on the Jump To menu at the bottom of the Source panel in RStudio:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/rstudio_code_sections.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="462"></p>
</figure>
</div>
</div>
</div>
<p>In general, writing code that is readable is more important than writing the shortest code possible, so don’t be afraid to let your code breathe by using space to separate your code into meaningful chunks.</p>
<div class="tutorial">
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">quiz</span>(</span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="at">caption =</span> <span class="st">""</span>,</span>
<span id="cb7-3"><a href="#cb7-3"></a>  </span>
<span id="cb7-4"><a href="#cb7-4"></a>  <span class="fu">question</span>(</span>
<span id="cb7-5"><a href="#cb7-5"></a>    <span class="st">"How do you write a comment in R?"</span>,</span>
<span id="cb7-6"><a href="#cb7-6"></a>    <span class="fu">answer</span>(<span class="st">"A `#` symbol followed by a space. Comments should start with a capital leter. e.g. `# Load data`"</span>, <span class="at">correct =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-7"><a href="#cb7-7"></a>    <span class="fu">answer</span>(</span>
<span id="cb7-8"><a href="#cb7-8"></a>      <span class="st">"A `#` symbol, followed by no spaces. Comments should start with a capital letter. e.g. `#Load data`"</span>,</span>
<span id="cb7-9"><a href="#cb7-9"></a>      <span class="at">message =</span> <span class="st">"Not quite right: comments should start with a capital letter but should also have a space after the initial `#` symbol."</span></span>
<span id="cb7-10"><a href="#cb7-10"></a>    ),</span>
<span id="cb7-11"><a href="#cb7-11"></a>    <span class="fu">answer</span>(</span>
<span id="cb7-12"><a href="#cb7-12"></a>      <span class="st">"A `#` symbol followed by a space. Comments should be in lower case unless the comment is long enough to contain more than one sentence. e.g. `# load data`"</span>,</span>
<span id="cb7-13"><a href="#cb7-13"></a>      <span class="at">message =</span> <span class="st">"Not quite right: comments should start with a space after the initial `#` symbol, but the comment text should start with a capital letter."</span></span>
<span id="cb7-14"><a href="#cb7-14"></a>    ),</span>
<span id="cb7-15"><a href="#cb7-15"></a>    <span class="fu">answer</span>(</span>
<span id="cb7-16"><a href="#cb7-16"></a>      <span class="st">"A `#` symbol, followed by no spaces. Comments should be in lower case unless the comment is long enough to contain more than one sentence. e.g. `#load data`"</span>,</span>
<span id="cb7-17"><a href="#cb7-17"></a>      <span class="at">message =</span> <span class="st">"Not quite right: comments should start with a space after the initial `#` symbol and the comment text should start with a capital letter."</span></span>
<span id="cb7-18"><a href="#cb7-18"></a>    ),</span>
<span id="cb7-19"><a href="#cb7-19"></a>    <span class="at">correct =</span> <span class="fu">random_praise</span>(),</span>
<span id="cb7-20"><a href="#cb7-20"></a>    <span class="at">allow_retry =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-21"><a href="#cb7-21"></a>    <span class="at">random_answer_order =</span> <span class="cn">TRUE</span></span>
<span id="cb7-22"><a href="#cb7-22"></a>  )</span>
<span id="cb7-23"><a href="#cb7-23"></a>  </span>
<span id="cb7-24"><a href="#cb7-24"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section></section><section id="naming-objects" class="level2" data-number="4.3"><h2 data-number="4.3" class="anchored" data-anchor-id="naming-objects">
<span class="header-section-number">4.3</span> Naming objects</h2>
<p>R objects can have any name you like, as long as the name starts with a letter and contains only letters, numbers, dots (<code>.</code>) and underscores (<code>_</code>). That said, you will find coding easier if you follow a few conventions.</p>
<ul>
<li>Use only lower-case letters in the names of objects, which avoids you having to remember whether a particular letter was upper- or lower-case.</li>
<li>Use <em>snake case</em> (<code>object_name</code>, with words separated by underscores) for object names rather than camel case (<code>objectName</code>) or kebab case (<code>object-name</code>).</li>
<li>Don’t use dots in object names.</li>
<li>Don’t give objects the same names as R functions, because re-using function names makes reading your code more difficult.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/snake_case.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>Just as <code>crime_data_atlanta_2020.csv</code> is a more-useful file name than <code>data_file_23.csv</code>, you will find it easier to read your code if you give your objects meaningful names. So when you load data into R (e.g.&nbsp;with <code>read_csv()</code>) don’t just call it <code>data</code> (not least because there is a function named <code><a href="https://rdrr.io/r/utils/data.html">data()</a></code>) but instead give it a name like <code>atlanta_crimes</code> if it contains (for example) crime data from Atlanta.</p>
<div class="tutorial">
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">quiz</span>(</span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="at">caption =</span> <span class="st">""</span>,</span>
<span id="cb8-3"><a href="#cb8-3"></a>  </span>
<span id="cb8-4"><a href="#cb8-4"></a>  <span class="fu">question</span>(</span>
<span id="cb8-5"><a href="#cb8-5"></a>    <span class="st">"Which of these would be a good name for an object containing data on homicides in Abu Dhabi?"</span>,</span>
<span id="cb8-6"><a href="#cb8-6"></a>    <span class="fu">answer</span>(<span class="st">"`abu_dhabi_homicides`"</span>, <span class="at">correct =</span> <span class="cn">TRUE</span>),</span>
<span id="cb8-7"><a href="#cb8-7"></a>    <span class="fu">answer</span>(</span>
<span id="cb8-8"><a href="#cb8-8"></a>      <span class="st">"`homicide_data`"</span>,</span>
<span id="cb8-9"><a href="#cb8-9"></a>      <span class="at">message =</span> <span class="st">"Not quite right: this name is in the right case, but could better describe the data it contains."</span></span>
<span id="cb8-10"><a href="#cb8-10"></a>    ),</span>
<span id="cb8-11"><a href="#cb8-11"></a>    <span class="fu">answer</span>(</span>
<span id="cb8-12"><a href="#cb8-12"></a>      <span class="st">"`Abu_Dhabi_homicides`"</span>,</span>
<span id="cb8-13"><a href="#cb8-13"></a>      <span class="at">message =</span> <span class="st">"Not quite right: it's best to only use lower-case characters in variables, so you don't need to remember whether you've used upper- or lower-case characters."</span></span>
<span id="cb8-14"><a href="#cb8-14"></a>    ),</span>
<span id="cb8-15"><a href="#cb8-15"></a>    <span class="fu">answer</span>(</span>
<span id="cb8-16"><a href="#cb8-16"></a>      <span class="st">"`abu-dhabi-homicides`"</span>,</span>
<span id="cb8-17"><a href="#cb8-17"></a>      <span class="at">message =</span> <span class="st">"This will cause an error because the `-` indicates R should subtract one value from another."</span></span>
<span id="cb8-18"><a href="#cb8-18"></a>    ),</span>
<span id="cb8-19"><a href="#cb8-19"></a>    <span class="at">correct =</span> <span class="fu">random_praise</span>(),</span>
<span id="cb8-20"><a href="#cb8-20"></a>    <span class="at">allow_retry =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-21"><a href="#cb8-21"></a>    <span class="at">random_answer_order =</span> <span class="cn">TRUE</span></span>
<span id="cb8-22"><a href="#cb8-22"></a>  )</span>
<span id="cb8-23"><a href="#cb8-23"></a>  </span>
<span id="cb8-24"><a href="#cb8-24"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section><section id="spacing" class="level2" data-number="4.4"><h2 data-number="4.4" class="anchored" data-anchor-id="spacing">
<span class="header-section-number">4.4</span> Spacing</h2>
<p>Spacing out code makes it much easier to read, but (just as in any language) code is easiest to read if spaces are used where people expect them to be by convention.</p>
<p>Mostly in R, we use spaces where we would expect them in English: after commas but not before, outside parentheses but not inside, etc.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># Good</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="fu">read_csv</span>(<span class="st">"crime_data.csv"</span>, <span class="at">skip =</span> <span class="dv">4</span>)</span>
<span id="cb9-3"><a href="#cb9-3"></a></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co"># Bad</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="fu">read_csv</span>(<span class="st">"crime_data.csv"</span>,<span class="at">skip =</span> <span class="dv">4</span>)</span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="fu">read_csv</span>(<span class="st">"crime_data.csv"</span> ,<span class="at">skip =</span> <span class="dv">4</span>)</span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="fu">read_csv</span>(<span class="st">"crime_data.csv"</span> , <span class="at">skip =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Don’t put spaces inside parentheses, or between the names of functions and the parentheses:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># Good</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-3"><a href="#cb10-3"></a></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co"># Bad</span></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="fu">mean</span> (x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="fu">mean</span>( x, <span class="at">na.rm =</span> <span class="cn">TRUE</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><em>Do</em> put spaces around most operators (<code>==</code>, <code>+</code>, <code>-</code>, <code>&lt;-</code>, etc.), including either side of <code>=</code> when specifying the values of function arguments:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># Good</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>height <span class="ot">&lt;-</span> (feet <span class="sc">*</span> <span class="dv">12</span>) <span class="sc">+</span> inches</span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-4"><a href="#cb11-4"></a></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="co"># Bad</span></span>
<span id="cb11-6"><a href="#cb11-6"></a>height<span class="ot">&lt;-</span>feet<span class="sc">*</span><span class="dv">12</span><span class="sc">+</span>inches</span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="fu">mean</span>(x, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Although there are some operators that shouldn’t have spaces around them: <code>$</code>, <code>@</code>, <code>[</code>, <code>[[</code>, <code>^</code>, <code>:</code> and <code>?</code>.</p>
<div class="tutorial">
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">question</span>(</span>
<span id="cb12-2"><a href="#cb12-2"></a>  <span class="st">"Which of these lines of code has the optimal spacing?"</span>,</span>
<span id="cb12-3"><a href="#cb12-3"></a>  <span class="fu">answer</span>(<span class="st">'`burglary &lt;- filter(crimes, type == "burglary")`'</span>, <span class="at">correct =</span> <span class="cn">TRUE</span>),</span>
<span id="cb12-4"><a href="#cb12-4"></a>  <span class="fu">answer</span>(<span class="st">'`burglary&lt;-filter(crimes,type=="burglary")`'</span>),</span>
<span id="cb12-5"><a href="#cb12-5"></a>  <span class="fu">answer</span>(<span class="st">'`burglary &lt;- filter(crimes, type=="burglary")`'</span>),</span>
<span id="cb12-6"><a href="#cb12-6"></a>  <span class="fu">answer</span>(<span class="st">'`burglary &lt;- filter ( crimes , type == "burglary" )`'</span>),</span>
<span id="cb12-7"><a href="#cb12-7"></a>  <span class="at">correct =</span> <span class="fu">random_praise</span>(),</span>
<span id="cb12-8"><a href="#cb12-8"></a>  <span class="at">incorrect =</span> <span class="fu">random_encouragement</span>(),</span>
<span id="cb12-9"><a href="#cb12-9"></a>  <span class="at">allow_retry =</span> <span class="cn">TRUE</span>,</span>
<span id="cb12-10"><a href="#cb12-10"></a>  <span class="at">random_answer_order =</span> <span class="cn">FALSE</span></span>
<span id="cb12-11"><a href="#cb12-11"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section><section id="functions" class="level2" data-number="4.5"><h2 data-number="4.5" class="anchored" data-anchor-id="functions">
<span class="header-section-number">4.5</span> Functions</h2>
<p>We’ve now got used to calling functions to do things in R, like calling <code>read_csv()</code> to load data from a CSV file or <code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code> to choose certain rows from a dataset. We know that we can change the behaviour of functions by using arguments. For example, we can wrap a a string of text into shorter lines using the <code>str_wrap()</code> function from the <code>stringr</code> package. <code>str_wrap()</code> needs two arguments: the text to be wrapped into multiple lines and the maximum length of a line of text before the next word is wrapped onto a new line. These arguments are called <code>string</code> and <code>width</code>, so we can call the function as:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">str_wrap</span>(<span class="at">string =</span> <span class="st">"some text to be wrapped"</span>, <span class="at">width =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The <code>string</code> argument provides the <em>data</em> that the <code>str_wrap()</code> function will work on, while the <code>width</code> argument provides the details of how that work should be done. Since the data argument to a function is typically required (the function makes no sense without it) and is often the first argument, you can omit the name of data arguments to functions. For all other arguments, it is best to give the argument name. So to use <code>str_wrap()</code>, you can write:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">str_wrap</span>(<span class="st">"some text to be wrapped"</span>, <span class="at">width =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In general, you should keep lines of code to a maximum of 80 characters long, since they can easily fit on most screens and are easy to read. When calling a function, put all of the parameters on a single line if they will fit into 80 characters or less:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">do_something_simple</span>(<span class="st">"something"</span>, <span class="at">with =</span> <span class="st">"only"</span>, short, <span class="st">"arguments"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>But if the function call is longer than 80 characters, use one line each for the function name, each argument, and the closing <code>)</code>, with the arguments indented by two spaces. This makes the code much easier to read.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># Good</span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="fu">do_something_very_complicated</span>(</span>
<span id="cb16-3"><a href="#cb16-3"></a>  <span class="at">something =</span> <span class="st">"that"</span>,</span>
<span id="cb16-4"><a href="#cb16-4"></a>  <span class="at">requires =</span> many,</span>
<span id="cb16-5"><a href="#cb16-5"></a>  <span class="at">arguments =</span> <span class="st">"some of which may be long"</span></span>
<span id="cb16-6"><a href="#cb16-6"></a>)</span>
<span id="cb16-7"><a href="#cb16-7"></a></span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="co"># Bad</span></span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="fu">do_something_very_complicated</span>(<span class="st">"that"</span>, requires, many, arguments,</span>
<span id="cb16-10"><a href="#cb16-10"></a>                              <span class="st">"some of which may be long"</span></span>
<span id="cb16-11"><a href="#cb16-11"></a>                              )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="box notewell">
<p>One mistake that people often make when splitting a function across multiple lines is to leave the closing parenthesis <code>)</code> at the end of the last line of the function, like this:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># Bad</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="fu">do_something_very_complicated</span>(</span>
<span id="cb17-3"><a href="#cb17-3"></a>  <span class="at">something =</span> <span class="st">"that"</span>,</span>
<span id="cb17-4"><a href="#cb17-4"></a>  <span class="at">requires =</span> many,</span>
<span id="cb17-5"><a href="#cb17-5"></a>  <span class="at">arguments =</span> <span class="st">"some of which may be long"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The problem with this is that it makes it harder to see where a particular function ends. Instead, put the closing parenthesis on a line on its own, indented with the same number of spaces as the first line of the function:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># Good</span></span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="fu">do_something_very_complicated</span>(</span>
<span id="cb18-3"><a href="#cb18-3"></a>  <span class="at">something =</span> <span class="st">"that"</span>,</span>
<span id="cb18-4"><a href="#cb18-4"></a>  <span class="at">requires =</span> many,</span>
<span id="cb18-5"><a href="#cb18-5"></a>  <span class="at">arguments =</span> <span class="st">"some of which may be long"</span></span>
<span id="cb18-6"><a href="#cb18-6"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This makes it much easier to see where a function call starts and ends.</p>
</div>
<p>When combining multiple functions using the pipe operator (<code>|&gt;</code>), put each function on a single line, with all but the first line indented by two spaces:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="fu">a_function</span>() <span class="sc">|&gt;</span> </span>
<span id="cb19-2"><a href="#cb19-2"></a>  <span class="fu">another_function</span>() <span class="sc">|&gt;</span> </span>
<span id="cb19-3"><a href="#cb19-3"></a>  <span class="fu">and_a_third_function</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Once you learn about other types of R code you will need to know how best to style it, but we will learn about those when we need to.</p>
<div class="tutorial">
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">quiz</span>(</span>
<span id="cb20-2"><a href="#cb20-2"></a>  <span class="at">caption =</span> <span class="st">""</span>,</span>
<span id="cb20-3"><a href="#cb20-3"></a>  </span>
<span id="cb20-4"><a href="#cb20-4"></a>  <span class="fu">question</span>(</span>
<span id="cb20-5"><a href="#cb20-5"></a>    <span class="st">"If a function is written across several lines of code because it will not fit on one line, where should the closing parenthesis `)` at the end of the function be placed?"</span>,</span>
<span id="cb20-6"><a href="#cb20-6"></a>    <span class="fu">answer</span>(<span class="st">"On a separate line, indented as much as the function name."</span>, <span class="at">correct =</span> <span class="cn">TRUE</span>),</span>
<span id="cb20-7"><a href="#cb20-7"></a>    <span class="fu">answer</span>(</span>
<span id="cb20-8"><a href="#cb20-8"></a>      <span class="st">"On a separate line, indented as much as the arguments on the lines above it."</span>,</span>
<span id="cb20-9"><a href="#cb20-9"></a>      <span class="at">message =</span> <span class="st">"Not quite right: the closing parenthesis should be a separate line, but indented as much as the function name so that you can easily see where the function begins and ends."</span></span>
<span id="cb20-10"><a href="#cb20-10"></a>    ),</span>
<span id="cb20-11"><a href="#cb20-11"></a>    <span class="fu">answer</span>(<span class="st">"At the end of the final function argument, on the same line."</span>),</span>
<span id="cb20-12"><a href="#cb20-12"></a>    <span class="fu">answer</span>(</span>
<span id="cb20-13"><a href="#cb20-13"></a>      <span class="st">"It doesn't matter where the closing parenthesis is placed as long as there is one."</span>,</span>
<span id="cb20-14"><a href="#cb20-14"></a>      <span class="at">message =</span> <span class="st">"While your code will wherever you place the closing parenthesis, the coding style guide introduced in this chapter is designed to make your code easier to read. This is important because if your code is easier to read that will make it easier to find and fix any mistakes in it."</span></span>
<span id="cb20-15"><a href="#cb20-15"></a>    ),</span>
<span id="cb20-16"><a href="#cb20-16"></a>    <span class="at">correct =</span> <span class="fu">random_praise</span>(),</span>
<span id="cb20-17"><a href="#cb20-17"></a>    <span class="at">allow_retry =</span> <span class="cn">TRUE</span>,</span>
<span id="cb20-18"><a href="#cb20-18"></a>    <span class="at">random_answer_order =</span> <span class="cn">TRUE</span></span>
<span id="cb20-19"><a href="#cb20-19"></a>  )</span>
<span id="cb20-20"><a href="#cb20-20"></a>  </span>
<span id="cb20-21"><a href="#cb20-21"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section><section id="styling-your-code-automatically" class="level2" data-number="4.6"><h2 data-number="4.6" class="anchored" data-anchor-id="styling-your-code-automatically">
<span class="header-section-number">4.6</span> Styling your code automatically</h2>
<p>You can get help on styling your R code using the <a href="https://styler.r-lib.org/"><code>styler</code></a> package, which can automatically format your code for you. After you install the <code>styler</code> package with the code <code>install.packages("styler")</code>, you can style your code by:</p>
<ol type="1">
<li>selecting the code you want to style,</li>
<li>opening the <code>Addins</code> menu at the top of the Source panel in RStudio,</li>
<li>clicking ‘Style selection’ in the ‘Styler’ section of the list of addins.</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="images/styler.gif" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</div>
</div>
<p>RStudio will also try to help style your code as you type, for example by automatically indenting lines.</p>
</section><section id="in-summary" class="level2" data-number="4.7"><h2 data-number="4.7" class="anchored" data-anchor-id="in-summary">
<span class="header-section-number">4.7</span> In summary</h2>
<div class="box welldone">
<p>You now know how to write your R code so that it is easy to read, which makes it much easier to understand. Understanding code when you read it is important because it allows you to work out what the code is trying to achieve and because it makes it much easier to find and fix problems when your code is not behaving as you want it to.</p>
</div>
<div class="box reading">
<p>Writing readable, understandable code is important. To find out more about this, read some of these articles:</p>
<ul>
<li>
<a href="https://www.smashingmagazine.com/2012/10/why-coding-style-matters/">Why coding style matters</a> by Nicholas Zakas.</li>
<li>
<a href="https://style.tidyverse.org/">The tidyverse style guide</a> by Hadley Wickham, which is the basis for the rules outlined in this tutorial.</li>
</ul>
</div>
<p class="credits">
<a href="https://style.tidyverse.org/">The tidyverse style guide</a> licensed under the <a href="https://github.com/tidyverse/style/blob/master/LICENSE.md">Creative Commons Attribution-ShareAlike licence</a>. <a href="https://twitter.com/allison_horst">Artwork by <span class="citation" data-cites="allison_horst">@allison_horst</span></a>
</p>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../03_data_wrangling/index.html" class="pagination-link" aria-label="Wrangling data">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Wrangling data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../05_your_second_crime_map/index.html" class="pagination-link" aria-label="Your second crime map">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Your second crime map</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
<li class="nav-item">
    <a class="nav-link" href="https://creativecommons.org/licenses/by/4.0/">
<p>This book is available under a Creative Commons Attribution 4.0 International licence</p>
</a>
  </li>  
</ul>
<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/mpjashby/crimemappingbook/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


</body></html>